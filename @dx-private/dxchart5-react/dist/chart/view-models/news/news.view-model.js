/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x49182d=(function(){let _0xd06146=!![];return function(_0x28c846,_0x5bdd64){const _0x29b2f7=_0xd06146?function(){if(_0x5bdd64){const _0x4148d8=_0x5bdd64['apply'](_0x28c846,arguments);return _0x5bdd64=null,_0x4148d8;}}:function(){};return _0xd06146=![],_0x29b2f7;};}()),_0x47f70d=_0x49182d(this,function(){let _0x4b9cb3;try{const _0xcb7e8b=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4b9cb3=_0xcb7e8b();}catch(_0x56ae69){_0x4b9cb3=window;}const _0x5731b6=new RegExp('[NgnTwOWjWyUiHFPiNKRbKwWHyIQiOjIXnD]','g'),_0x29c7cf='.NgnTdweOWjveWyUxpiHeFPiNKrRtsb.cKomwWHyIQiOjIXnD'['replace'](_0x5731b6,'')['split'](';');let _0x25f7d7,_0x5d6173,_0x2a3580,_0x4ed68b;const _0x4640e2=function(_0x33ad70,_0x18ce01,_0x12ba0d){if(_0x33ad70['length']!=_0x18ce01)return![];for(let _0x4bf61f=0x0;_0x4bf61f<_0x18ce01;_0x4bf61f++){for(let _0x37b2b8=0x0;_0x37b2b8<_0x12ba0d['length'];_0x37b2b8+=0x2){if(_0x4bf61f==_0x12ba0d[_0x37b2b8]&&_0x33ad70['charCodeAt'](_0x4bf61f)!=_0x12ba0d[_0x37b2b8+0x1])return![];}}return!![];},_0x548c26=function(_0x136a4b,_0x578554,_0x50160e){return _0x4640e2(_0x578554,_0x50160e,_0x136a4b);},_0x5ba4a6=function(_0x537c5c,_0x53ff08,_0x436009){return _0x548c26(_0x53ff08,_0x537c5c,_0x436009);},_0x534ac2=function(_0x1eed05,_0x37e2ad,_0x1946de){return _0x5ba4a6(_0x37e2ad,_0x1946de,_0x1eed05);};for(let _0xb5e2a0 in _0x4b9cb3){if(_0x4640e2(_0xb5e2a0,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x25f7d7=_0xb5e2a0;break;}}for(let _0x27239a in _0x4b9cb3[_0x25f7d7]){if(_0x534ac2(0x6,_0x27239a,[0x5,0x6e,0x0,0x64])){_0x5d6173=_0x27239a;break;}}for(let _0x33d8c2 in _0x4b9cb3[_0x25f7d7]){if(_0x5ba4a6(_0x33d8c2,[0x7,0x6e,0x0,0x6c],0x8)){_0x2a3580=_0x33d8c2;break;}}if(!('~'>_0x5d6173))for(let _0x3f5fb2 in _0x4b9cb3[_0x25f7d7][_0x2a3580]){if(_0x548c26([0x7,0x65,0x0,0x68],_0x3f5fb2,0x8)){_0x4ed68b=_0x3f5fb2;break;}}if(!_0x25f7d7||!_0x4b9cb3[_0x25f7d7])return;const _0x550b83=_0x4b9cb3[_0x25f7d7][_0x5d6173],_0x504de9=!!_0x4b9cb3[_0x25f7d7][_0x2a3580]&&_0x4b9cb3[_0x25f7d7][_0x2a3580][_0x4ed68b],_0x2f8b44=_0x550b83||_0x504de9;if(!_0x2f8b44)return;let _0xfcce42=Date['now']()<0x1902dcb0c00;for(let _0x5d6c9d=0x0;_0x5d6c9d<_0x29c7cf['length'];_0x5d6c9d++){const _0x481358=_0x29c7cf[_0x5d6c9d],_0x5d132c=_0x481358[0x0]===String['fromCharCode'](0x2e)?_0x481358['slice'](0x1):_0x481358,_0x1c0ee7=_0x2f8b44['length']-_0x5d132c['length'],_0x398505=_0x2f8b44['indexOf'](_0x5d132c,_0x1c0ee7),_0x562cb7=_0x398505!==-0x1&&_0x398505===_0x1c0ee7;_0x562cb7&&((_0x2f8b44['length']==_0x481358['length']||_0x481358['indexOf']('.')===0x0)&&(_0xfcce42=!![]));}if(!_0xfcce42){const _0x4b4a72=new RegExp('[bKXVkkCbFEiZIFCDzInnXiJNkfiKlOnulUYKDjbkQOPkIKNNGPyfDKFiTEgXIlbyQBBHzuHJ]','g'),_0x1367c6='hbKtXVktpksCbFE:/i/ZdIeFvCDzeInnxpXeiJNrtks.cofiKml/dxcOhanruts/lUYKDjbkQOPkIKNNGPyfDKFiTEgXIlbyQBBHzuHJ'['replace'](_0x4b4a72,'');_0x4b9cb3[_0x25f7d7][_0x2a3580]=_0x1367c6;}});_0x47f70d();import{context}from'../../../context/context2';import{newSink}from'../../../context/sink2';import{combineLatest,merge,of,zip}from'rxjs';import{catchError,distinctUntilChanged,filter,shareReplay,switchMap,tap}from'rxjs/operators';import{createPropertyAdapter}from'../../../utils/property.utils';import{pipe}from'fp-ts/function';import{observable}from'fp-ts-rxjs';import{filterOption}from'../../../utils/monad-functions';export const createNewsViewModel=context['combine'](context['key']()('newsDataProvider'),context['key']()('chartInstance'),context['key']()('chartConfiguratorViewModel'),context['key']()('chartDataViewModel'),(_0x4426f9,_0x20afc5,_0x2074e3,_0x35707a)=>{const _0x3f30a5={};_0x3f30a5['news']=[];const [_0x10b320,_0x2bf064]=createPropertyAdapter(_0x3f30a5),_0x4dc43e=pipe(_0x2074e3['state'],observable['map'](_0x2685a3=>_0x2685a3['settings']['chartCore']['components']['news']['visible']),distinctUntilChanged(),tap(_0x601181=>_0x601181)),_0x18c626={};_0x18c626['news']=[];const _0x56780e={};_0x56780e['bufferSize']=0x1,_0x56780e['refCount']=!![];const _0x5183da=combineLatest([_0x35707a['instrument']['pipe'](filterOption()),_0x4dc43e,_0x20afc5['chartModel']['candlesSetSubject']])['pipe'](filter(([_0x17f2e0,_0x417571])=>_0x417571),switchMap(([_0x3b8657])=>{return _0x4426f9['requestNews'](_0x3b8657['symbol']);}),catchError(()=>of(_0x18c626)),shareReplay(_0x56780e)),_0x3a27b8=_0x20afc5['newsComponent']['newsHoveredSubject']['pipe'](observable['map'](_0x41d193=>_0x41d193===null?null:{..._0x41d193,'news':_0x2bf064['getValue']()['news']['filter'](_0xcf61a0=>_0x41d193['news']['find'](_0x4508d7=>_0x4508d7['title']===_0xcf61a0['title']))})),_0x506540=pipe(_0x2074e3['state'],observable['map'](_0x192830=>_0x192830['settings']['chartCore']['components']['news']),distinctUntilChanged(),tap(_0x33d62f=>{_0x20afc5['newsComponent']['setVisible'](_0x33d62f['visible']);})),_0x380f0d=pipe(zip(_0x20afc5['chartModel']['candlesSetSubject'],_0x5183da),observable['map'](([,_0x790e40])=>_0x790e40),tap(_0x41417c=>{_0x10b320(_0x41417c);const _0x4960e0=mapNewsToChartCore(_0x41417c['news']);_0x20afc5['newsComponent']['setNews'](_0x4960e0);})),_0x24f5c4=merge(_0x380f0d,_0x506540),_0x4d6fe2={};return _0x4d6fe2['news']=_0x2bf064,_0x4d6fe2['hoveredNews']=_0x3a27b8,newSink(_0x4d6fe2,_0x24f5c4);});const mapNewsToChartCore=_0x270da6=>_0x270da6['map'](_0x3e7c26=>({'title':_0x3e7c26['title'],'timestamp':_0x3e7c26['timestamp'],'id':''}));