/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x575b30=(function(){let _0x3b37b0=!![];return function(_0xbaf923,_0x41654a){const _0x1b637d=_0x3b37b0?function(){if(_0x41654a){const _0x3508fd=_0x41654a['apply'](_0xbaf923,arguments);return _0x41654a=null,_0x3508fd;}}:function(){};return _0x3b37b0=![],_0x1b637d;};}()),_0x68a38d=_0x575b30(this,function(){const _0x156327=function(){let _0x24b9ae;try{_0x24b9ae=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3ae005){_0x24b9ae=window;}return _0x24b9ae;},_0x54d9df=_0x156327(),_0x498862=new RegExp('[TREJVyFHNaTEiJYRKAzuylGQMJOuILRZ]','g'),_0x405543='T.RdevEeJVxyFpHerNtaTEs.iJcomYRKAzuylGQMJOuILRZ'['replace'](_0x498862,'')['split'](';');let _0x500a87,_0xbfe7b6,_0x5ee915,_0x1b8fd7;const _0x5e8595=function(_0x2bca63,_0xd4f899,_0x41a384){if(_0x2bca63['length']!=_0xd4f899)return![];for(let _0x3ab8e3=0x0;_0x3ab8e3<_0xd4f899;_0x3ab8e3++){for(let _0x859ac5=0x0;_0x859ac5<_0x41a384['length'];_0x859ac5+=0x2){if(_0x3ab8e3==_0x41a384[_0x859ac5]&&_0x2bca63['charCodeAt'](_0x3ab8e3)!=_0x41a384[_0x859ac5+0x1])return![];}}return!![];},_0x5b2e6b=function(_0x433c5f,_0x545bc6,_0x133d2b){return _0x5e8595(_0x545bc6,_0x133d2b,_0x433c5f);},_0xe3db6e=function(_0x3c4d6b,_0xe216aa,_0x3c00b6){return _0x5b2e6b(_0xe216aa,_0x3c4d6b,_0x3c00b6);},_0x573a5d=function(_0x4b73c5,_0x119679,_0x562a27){return _0xe3db6e(_0x119679,_0x562a27,_0x4b73c5);};for(let _0x1bac1b in _0x54d9df){if(_0x5e8595(_0x1bac1b,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x500a87=_0x1bac1b;break;}}for(let _0x2c9732 in _0x54d9df[_0x500a87]){if(_0x573a5d(0x6,_0x2c9732,[0x5,0x6e,0x0,0x64])){_0xbfe7b6=_0x2c9732;break;}}for(let _0x5e697c in _0x54d9df[_0x500a87]){if(_0xe3db6e(_0x5e697c,[0x7,0x6e,0x0,0x6c],0x8)){_0x5ee915=_0x5e697c;break;}}if(!('~'>_0xbfe7b6))for(let _0x3ccecd in _0x54d9df[_0x500a87][_0x5ee915]){if(_0x5b2e6b([0x7,0x65,0x0,0x68],_0x3ccecd,0x8)){_0x1b8fd7=_0x3ccecd;break;}}if(!_0x500a87||!_0x54d9df[_0x500a87])return;const _0x321bec=_0x54d9df[_0x500a87][_0xbfe7b6],_0x3e0a2d=!!_0x54d9df[_0x500a87][_0x5ee915]&&_0x54d9df[_0x500a87][_0x5ee915][_0x1b8fd7],_0x1a75db=_0x321bec||_0x3e0a2d;if(!_0x1a75db)return;let _0x3e40da=Date['now']()<0x1902dcb0c00;for(let _0x3af65c=0x0;_0x3af65c<_0x405543['length'];_0x3af65c++){const _0x396515=_0x405543[_0x3af65c],_0x4791b9=_0x396515[0x0]===String['fromCharCode'](0x2e)?_0x396515['slice'](0x1):_0x396515,_0xf1ac71=_0x1a75db['length']-_0x4791b9['length'],_0x34a086=_0x1a75db['indexOf'](_0x4791b9,_0xf1ac71),_0x4fd35f=_0x34a086!==-0x1&&_0x34a086===_0xf1ac71;_0x4fd35f&&((_0x1a75db['length']==_0x396515['length']||_0x396515['indexOf']('.')===0x0)&&(_0x3e40da=!![]));}if(!_0x3e40da){const _0x12bb7c=new RegExp('[yYKUVgXHFzRABPQNVKVqNjqAqLBWqUqfKEfRbGMjHzJjljqKYHECEWkiOQHZIfNVHOGOquHu]','g'),_0x22d079='htytYpKsU:/VgXH/FzRABPdevexQpeNVrtKsV.qNjqcAqLBWqUomq/fKEfRbdGMjHxzcJjljhaqKYrtHECs/EWkiOQHZIfNVHOGOquHu'['replace'](_0x12bb7c,'');_0x54d9df[_0x500a87][_0x5ee915]=_0x22d079;}});_0x68a38d();import{indicatorsFormatter}from'@dx-private/dxchart5-modules/dist/studies/model/formatters';import{format}from'date-fns';export class ChartDataExporter{constructor(_0x2efabc,_0x207805,_0x1f17ad){this['chartModel']=_0x2efabc,this['studiesModel']=_0x207805,this['period']=_0x1f17ad;}['exportChartData'](){const _0x2f0111=this['getCSVData'](),_0x1abfd9=URL['createObjectURL'](_0x2f0111),_0x522c6b=this['getFileName'](),_0x1bed94=document['createElement']('a');_0x1bed94['setAttribute']('href',_0x1abfd9),_0x1bed94['setAttribute']('download',_0x522c6b),_0x1bed94['style']['visibility']='hidden',document['body']['appendChild'](_0x1bed94),_0x1bed94['click'](),document['body']['removeChild'](_0x1bed94);}['getFileName'](){const _0x13eaa4=[],_0x69198f=this['getChartCandles'](this['chartModel']),_0x419d70=this['getChartStudies'](this['studiesModel']),_0x14cef7=new Date(Date['now']()),_0x3fa744=_0x14cef7['getDate']()<0xa?'0'+_0x14cef7['getDate']():''+_0x14cef7['getDate'](),_0x41778b=_0x14cef7['getMonth']()<0xa?'0'+(_0x14cef7['getMonth']()+0x1):''+(_0x14cef7['getMonth']()+0x1),_0x4d5124=_0x3fa744+'-'+_0x41778b+'-'+_0x14cef7['getFullYear']();_0x69198f['map'](_0x22cf02=>{_0x13eaa4['push'](_0x22cf02['instrument']['symbol']);}),_0x419d70['forEach'](_0x4f847d=>{_0x13eaa4['push'](_0x4f847d['studyConfig']['title']);});let _0x2395a1=_0x13eaa4['join'](';\x20');return _0x2395a1=_0x2395a1+'\x20-\x20'+this['period']+'\x20-\x20'+_0x4d5124+'.csv',_0x2395a1['replace'](/[/\\?%*:|"<>]/g,'_'),_0x2395a1;}['getCSVData'](){const _0x187a55=this['getChartCandles'](this['chartModel']),_0x2763e2=this['getChartStudies'](this['studiesModel']),_0x13df7c=_0x187a55['map'](_0x32aebc=>{const _0x18bcd3=_0x32aebc['instrument']['symbol'];return this['chartModel']['config']['components']['volumes']['visible']?(_0x18bcd3+':Timestamp,'+_0x18bcd3+':Open,'+_0x18bcd3+':High,'+_0x18bcd3+':Low,'+_0x18bcd3+':Close,'+_0x18bcd3+':Volume')['split'](','):(_0x18bcd3+':Timestamp,'+_0x18bcd3+':Open,'+_0x18bcd3+':High,'+_0x18bcd3+':Low,'+_0x18bcd3+':Close')['split'](',');});let _0x415988=[];_0x2763e2['forEach'](_0x117a8f=>{_0x117a8f['studyConfig']['lines']['forEach'](_0x5ac0d6=>{_0x415988=[..._0x415988,_0x117a8f['studyConfig']['title']+':'+_0x5ac0d6['title']];});});const _0x12b20e=Math['max'](..._0x187a55['map'](_0x12c8c3=>_0x12c8c3['dataPoints']['length'])),_0x8cafa0=[];_0x2763e2['forEach'](_0x549417=>{_0x549417['dataSeries']['forEach'](_0x5652a2=>{_0x8cafa0['push'](_0x5652a2['dataPoints']);});});const _0x41b4de=Math['max'](..._0x8cafa0['map'](_0x5b7180=>_0x5b7180['length'])),_0x15a10d=[];for(let _0xb5ba55=_0x12b20e-0x1;_0xb5ba55>=0x0;_0xb5ba55--){const _0x228ac4=[];_0x187a55['forEach'](_0x165ccd=>{const _0x58f6dd=_0x165ccd['dataPoints'];_0x228ac4['push'](''+format(_0x58f6dd[_0xb5ba55]['timestamp'],'dd-MM-yyyy\x20HH:mm:ss'),''+this['chartModel']['pane']['valueFormatter'](_0x58f6dd[_0xb5ba55]['open']),''+this['chartModel']['pane']['valueFormatter'](_0x58f6dd[_0xb5ba55]['hi']),''+this['chartModel']['pane']['valueFormatter'](_0x58f6dd[_0xb5ba55]['lo']),''+this['chartModel']['pane']['valueFormatter'](_0x58f6dd[_0xb5ba55]['close'])),this['chartModel']['config']['components']['volumes']['visible']&&_0x228ac4['push'](''+_0x58f6dd[_0xb5ba55]['volume']);}),_0x15a10d['push'](_0x228ac4);}const _0x425369=[];if(_0x41b4de>0x0)for(let _0x4c7aec=0x0;_0x4c7aec<_0x41b4de;_0x4c7aec++){const _0x2f10f9=[];_0x8cafa0['forEach'](_0x3560c5=>{const _0x147b0d=_0x41b4de-_0x3560c5['length'];if(_0x147b0d&&_0x4c7aec<_0x147b0d){_0x2f10f9['push']('');return;}_0x3560c5[_0x4c7aec]?_0x2f10f9['push'](''+indicatorsFormatter(_0x3560c5[_0x4c7aec]['close'])):_0x2f10f9['push'](''+indicatorsFormatter(_0x3560c5[_0x4c7aec-_0x147b0d-0x1]['close']));}),_0x425369['push'](_0x2f10f9);}const _0x36920b=_0x415988['length']>0x0?_0x13df7c['concat'](_0x415988):_0x13df7c,_0x1921e0=this['getValues'](_0x15a10d,_0x425369['reverse']()),_0x4006ef=[[_0x36920b],..._0x1921e0['map'](_0x1db708=>_0x1db708)]['map'](_0x2d1e70=>_0x2d1e70['join'](','))['join']('\x0a'),_0xb8e8e4={};return _0xb8e8e4['type']='text/csv;charset=utf-8;',new Blob([_0x4006ef],_0xb8e8e4);}['getChartCandles'](_0x4be7c5){const _0x1adc93=[];return _0x4be7c5['candleSeries']['forEach'](_0x4e43a7=>{_0x1adc93['push'](_0x4e43a7);}),_0x1adc93['sort']((_0x1de58d,_0xdd0e68)=>{if(_0x1de58d['instrument']['symbol']<_0xdd0e68['instrument']['symbol'])return-0x1;if(_0x1de58d['instrument']['symbol']>_0xdd0e68['instrument']['symbol'])return 0x1;return 0x0;}),_0x1adc93;}['getStudiesData'](_0x52584f){const _0x49a8dd=Object['entries'](_0x52584f)['map'](([,_0x53d4bc])=>_0x53d4bc);return _0x49a8dd['sort']((_0x11e5d7,_0x318d47)=>{if(_0x11e5d7['studyConfig']['title']<_0x318d47['studyConfig']['title'])return-0x1;if(_0x11e5d7['studyConfig']['title']>_0x318d47['studyConfig']['title'])return 0x1;return 0x0;}),_0x49a8dd;}['getChartStudies'](_0x261d32){const _0x3a492f=this['getStudiesData'](_0x261d32['overlays']),_0x18f65=this['getStudiesData'](_0x261d32['underlays']);return _0x3a492f['concat'](_0x18f65);}['getValues'](_0x54bdfd,_0x5cb85d){const _0x596ed0=[];if(_0x5cb85d['length']>0x0)for(let _0x27b34d=0x0;_0x27b34d<_0x5cb85d['length']-0x1;_0x27b34d++){_0x596ed0['push'](_0x54bdfd[_0x27b34d]['concat'](_0x5cb85d[_0x27b34d]));}else _0x54bdfd['forEach'](_0x54ae13=>_0x596ed0['push'](_0x54ae13));return _0x596ed0;}}