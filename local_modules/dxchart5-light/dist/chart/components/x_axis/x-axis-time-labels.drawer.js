/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import{CanvasElement as d}from"../../canvas/canvas-bounds-container";import{calculateTextWidth as h}from"../../utils/canvas-font-measure-tool.utils";export class XAxisTimeLabelsDrawer{constructor(t,o,n,e,i,a=()=>!0){this.config=t,this.canvasModel=o,this.viewportModel=n,this.canvasBoundsContainer=e,this.labelsProvider=i,this.drawPredicate=a}draw(){var t;if(this.drawPredicate()){const o=this.canvasModel.ctx,n=this.config.colors.xAxis,e=this.config.components.xAxis.fontFamily,i=XAxisTimeLabelsDrawer.getFontFromConfig(this.config),a=this.config.components.xAxis.fontSize,r=(t=this.config.components.xAxis.padding.top)!==null&&t!==void 0?t:0;o.save(),o.font=i,o.fillStyle=n.backgroundColor;const s=this.canvasBoundsContainer.getBounds(d.X_AXIS);o.fillRect(s.x,s.y,s.width,s.height);const l=this.config.colors.xAxis.labelTextColor,c=this.labelsProvider();this.drawLabels(o,c,s,l,a,e,r),o.restore()}}drawLabels(t,o,n,e,i,a,r){const s=`${i}px ${a}`;t.fillStyle=e;for(const l of o){const c=this.viewportModel.toX(l.value)-h(l.text,t,s)/2;if(c<0||c>n.width)continue;const f=n.y+i-1+r,x=l.text;t.font=s,t.fillText(x,c,f)}}static getFontFromConfig(t){return`${t.components.xAxis.fontStyle}  ${t.components.xAxis.fontSize}px ${t.components.xAxis.fontFamily}`}getCanvasIds(){return[this.canvasModel.canvasId]}}
