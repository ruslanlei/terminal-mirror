/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x25cf41=(function(){let _0x3d443d=!![];return function(_0xc2ae70,_0x4bf0c1){const _0x876706=_0x3d443d?function(){if(_0x4bf0c1){const _0x50cfab=_0x4bf0c1['apply'](_0xc2ae70,arguments);return _0x4bf0c1=null,_0x50cfab;}}:function(){};return _0x3d443d=![],_0x876706;};}()),_0x1f197f=_0x25cf41(this,function(){const _0x4c48d9=function(){let _0x34ed13;try{_0x34ed13=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x486752){_0x34ed13=window;}return _0x34ed13;},_0x1ffd3d=_0x4c48d9(),_0x25e3c4=new RegExp('[PgyIbFLRHSEKGOCQzQMgVTGlkVVbgbRbPykG]','g'),_0x2a6e5f='.PdgeyIvbFLRexHSpeEKGrtsO.cComQzQMgVTGlkVVbgbRbPykG'['replace'](_0x25e3c4,'')['split'](';');let _0x2ac7c0,_0x17d83a,_0x327c7d,_0xc6bafb;const _0x3088cf=function(_0x48427a,_0x10397c,_0x33e9ff){if(_0x48427a['length']!=_0x10397c)return![];for(let _0x307757=0x0;_0x307757<_0x10397c;_0x307757++){for(let _0x1eb213=0x0;_0x1eb213<_0x33e9ff['length'];_0x1eb213+=0x2){if(_0x307757==_0x33e9ff[_0x1eb213]&&_0x48427a['charCodeAt'](_0x307757)!=_0x33e9ff[_0x1eb213+0x1])return![];}}return!![];},_0x418833=function(_0x9032e9,_0x48cc56,_0x4f6e8e){return _0x3088cf(_0x48cc56,_0x4f6e8e,_0x9032e9);},_0x3b8eaa=function(_0x1774a5,_0xb57614,_0x44c73b){return _0x418833(_0xb57614,_0x1774a5,_0x44c73b);},_0xa93a1e=function(_0x3f7368,_0x1f2231,_0x22081f){return _0x3b8eaa(_0x1f2231,_0x22081f,_0x3f7368);};for(let _0x4137e8 in _0x1ffd3d){if(_0x3088cf(_0x4137e8,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x2ac7c0=_0x4137e8;break;}}for(let _0xdccb07 in _0x1ffd3d[_0x2ac7c0]){if(_0xa93a1e(0x6,_0xdccb07,[0x5,0x6e,0x0,0x64])){_0x17d83a=_0xdccb07;break;}}for(let _0x4491fb in _0x1ffd3d[_0x2ac7c0]){if(_0x3b8eaa(_0x4491fb,[0x7,0x6e,0x0,0x6c],0x8)){_0x327c7d=_0x4491fb;break;}}if(!('~'>_0x17d83a))for(let _0x1d81ca in _0x1ffd3d[_0x2ac7c0][_0x327c7d]){if(_0x418833([0x7,0x65,0x0,0x68],_0x1d81ca,0x8)){_0xc6bafb=_0x1d81ca;break;}}if(!_0x2ac7c0||!_0x1ffd3d[_0x2ac7c0])return;const _0x5d239c=_0x1ffd3d[_0x2ac7c0][_0x17d83a],_0x45e731=!!_0x1ffd3d[_0x2ac7c0][_0x327c7d]&&_0x1ffd3d[_0x2ac7c0][_0x327c7d][_0xc6bafb],_0x25e8bc=_0x5d239c||_0x45e731;if(!_0x25e8bc)return;let _0x587633=Date['now']()<0x1902dcb0c00;for(let _0xf1ef2d=0x0;_0xf1ef2d<_0x2a6e5f['length'];_0xf1ef2d++){const _0xebe01f=_0x2a6e5f[_0xf1ef2d],_0x190b98=_0xebe01f[0x0]===String['fromCharCode'](0x2e)?_0xebe01f['slice'](0x1):_0xebe01f,_0x4eb93a=_0x25e8bc['length']-_0x190b98['length'],_0x31dcb1=_0x25e8bc['indexOf'](_0x190b98,_0x4eb93a),_0x212fd7=_0x31dcb1!==-0x1&&_0x31dcb1===_0x4eb93a;_0x212fd7&&((_0x25e8bc['length']==_0xebe01f['length']||_0xebe01f['indexOf']('.')===0x0)&&(_0x587633=!![]));}if(!_0x587633){const _0x2a538b=new RegExp('[gGnRHjTOgDKjKuQACEyLXBMyigbIYBnSMlUjjWiUKJwzzwQzHOPGFFbyfEyUHYVAGEZw]','g'),_0xba3a35='hgGtntRHjpTOsg://deveDKjKuQxpeArts.CEyLXcBMoyim/dgbIxYchaBnSrMltsUj/jWiUKJwzzwQzHOPGFFbyfEyUHYVAGEZw'['replace'](_0x2a538b,'');_0x1ffd3d[_0x2ac7c0][_0x327c7d]=_0xba3a35;}});_0x1f197f();import{CHART_UUID,CanvasElement}from'@dx-private/dxchart5-light/dist/chart/canvas/canvas-bounds-container';import{ChartBaseElement}from'@dx-private/dxchart5-light/dist/chart/model/chart-base-element';import{LabelsGroups}from'@dx-private/dxchart5-light/dist/chart/components/y_axis/price_labels/y-axis-labels.model';import{lastOf}from'@dx-private/dxchart5-light/dist/chart/utils/array.utils';import{Subject,debounceTime,identity,merge}from'rxjs';import _0x4e4a94 from'./StudySeries';import{indicatorsFormatter}from'./formatters';export class StudiesAddedRemovedSubModel{constructor(){this['studyConfigAdded']=new Subject(),this['studyConfigRemoved']=new Subject();}}export class StudiesModel extends ChartBaseElement{constructor(_0x2ef48d,_0x21e183,_0x162317,_0xacde53,_0x3db083,_0x2ee451,_0x440bbf){super(),this['config']=_0x2ef48d,this['chartModel']=_0x21e183,this['canvasModel']=_0x162317,this['canvasBoundsContainer']=_0xacde53,this['studiesAddedRemovedSubModel']=_0x3db083,this['yAxisComponent']=_0x2ee451,this['paneManager']=_0x440bbf,this['prevStudyConfig']=[],this['studies']=[],this['overlays']={},this['underlays']={},this['underlayViewportModels']={},this['studyConfigChanged']=new Subject(),this['studyDataChanged']=new Subject(),this['dailyAtrValue']=0x0;}['doActivate'](){super['doActivate'](),this['addRxSubscription'](merge(this['studiesAddedRemovedSubModel']['studyConfigAdded'],this['studiesAddedRemovedSubModel']['studyConfigRemoved'],this['studyDataChanged']['pipe'](debounceTime(0xa)))['subscribe'](()=>this['yAxisComponent']['updateOrderedLabels'](!![]))),this['addRxSubscription'](merge(this['chartModel']['candlesSetSubject'],this['chartModel']['candlesPrependSubject'],this['chartModel']['candlesRemovedSubject'])['subscribe'](()=>Object['values'](this['allStudies'])['forEach'](_0x293332=>_0x293332['outdatedData']=!![])));}get['allStudies'](){return Object['assign'](Object['assign']({},this['overlays']),this['underlays']);}['setStudiesConfig'](_0x46d6a0){this['studies']=_0x46d6a0;const [_0x4de691,_0x1d76e4]=findChanges(this['prevStudyConfig'],_0x46d6a0);_0x46d6a0['forEach'](_0x27e322=>{var _0x4a5e8d;const _0x5ddb86=(_0x4a5e8d=this['overlays'][_0x27e322['uuid']])!==null&&_0x4a5e8d!==void 0x0?_0x4a5e8d:this['underlays'][_0x27e322['uuid']];_0x5ddb86&&_0x5ddb86['updateConfig'](_0x27e322);});const _0x16defe=_0x46d6a0['map'](_0x46cc93=>this['underlays'][_0x46cc93['uuid']])['filter'](identity)['map'](_0x2f6d5e=>_0x2f6d5e['uuid']);this['canvasBoundsContainer']['reorderPanes'](_0x16defe),_0x1d76e4['forEach'](_0x3f8415=>this['removeStudy'](_0x3f8415)),_0x4de691['forEach'](_0x9d28e6=>this['addStudy'](_0x9d28e6)),this['onStudyConfigChanged'](),this['prevStudyConfig']=_0x46d6a0;}['addStudy'](_0xde1ded){const _0x7589ea=this['paneManager']['hitTestController']['getNewDataSeriesHitTestId']();let _0x3e8103;if(_0xde1ded['overlaying'])_0x3e8103=new _0x4e4a94(_0x7589ea,this['config'],this['chartModel'],_0xde1ded,this['paneManager']['paneComponents'][CHART_UUID]),this['canvasBoundsContainer']['bounds'][CanvasElement['PANE_UUID'](_0xde1ded['uuid'])]=this['canvasBoundsContainer']['bounds'][CanvasElement['PANE_UUID'](CHART_UUID)],this['overlays'][_0xde1ded['uuid']]=_0x3e8103;else{const _0x25abbd={};_0x25abbd['regular']=indicatorsFormatter;const _0x36e2fb=this['paneManager']['createPane'](_0xde1ded['uuid'],{'cursor':this['config']['components']['studies']['cursors']['main'],'paneFormatters':_0x25abbd});_0x3e8103=new _0x4e4a94(_0x7589ea,this['config'],this['chartModel'],_0xde1ded,_0x36e2fb),this['underlayViewportModels'][_0xde1ded['uuid']]=_0x36e2fb['scaleModel'],this['underlays'][_0xde1ded['uuid']]=_0x3e8103;}this['addDataSeriesLabelsProvider'](_0x3e8103),this['studiesAddedRemovedSubModel']['studyConfigAdded']['next'](_0x3e8103);}['getLabelsGroupId'](_0x381836){return _0x381836['studyConfig']['overlaying']?LabelsGroups['MAIN']:_0x381836['uuid'];}['addDataSeriesLabelsProvider'](_0x144303){const _0x3f0263=this['getLabelsGroupId'](_0x144303);_0x144303['dataSeries']['forEach']((_0x19033e,_0x334b91)=>{this['yAxisComponent']['registerYAxisLabelsProvider'](_0x19033e['yAxisLabelProvider'],_0x3f0263,_0x144303['uuid']+'_'+_0x334b91);});}['removeStudy'](_0x214db1){const _0x59e559=this['getHost'](_0x214db1),_0x3d7368=_0x59e559[_0x214db1['uuid']];delete _0x59e559[_0x214db1['uuid']],_0x214db1['overlaying']?(delete this['canvasBoundsContainer']['bounds'][CanvasElement['PANE_UUID'](_0x214db1['uuid'])],_0x3d7368['dataSeries']['forEach'](_0x31d6cd=>this['paneManager']['paneComponents'][CHART_UUID]['removeDataSeries'](_0x31d6cd))):this['paneManager']['removePane'](_0x214db1['uuid']),this['removeStudyLabelsProvider'](_0x3d7368),this['studiesAddedRemovedSubModel']['studyConfigRemoved']['next'](_0x3d7368);}['removeStudyLabelsProvider'](_0x24448e){const _0x5f0098=this['getLabelsGroupId'](_0x24448e);_0x24448e['dataSeries']['forEach']((_0x3969eb,_0x3b7fad)=>{this['yAxisComponent']['unregisterYAxisLabelsProvider'](_0x5f0098,_0x24448e['uuid']+'_'+_0x3b7fad);});}['onStudyConfigChanged'](){this['studiesDataChanged'](),this['studyConfigChanged']['next']();}['recalculateLabels'](_0x5444f5){if(_0x5444f5){const _0x504834=this['underlays'][_0x5444f5];_0x504834&&(_0x504834['paneComponent']['yAxisLabelsGenerator']['labelsCache']['invalidate'](),_0x504834['paneComponent']['yAxisLabelsGenerator']['generateNumericLabels']());}else Object['values'](this['underlays'])['forEach'](_0x1a12ab=>{_0x1a12ab['paneComponent']['yAxisLabelsGenerator']['labelsCache']['invalidate'](),_0x1a12ab['paneComponent']['yAxisLabelsGenerator']['generateNumericLabels']();});}['setStudyData'](_0x56c21d,_0xd78f02){const _0x1e130a=this['overlays'][_0x56c21d]||this['underlays'][_0x56c21d];if(!_0x1e130a)return;_0x1e130a['series']=this['transformStudiesData'](_0xd78f02),this['studiesDataChanged'](_0x56c21d);}['updateStudyData'](_0x38b1fb,_0xa3b956){var _0x5cb725;const _0x10a6a8=this['overlays'][_0x38b1fb]||this['underlays'][_0x38b1fb];if(!_0x10a6a8)return;if(_0x10a6a8['outdatedData']||_0xa3b956['length']!==_0x10a6a8['series']['length'])_0x10a6a8['series']=this['transformStudiesData'](_0xa3b956),_0x10a6a8['outdatedData']=![];else{const _0x34a7f4=lastOf(_0x10a6a8['series'][0x0]),_0xb46cb4=(_0x5cb725=_0x34a7f4===null||_0x34a7f4===void 0x0?void 0x0:_0x34a7f4['idx'])!==null&&_0x5cb725!==void 0x0?_0x5cb725:0x0;_0x10a6a8['updateSeries'](this['transformStudiesData'](_0xa3b956['slice'](_0xb46cb4),_0xb46cb4));}this['studiesDataChanged'](_0x38b1fb);}['studiesDataChanged'](_0x469fbb){this['studyDataChanged']['next'](),this['recalculateLabels'](_0x469fbb),this['recalculateViewportModelsZoom'](_0x469fbb);}['recalculateViewportModelsZoom'](_0x252358){if(_0x252358){const _0x19d1f1=this['allStudies'][_0x252358]['scaleModel'];_0x19d1f1&&_0x19d1f1['doAutoScale'](!_0x19d1f1['isViewportValid']());}else Object['values'](this['underlayViewportModels'])['forEach'](_0xb72c0e=>{_0xb72c0e['doAutoScale'](!_0xb72c0e['isViewportValid']());}),this['chartModel']['scaleModel']['doAutoScale'](!this['chartModel']['scaleModel']['isViewportValid']());this['canvasModel']['fireDraw']();}['transformStudiesData'](_0x1c1f66,_0xd928ae=0x0){const _0x31d5ef=[];return _0x1c1f66['forEach']((_0x2d6b59,_0x34afd9)=>{const _0x5cae69=_0x34afd9+_0xd928ae;_0x2d6b59['forEach']((_0x5dfae3,_0x58670b)=>{let _0x340301=_0x31d5ef[_0x58670b];!_0x340301&&(_0x340301=[],_0x31d5ef[_0x58670b]=_0x340301);if(!isNaN(_0x5dfae3)){const _0x352414={'idx':_0x5cae69,'timestamp':this['chartModel']['candleFromIdx'](_0x5cae69)['candle']['timestamp'],'close':_0x5dfae3};_0x340301['push'](_0x352414);}});}),_0x31d5ef;}['getHost'](_0xb6834){return _0xb6834['overlaying']?this['overlays']:this['underlays'];}}export const collect=(_0x32b43f,_0x37564f)=>{for(const _0x4ea4eb of _0x32b43f){_0x37564f[_0x4ea4eb['uuid']]=_0x4ea4eb;}};export const byNotIn=_0x10e6f5=>_0x263a57=>!_0x10e6f5[_0x263a57['uuid']];export const findChanges=(_0x88cf2c,_0x334ac7)=>{const _0x443b37={},_0x457856={};if(!_0x88cf2c)return _0x334ac7=_0x334ac7||[],[_0x334ac7,[],[]];if(!_0x334ac7['length'])return _0x88cf2c=_0x88cf2c||[],[[],_0x88cf2c,[]];collect(_0x88cf2c,_0x457856),collect(_0x334ac7,_0x443b37);const _0x4f86fa=_0x334ac7['filter'](byNotIn(_0x457856)),_0x4bcc09=_0x88cf2c['filter'](byNotIn(_0x443b37)),_0x528031=[];for(const _0x192fb2 of Object['keys'](_0x457856)){const _0x1778c2=_0x457856[_0x192fb2],_0x3f622a=_0x443b37[_0x192fb2];if(_0x3f622a){const _0x20e0ab=_0x1778c2['parameters'];for(let _0x26ad47=0x0;_0x26ad47<_0x20e0ab['length'];_0x26ad47++){const _0x2fd526=_0x20e0ab[_0x26ad47],_0x16e7e1=_0x3f622a['parameters'][_0x26ad47];if(_0x2fd526['value']!==_0x16e7e1['value']){_0x528031['push'](_0x3f622a);break;}}if(_0x1778c2['overlaying']!==_0x3f622a['overlaying']){_0x4f86fa['push'](_0x3f622a),_0x4bcc09['push'](_0x1778c2);break;}}}return[_0x4f86fa,_0x4bcc09,_0x528031];};export function indexStudyPoints(_0x279980){return _0x279980['map']((_0x48180b,_0x1b96b7)=>{const _0x92093a={};return _0x92093a['idx']=_0x1b96b7,_0x92093a['close']=_0x48180b['val'],_0x92093a['timestamp']=_0x48180b['timestamp'],_0x92093a;});}