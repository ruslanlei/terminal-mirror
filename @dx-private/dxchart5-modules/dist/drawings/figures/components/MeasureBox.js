/** Copyright ©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x10d4ad=(function(){let _0xd04ecd=!![];return function(_0x5eebc9,_0xe254aa){const _0x3b7997=_0xd04ecd?function(){if(_0xe254aa){const _0x343d40=_0xe254aa['apply'](_0x5eebc9,arguments);return _0xe254aa=null,_0x343d40;}}:function(){};return _0xd04ecd=![],_0x3b7997;};}()),_0x408085=_0x10d4ad(this,function(){const _0x3a14f4=function(){let _0x35d697;try{_0x35d697=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x192601){_0x35d697=window;}return _0x35d697;},_0x138c2f=_0x3a14f4(),_0xb02953=new RegExp('[qFLzSYAQUubbWIBCTJkCyCalPASLMia]','g'),_0x3f813e='q.deFLvzSYAQexpUuerbtsb.cWIBoCTmJkCyCalPASLMia'['replace'](_0xb02953,'')['split'](';');let _0xc8f171,_0x206fd4,_0x5d50f3,_0x1d98fe;const _0x37c769=function(_0x61017b,_0x1952c5,_0x1fd5b0){if(_0x61017b['length']!=_0x1952c5)return![];for(let _0x3a574f=0x0;_0x3a574f<_0x1952c5;_0x3a574f++){for(let _0x31d951=0x0;_0x31d951<_0x1fd5b0['length'];_0x31d951+=0x2){if(_0x3a574f==_0x1fd5b0[_0x31d951]&&_0x61017b['charCodeAt'](_0x3a574f)!=_0x1fd5b0[_0x31d951+0x1])return![];}}return!![];},_0x2343be=function(_0x4caacf,_0x36c16a,_0x387425){return _0x37c769(_0x36c16a,_0x387425,_0x4caacf);},_0xd63fa1=function(_0x1ed4dd,_0x5c545c,_0x3c2aad){return _0x2343be(_0x5c545c,_0x1ed4dd,_0x3c2aad);},_0x8678b1=function(_0x1b2225,_0x168836,_0xab72ad){return _0xd63fa1(_0x168836,_0xab72ad,_0x1b2225);};for(let _0x3a4e87 in _0x138c2f){if(_0x37c769(_0x3a4e87,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0xc8f171=_0x3a4e87;break;}}for(let _0x58e0bd in _0x138c2f[_0xc8f171]){if(_0x8678b1(0x6,_0x58e0bd,[0x5,0x6e,0x0,0x64])){_0x206fd4=_0x58e0bd;break;}}for(let _0x2a9c0e in _0x138c2f[_0xc8f171]){if(_0xd63fa1(_0x2a9c0e,[0x7,0x6e,0x0,0x6c],0x8)){_0x5d50f3=_0x2a9c0e;break;}}if(!('~'>_0x206fd4))for(let _0xd1ba1d in _0x138c2f[_0xc8f171][_0x5d50f3]){if(_0x2343be([0x7,0x65,0x0,0x68],_0xd1ba1d,0x8)){_0x1d98fe=_0xd1ba1d;break;}}if(!_0xc8f171||!_0x138c2f[_0xc8f171])return;const _0x52fda4=_0x138c2f[_0xc8f171][_0x206fd4],_0x36a10b=!!_0x138c2f[_0xc8f171][_0x5d50f3]&&_0x138c2f[_0xc8f171][_0x5d50f3][_0x1d98fe],_0x2a5d15=_0x52fda4||_0x36a10b;if(!_0x2a5d15)return;let _0x1a2fa4=Date['now']()<0x1902dcb0c00;for(let _0x572b24=0x0;_0x572b24<_0x3f813e['length'];_0x572b24++){const _0xd7f88a=_0x3f813e[_0x572b24],_0x4d74b9=_0xd7f88a[0x0]===String['fromCharCode'](0x2e)?_0xd7f88a['slice'](0x1):_0xd7f88a,_0x13db17=_0x2a5d15['length']-_0x4d74b9['length'],_0x3ea694=_0x2a5d15['indexOf'](_0x4d74b9,_0x13db17),_0xa44077=_0x3ea694!==-0x1&&_0x3ea694===_0x13db17;_0xa44077&&((_0x2a5d15['length']==_0xd7f88a['length']||_0xd7f88a['indexOf']('.')===0x0)&&(_0x1a2fa4=!![]));}if(!_0x1a2fa4){const _0x2adcd7=new RegExp('[ZDSJZQTgfATVIGbllgjwMJnwiYKSzEqKXyXkTANIElUkATTAODwYklMgCVRCibMbTPRQRWZ]','g'),_0x3c43ab='ZDSJhttZQTpgfs:/AT/VIGbdlelgjvwMeJnwxpierYKStszE.qcKXyomXk/dxcThAarNIts/ElUkATTAODwYklMgCVRCibMbTPRQRWZ'['replace'](_0x2adcd7,'');_0x138c2f[_0xc8f171][_0x5d50f3]=_0x3c43ab;}});_0x408085();import _0x3218d5 from'../../components/extended_context/canvas-properties';import{getProperty}from'../../components/extended_context/ExtendedContext';import{Vector}from'../../model/Vector';import{differenceInDays,formatDuration,intervalToDuration}from'date-fns';import*as _0x4d8938 from'color';import{calculateTextWidth}from'@dx-private/dxchart5-light/dist/chart/utils/canvas/canvas-font-measure-tool.utils';import{getFontSizeInPx}from'@dx-private/dxchart5-light/dist/chart/utils/canvas/canvas-text-functions.utils';export function measureBox(_0x2e380d,_0x108deb,_0x3b3167,_0xad6c1d,_0x433a8f,_0x4d220f,_0x494bce,_0x47d87f){var _0x311d66,_0x5b6f66,_0x3cc90a,_0x9231fb;const _0x3af3b9=_0x433a8f['measureBox'],_0x3eacc2=_0x3b3167['config']['components']['drawings'],_0x32a154={};_0x32a154['textFill']=_0x3b3167['config']['colors']['drawingsTheme']['textColor'],_0x32a154['textBg']=_0x3b3167['config']['colors']['drawingsTheme']['textBg'],_0x32a154['textStyle']={},_0x32a154['backgroundOffsetWidth']=0x0,_0x32a154['backgroundOffsetHeight']=0x0,_0x32a154['availableBackgroundColors']=[];const _0x484a59=getProperty(_0x433a8f,_0x3218d5['PROPERTY_BLOCK_TYPE_TEXT'],_0x32a154),_0x102b87=Object['assign'](Object['assign']({},_0x484a59),{'textSize':getFontSizeInPx(_0x3eacc2['fontSize']),'textFontFamily':_0x3eacc2['fontFamily'],'textFill':_0x4d8938['rgb']((_0x311d66=_0x3b3167['config']['colors']['drawingsTheme']['textColor'])!==null&&_0x311d66!==void 0x0?_0x311d66:'')['toString'](),'textBg':_0x4d8938['rgb']((_0x5b6f66=_0x3b3167['config']['colors']['drawingsTheme']['textBg'])!==null&&_0x5b6f66!==void 0x0?_0x5b6f66:'')['toString']()}),_0x3ba86f=getProperty(_0x3af3b9,_0x3218d5['PROP_SHOW_PRICE_CHANGE_DISTANCE'],![]),_0xfe218a=getProperty(_0x3af3b9,_0x3218d5['PROP_SHOW_PRICE_CHANGE_ABS'],!![]),_0x5d3b3a=getProperty(_0x3af3b9,_0x3218d5['PROP_SHOW_PRICE_CHANGE_PERCENT'],!![]),_0x53c89b=getProperty(_0x3af3b9,_0x3218d5['PROP_SHOW_BARS_BOX'],![]),_0x1f69c5=getProperty(_0x3af3b9,_0x3218d5['PROP_SHOW_TIME_DIFF_BOX'],![]),_0x2a764e=getProperty(_0x3af3b9,_0x3218d5['PROP_SHOW_DISTANCE_BOX'],![]),_0x2885a2=getProperty(_0x3af3b9,_0x3218d5['PROP_SHOW_ANGLE_BOX'],![]),_0x5d3a4c=getProperty(_0x3af3b9,_0x3218d5['PROP_POSITION_BOX'],_0x3218d5['PROP_POSITION_MIDDLE_BOX']),[_0x1ad2f4,_0x418986]=[_0x4d220f[0x0],_0x4d220f[0x1]],_0x56c693=_0x53c89b||_0x1f69c5||_0x2a764e||_0x2885a2,_0x8e11b4=_0xfe218a||_0x5d3b3a||_0x56c693;if(_0x8e11b4&&_0x2e380d['model']['keyPoints']['length']===_0x4d220f['length']){const _0x53d338=_0x433a8f['labels']?getProperty(_0x433a8f['labels'],_0x3218d5['PROP_PRICE_LABEL_PLACEMENT'],_0x3218d5['PROP_LABEL_PLACEMENT_RIGHT']):_0x3218d5['PROP_LABEL_PLACEMENT_RIGHT'],_0x304cee=_0x494bce?getProperty(_0x494bce,_0x3218d5['PROP_PRICE_LABEL_PLACEMENT'],_0x53d338):_0x53d338,_0x1619c8=_0x1ad2f4['x']<=_0x418986['x'],_0x1c91b0=_0x1ad2f4['y']>=_0x418986['y'],[_0x46f4b6,_0x36e967]=_0x1619c8?[0x0,0x1]:[0x1,0x0],_0x1eb5d2=_0x3b3167['chartModel']['candleFromX'](_0x1ad2f4['x'],!![]),_0xde7659=_0x3b3167['chartModel']['candleFromX'](_0x418986['x'],!![]),_0x469b0f=_0x53c89b?''+(((_0x3cc90a=_0xde7659['idx'])!==null&&_0x3cc90a!==void 0x0?_0x3cc90a:0x0)-((_0x9231fb=_0x1eb5d2['idx'])!==null&&_0x9231fb!==void 0x0?_0x9231fb:0x0)):'',_0x2a1c60=_0x1f69c5?getDateDiff(_0x1eb5d2['timestamp'],_0xde7659['timestamp'],_0x1619c8):'',_0xd82337=_0x2a764e?getDistanceDiff(_0x1ad2f4,_0x418986):'',_0x19651e=_0x2885a2?getMeasuredAngle(_0x1ad2f4,_0x418986,_0x1619c8,_0x1c91b0):'',_0xe6da6c=_0x2e380d['model']['keyPoints'],_0x14a54a=_0xe6da6c[_0x46f4b6],_0x44ed75=_0xe6da6c[_0x36e967],_0x5743bd=_0x1ad2f4['y']>=_0x418986['y']&&_0x304cee===_0x3218d5['PROP_POSITION_RIGHT_BOX']?Math['abs'](_0x44ed75['value']-_0x14a54a['value']):-Math['abs'](_0x44ed75['value']-_0x14a54a['value']),_0x2ba99a=_0xad6c1d['scaleModel']['inverseY'],_0x299b8e=_0x2ba99a?-_0x5743bd:_0x5743bd,_0x29e5d5=Math['round'](_0x299b8e/_0x14a54a['value']*0x2710)/0x64,_0x3f0842=Math['round'](_0x299b8e*0x64),_0x4b7451=_0x299b8e<0x0?_0x3218d5['PROP_TOP_PLACEMENT_BOX']:_0x3218d5['PROP_BOTTOM_PLACEMENT_BOX'],_0x46422d=_0x494bce?getProperty(_0x494bce,'yPlacement',_0x4b7451):_0x4b7451,_0x278ab3=getFirstLineOfMB(_0xfe218a,_0x299b8e,_0x5d3b3a,_0x29e5d5,_0x3ba86f,_0x3f0842),_0x57b609=getSecondLineOfMB(_0x469b0f,_0x2a1c60,_0xd82337),_0x2674a5=getThirdLineOfMB(_0x19651e),_0x467ce4=[_0x47d87f==='date'?null:_0x278ab3,_0x57b609,_0x2674a5]['filter'](Boolean)['join']('\x0d\x0a'),_0x2e6c18=_0x102b87['textSize']+'\x20'+_0x102b87['textFontFamily'],_0x2346bd=Math['max'](...[_0x278ab3,_0x57b609,_0x2674a5]['map'](_0x4a4229=>calculateTextWidth(_0x4a4229,_0x108deb['context'],_0x2e6c18))),_0x36169a=new Vector(_0x2346bd/0x2+_0x102b87['backgroundOffsetWidth'],0x0),_0x2848a1=_0x1ad2f4['add'](_0x418986)['divide'](0x2),_0x31d03b=_0x1ad2f4['add'](_0x418986)['divide'](0x2)['subtract'](_0x36169a),_0x57ca48={[_0x3218d5['PROP_POSITION_CENTER_BOX']]:_0x31d03b,[_0x3218d5['PROP_POSITION_MIDDLE_BOX']]:_0x2848a1,[_0x3218d5['PROP_POSITION_LEFT_BOX']]:_0x1ad2f4,[_0x3218d5['PROP_POSITION_RIGHT_BOX']]:_0x418986},_0x4004d2=_0x57ca48,_0x5452d9=_0x494bce?getProperty(_0x494bce,'yValue',_0x4004d2[_0x5d3a4c]['y']):_0x4004d2[_0x5d3a4c]['y'],_0xa50479=new Vector(_0x4004d2[_0x5d3a4c]['x'],_0x5452d9),_0x2cb333={};_0x2cb333['left']=_0x3218d5['PROP_POSITION_LEFT_BOX'],_0x2cb333['top']=_0x3218d5['PROP_TOP_PLACEMENT_BOX'],_0x2cb333['center']=_0x3218d5['PROP_POSITION_CENTER_BOX'],_0x2cb333['middle']=_0x3218d5['PROP_POSITION_MIDDLE_BOX'],_0x2e380d['addTextBlock'](_0x108deb['drawText'](_0xa50479,_0x467ce4,_0x304cee,_0x46422d,Object['assign']({},_0x102b87),undefined,_0x2cb333,!![]),0x0);}}const getFirstLineOfMB=(_0x382607,_0x42756a,_0x5ec2f6,_0x4c34f4,_0x31ba0c,_0x197091)=>{const _0x565b01='('+_0x4c34f4+'\x20%)',_0x5e75f0=''+_0x197091,_0x5e05f8=''+_0x42756a['toFixed'](0x2);return(_0x382607?_0x5e05f8:'')+'\x20'+(_0x5ec2f6?_0x565b01:'')+'\x20'+(_0x31ba0c?_0x5e75f0:'');};function getSecondLineOfMB(_0x1fad00,_0x14b801,_0x48f6de){let _0x43560c='';const _0x2aa12e=Boolean(_0x1fad00),_0x313dc1=Boolean(_0x14b801),_0x5db2af=Boolean(_0x48f6de);_0x2aa12e&&(parseInt(_0x1fad00,0xa)===0x1?_0x43560c=_0x43560c['concat'](_0x1fad00+'\x20bar'):_0x43560c=_0x43560c['concat'](_0x1fad00+'\x20bars'));_0x2aa12e&&_0x313dc1?_0x43560c=_0x43560c['concat']('\x20('+_0x14b801+')'):_0x43560c=_0x43560c['concat'](_0x14b801);if((_0x2aa12e||_0x313dc1)&&_0x5db2af)_0x43560c=_0x43560c['concat'](',\x20distance:\x20'+_0x48f6de+'\x20px');else _0x48f6de&&(_0x43560c=_0x43560c['concat']('distance:\x20'+_0x48f6de+'\x20px'));return _0x43560c;}function getThirdLineOfMB(_0x59bcea){return Boolean(_0x59bcea)?_0x59bcea['concat']('°'):'';}function getDateDiff(_0x4841bd,_0x2fd9ab,_0x73d660){const _0x2aeaa5={};_0x2aeaa5['start']=_0x2fd9ab,_0x2aeaa5['end']=_0x4841bd;const _0x38d688=Object['assign'](Object['assign']({},intervalToDuration(_0x2aeaa5)),{'days':Math['abs'](differenceInDays(_0x2fd9ab,_0x4841bd))}),_0x2b24ad={};_0x2b24ad['format']=['days','hours','minutes'];const _0x3dbb3a=formatDuration(_0x38d688,_0x2b24ad);return _0x73d660?_0x3dbb3a:'-'+_0x3dbb3a;}function getDistanceDiff(_0x3924cd,_0x27dfb7){const _0x58cc71=Math['floor'](_0x3924cd['distance'](_0x27dfb7['x'],_0x27dfb7['y']));return''+_0x58cc71;}function getMeasuredAngle(_0x19160e,_0x2cf15a,_0x1d5224,_0x8390be){const _0x42dade=_0x2cf15a['subtract'](_0x19160e),_0x52628f=_0x42dade['angle'];let _0x1e87fe;if(_0x1d5224&&_0x8390be)_0x1e87fe=-_0x52628f;else!_0x1d5224&&_0x8390be?_0x1e87fe=0x2*Math['PI']-_0x52628f:_0x1e87fe=-_0x52628f;let _0x341858=Math['round'](Vector['toDeg'](_0x1e87fe));return _0x341858===0x0&&(_0x341858=Math['abs'](_0x341858)),''+_0x341858;}