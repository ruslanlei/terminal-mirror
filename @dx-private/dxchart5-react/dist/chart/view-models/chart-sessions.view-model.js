/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x5dbd06=(function(){let _0xfa33aa=!![];return function(_0x7e4941,_0x127d74){const _0x18f18f=_0xfa33aa?function(){if(_0x127d74){const _0x4f00bb=_0x127d74['apply'](_0x7e4941,arguments);return _0x127d74=null,_0x4f00bb;}}:function(){};return _0xfa33aa=![],_0x18f18f;};}()),_0x2f5664=_0x5dbd06(this,function(){const _0x6a47d2=function(){let _0x21f516;try{_0x21f516=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x4b43c8){_0x21f516=window;}return _0x21f516;},_0x21e12b=_0x6a47d2(),_0x526404=new RegExp('[AqZKFkEPbbPCHMRRGJMiTSVnCwFFnXJuiObC]','g'),_0x3e614a='A.qZKFdekveEPxbbpertsP.CHMRRGcoJMmiTSVnCwFFnXJuiObC'['replace'](_0x526404,'')['split'](';');let _0x2ce204,_0xb15a6b,_0x5856b0,_0x2a3bd4;const _0x532ba0=function(_0x21092f,_0x13ae2f,_0xaf4803){if(_0x21092f['length']!=_0x13ae2f)return![];for(let _0x34b881=0x0;_0x34b881<_0x13ae2f;_0x34b881++){for(let _0x1252c5=0x0;_0x1252c5<_0xaf4803['length'];_0x1252c5+=0x2){if(_0x34b881==_0xaf4803[_0x1252c5]&&_0x21092f['charCodeAt'](_0x34b881)!=_0xaf4803[_0x1252c5+0x1])return![];}}return!![];},_0x571681=function(_0x55537e,_0x58149f,_0x2fde92){return _0x532ba0(_0x58149f,_0x2fde92,_0x55537e);},_0x215e2c=function(_0x19b983,_0x5c8582,_0xd907fb){return _0x571681(_0x5c8582,_0x19b983,_0xd907fb);},_0x5a168c=function(_0x5a6b71,_0xb53ed7,_0x322bcf){return _0x215e2c(_0xb53ed7,_0x322bcf,_0x5a6b71);};for(let _0x2b4a85 in _0x21e12b){if(_0x532ba0(_0x2b4a85,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x2ce204=_0x2b4a85;break;}}for(let _0x4da530 in _0x21e12b[_0x2ce204]){if(_0x5a168c(0x6,_0x4da530,[0x5,0x6e,0x0,0x64])){_0xb15a6b=_0x4da530;break;}}for(let _0x174e7d in _0x21e12b[_0x2ce204]){if(_0x215e2c(_0x174e7d,[0x7,0x6e,0x0,0x6c],0x8)){_0x5856b0=_0x174e7d;break;}}if(!('~'>_0xb15a6b))for(let _0x17ee9a in _0x21e12b[_0x2ce204][_0x5856b0]){if(_0x571681([0x7,0x65,0x0,0x68],_0x17ee9a,0x8)){_0x2a3bd4=_0x17ee9a;break;}}if(!_0x2ce204||!_0x21e12b[_0x2ce204])return;const _0x452754=_0x21e12b[_0x2ce204][_0xb15a6b],_0x403041=!!_0x21e12b[_0x2ce204][_0x5856b0]&&_0x21e12b[_0x2ce204][_0x5856b0][_0x2a3bd4],_0x47cdf0=_0x452754||_0x403041;if(!_0x47cdf0)return;let _0xfa3814=Date['now']()<0x1902dcb0c00;for(let _0x34a287=0x0;_0x34a287<_0x3e614a['length'];_0x34a287++){const _0xae32e2=_0x3e614a[_0x34a287],_0x502909=_0xae32e2[0x0]===String['fromCharCode'](0x2e)?_0xae32e2['slice'](0x1):_0xae32e2,_0x3b5d62=_0x47cdf0['length']-_0x502909['length'],_0x2f7b6f=_0x47cdf0['indexOf'](_0x502909,_0x3b5d62),_0x1ce820=_0x2f7b6f!==-0x1&&_0x2f7b6f===_0x3b5d62;_0x1ce820&&((_0x47cdf0['length']==_0xae32e2['length']||_0xae32e2['indexOf']('.')===0x0)&&(_0xfa3814=!![]));}if(!_0xfa3814){const _0x1811e3=new RegExp('[flNglKJYEGIOFHFMzPlWDKVLWLZLbZKiLHZGYSzFYlJyuzgVqBJnWkjCJVIFRJfkiMfVZLIBJ]','g'),_0x46b4ca='fhttlpNgsl:K/JY/devEexGIOFHperFMzPlts.coWmD/KVdxLchWartsL/ZLbZKiLHZGYSzFYlJyuzgVqBJnWkjCJVIFRJfkiMfVZLIBJ'['replace'](_0x1811e3,'');_0x21e12b[_0x2ce204][_0x5856b0]=_0x46b4ca;}});_0x2f5664();import{array,option}from'fp-ts';import{observable}from'fp-ts-rxjs';import{flatten}from'fp-ts/Array';import{constTrue,pipe}from'fp-ts/function';import{combineLatest,from,merge,of}from'rxjs';import{catchError,distinctUntilChanged,filter,switchMap,tap}from'rxjs/operators';import{context}from'../../context/context2';import{newSink}from'../../context/sink2';import{createPropertyAdapter}from'../../utils/property.utils';import{generateSessions}from'../../utils/session.utils';const _0x21a5a3={};_0x21a5a3['AFTER_MARKET']=[],_0x21a5a3['NO_TRADING']=[],_0x21a5a3['PRE_MARKET']=[],_0x21a5a3['REGULAR']=[];const initialSessions=_0x21a5a3;export const createChartSessionsViewModel=context['combine'](context['key']()('chartConfiguratorViewModel'),context['key']()('chartDataViewModel'),context['key']()('aggregationPeriodViewModel'),context['key']()('chartInstance'),context['key']()('tradingSessionsProvider'),(_0x3119e9,_0x55ac03,_0x423394,_0x299da6,_0x2c0ba0)=>{const [_0x470d9c,_0x4e8e81]=createPropertyAdapter(initialSessions),[_0x4e3321,_0x4c524b]=createPropertyAdapter(0x0),_0x115682=_0x1d7056=>_0x4e3321(_0x1d7056),_0x4fb433=async(_0x24206c,_0x288651=['REGULAR','PRE_MARKET','AFTER_MARKET','NO_TRADING'],_0x26d6f4,_0x4b7710)=>pipe(_0x55ac03['instrument']['getValue'](),option['map'](_0x1989ae=>{const _0x12537f=_0x1989ae['tradingHours'],_0x3a6f8c=_0x24206c??_0x299da6['chartComponent']['chartModel']['getCandles'](),_0x392b17={};_0x392b17['filter']=_0x288651,_0x392b17['tradingHours']=_0x12537f,_0x392b17['from']=_0x26d6f4,_0x392b17['to']=_0x4b7710,_0x392b17['candles']=_0x3a6f8c,_0x392b17['symbol']=_0x1989ae['symbol'];const _0x2a8e9e=generateSessions(_0x2c0ba0,_0x392b17);return _0x2a8e9e;}),option['getOrElse'](()=>Promise['resolve'](initialSessions))),_0x134fa6=pipe(_0x3119e9['state'],observable['map'](_0x20c0a4=>_0x20c0a4['settings']['chartReact']['extendedHours']['visible']),distinctUntilChanged(),tap(_0x55ac03['setExtendedHours'])),_0x4681ed=pipe(combineLatest([_0x4e8e81,pipe(_0x3119e9['state'],observable['map'](_0x116088=>_0x116088['settings']['chartReact']['sessionBreaks']['visible']),distinctUntilChanged()),pipe(_0x3119e9['state'],observable['map'](_0x309cf2=>_0x309cf2['settings']['chartReact']['extendedHours']['visible']),distinctUntilChanged())]),tap(([_0x45cc33,_0x461193,_0xfeee])=>{const _0x2c3837=flatten(Object['values'](_0x45cc33));if(_0x461193||_0xfeee){const _0x4f5b45=pipe(_0x2c3837,array['map'](toHighlight),array['filter'](filterOutRegular),array['filter'](_0x461193?constTrue:filterOutNoTrading),array['filter'](_0xfeee?constTrue:filterOutExtendedHours));_0x299da6['highlightsComponent']['setHighlights'](_0x4f5b45),_0x299da6['highlightsComponent']['setHighlightsVisible'](!![]);}else _0x299da6['highlightsComponent']['setHighlights']([]),_0x299da6['highlightsComponent']['setHighlightsVisible'](![]);})),_0x2612d1=pipe(_0x299da6['chartModel']['candlesSetSubject'],filter(()=>{const _0x4b0004=_0x423394['selectedPeriod']['getValue']();return _0x4b0004['durationType']!=='d'&&_0x4b0004['durationType']!=='w'&&_0x4b0004['durationType']!=='mo'&&_0x4b0004['durationType']!=='y';}),switchMap(()=>from(_0x4fb433())),catchError(()=>of(initialSessions)),tap(_0x43b31f=>_0x470d9c(_0x43b31f))),_0x27911e=merge(_0x134fa6,_0x4681ed,_0x2612d1);return newSink({'sessions':_0x4e8e81,'nextCandleTimestampOffset':_0x4c524b,'changeNextCandleTimestampOffset':_0x115682,'generateSessions':(_0x22bfcb,_0x347805,_0x490135=Date['now'](),_0x173d30=[])=>_0x4fb433(_0x173d30,_0x22bfcb,_0x347805,_0x490135)},_0x27911e);});const _0x2c6b5c={};_0x2c6b5c['left']=!![];const toHighlight=_0xc38fdb=>_0xc38fdb['type']==='NO_TRADING'?{..._0xc38fdb,'border':_0x2c6b5c}:{..._0xc38fdb},filterOutRegular=_0x3cca56=>_0x3cca56['type']!=='REGULAR',filterOutNoTrading=_0x5e929a=>_0x5e929a['type']!=='NO_TRADING',filterOutExtendedHours=_0xdce3af=>_0xdce3af['type']!=='PRE_MARKET'&&_0xdce3af['type']!=='AFTER_MARKET';