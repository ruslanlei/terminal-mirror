/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import{round as O}from"../../utils";import{drawPriceLabel as z,drawRoundedRect as J}from"../../utils/canvas-drawing-functions.utils";import{calculateSymbolHeight as W,calculateTextWidth as y}from"../../utils/canvas-font-measure-tool.utils";import{getLabelTextColorByBackgroundColor as G}from"../../utils/utils-index";import{getFontFromConfig as N}from"./y-axis.model";export const DEFAULT_PRICE_LABEL_PADDING=4;export function drawBadgeLabel(o,t,r,n,l,e,g){var d,p,v,h,s,m,u;const a=e.align,f=(d=l.textFont)!==null&&d!==void 0?d:N(e),B=l.bgColor,b=(p=l.textColor)!==null&&p!==void 0?p:G(B,g.labelTextColor,g.labelInvertedTextColor),E=(v=l.paddingTop)!==null&&v!==void 0?v:DEFAULT_PRICE_LABEL_PADDING,k=(h=l.paddingBottom)!==null&&h!==void 0?h:DEFAULT_PRICE_LABEL_PADDING,F=(s=l.paddingEnd)!==null&&s!==void 0?s:DEFAULT_PRICE_LABEL_PADDING,_=O(W(f,o)/2),x=n-_-E,C=n+_+k-x;if(n<t.y+C/2||n>t.y+t.height-C/2)return;o.save(),o.fillStyle=B,o.strokeStyle=B;const L=O(t.width/6),T=a==="right"?t.x:t.x+t.width,H=a==="right"?T+L:T-L,c=e.labelBoxMargin.end,R=c-F,M=t.width-L-R;z(o,H,x,T,x+O(C/2),H,x+C,M,(u=(m=e.typeConfig.badge)===null||m===void 0?void 0:m.rounded)!==null&&u!==void 0?u:!1,a),o.fillStyle=b,o.font=f;const w=a==="right"?t.x+t.width-y(r,o,f)-c:t.x+c;o.fillText(r,w,n+_-1),o.restore()}export function drawRectLabel(o,t,r,n,l,e,g,d){var p,v,h,s,m,u,a,f,B,b,E;const k=e.align,F=(p=l.textFont)!==null&&p!==void 0?p:N(e),_=l.bgColor,x=(v=l.textColor)!==null&&v!==void 0?v:G(_,g.labelTextColor,g.labelInvertedTextColor),i=(h=e.typeConfig.rectangle)===null||h===void 0?void 0:h.paddings,C=(m=(s=l.paddingTop)!==null&&s!==void 0?s:i==null?void 0:i.top)!==null&&m!==void 0?m:DEFAULT_PRICE_LABEL_PADDING,L=(a=(u=l.paddingBottom)!==null&&u!==void 0?u:i==null?void 0:i.bottom)!==null&&a!==void 0?a:DEFAULT_PRICE_LABEL_PADDING,T=(B=(f=l.paddingEnd)!==null&&f!==void 0?f:i==null?void 0:i.end)!==null&&B!==void 0?B:DEFAULT_PRICE_LABEL_PADDING,H=l.paddingStart,c=W(F,o),R=n-c/2-C,w=n+c/2+L-R,U=(b=l.rounded)!==null&&b!==void 0?b:(E=e.typeConfig.rectangle)===null||E===void 0?void 0:E.rounded;if(n<t.y+w/2||n>t.y+t.height-w/2)return;o.save(),o.fillStyle=d!=null?d:_,o.strokeStyle=d!=null?d:_;const I=e.labelBoxMargin.end;o.font=F;const X=y(r,o,F),P=I-T,D=H!==void 0?X+H+T:t.width-P,j=k==="right"?t.x+t.width-P-D:t.x+P,q=k==="right"?t.x+t.width-X-I:I;U?J(o,j,R,D,w,4,!0):o.fillRect(j,R,D,w),o.fillStyle=x,o.fillText(r,q,n+c/2-1),o.restore()}export function drawPlainLabel(o,t,r,n,l,e,g){drawRectLabel(o,t,r,n,l,e,g,"transparent")}export function getLabelYOffset(o,t,r=DEFAULT_PRICE_LABEL_PADDING){return W(o,t)/2+r}
