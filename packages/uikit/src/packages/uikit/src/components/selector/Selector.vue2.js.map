{"version":3,"file":"Selector.vue2.js","sources":["../../../../../components/selector/Selector.vue"],"sourcesContent":["<template>\n  <div :class=\"[$style.wrapper, isDisabled && $style.disabled]\">\n    <div\n      v-if=\"label\"\n      :class=\"$style.label\"\n    >\n      {{ label }}\n    </div>\n    <div\n      ref=\"container\"\n    >\n      <TransitionGroup\n        name=\"selectorElementAppearance\"\n        tag=\"div\"\n        mode=\"out-in\"\n        :class=\"[\n          $style.options,\n          ...computedStates,\n        ]\"\n        @before-leave=\"onElementRemove\"\n      >\n        <button\n          v-for=\"option in options\"\n          :ref=\"optionElement => { optionRefs[option.value] = optionElement }\"\n          :key=\"option.value\"\n          type=\"button\"\n          :class=\"[\n            $style.item,\n            localValue === option.value && $style.active,\n            ...[localValue === option.value && option?.activeState\n              ? [$style[option.activeState]]\n              : []\n            ],\n            ...[option?.state\n              ? [$style[option.state]]\n              : []\n            ]\n          ]\"\n          :data-value=\"option.value\"\n          @click=\"onOptionClick(option)\"\n        >\n          <slot\n            name=\"option\"\n            :option=\"option\"\n            :active-option=\"localValue\"\n          >\n            {{ option.label }}\n          </slot>\n        </button>\n        <div\n          key=\"$ghost\"\n          :style=\"computedGhostStyles\"\n          :class=\"[\n            $style.ghost,\n            isGhostAppearAnimation && $style.animated,\n            ...[activeOption?.ghostState\n              ? [\n                $style[activeOption.ghostState]\n              ]\n              : []\n            ]\n          ]\"\n        />\n      </TransitionGroup>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  ref,\n  watch,\n  onMounted,\n  onBeforeUnmount,\n  onBeforeUpdate, computed,\n} from 'vue';\nimport { compose } from '@terminal/common/utils/fp';\nimport { add, multiply, roundToDecimalPlaces } from '@terminal/common/utils/number';\nimport { useLocalValue } from '@/hooks/useLocalValue';\nimport { useEnvironmentObserver } from '@/hooks/useEnvironmentObserver';\nimport { useComputedState } from '@/hooks/useComputedState';\nimport { toCssPxValue } from '@/utils/style';\nimport { addCssProperty, getRect } from '@/utils/dom';\nimport { SelectorEmits, SelectorOption, SelectorProps } from './index';\n\nconst props = withDefaults(\n  defineProps<SelectorProps>(),\n  {\n    state: 'primaryColor',\n    thickening: 2,\n    isGhostAppearAnimation: true,\n  },\n);\nconst emit = defineEmits<SelectorEmits>();\n\nconst computedStates = useComputedState(props);\n\nif (!props.modelValue) {\n  throw new Error('[MultiSwitch Error]: modelValue is not passed (check v-model)');\n}\n\nconst container = ref<HTMLElement>();\nconst optionRefs = ref<Record<SelectorOption['value'], HTMLElement>>({});\nonBeforeUpdate(() => {\n  optionRefs.value = {};\n});\n\nconst localValue = useLocalValue<string>(\n  props,\n  emit,\n  'modelValue',\n);\n\nconst detectDirection = (nextOption: string, previousOption: string) => {\n  const activeOptionIndex = props.options.findIndex(\n    (option: SelectorOption) => option.value === previousOption,\n  );\n  const nextOptionIndex = props.options.findIndex(\n    (option: SelectorOption) => option.value === nextOption,\n  );\n  const isForward = activeOptionIndex < nextOptionIndex;\n\n  if (isForward) {\n    emit('selectNext');\n  } else {\n    emit('selectPrev');\n  }\n};\nwatch(localValue, detectDirection);\n\nconst activeOption = computed<SelectorOption>(() => props.options.find(\n  (option: SelectorOption) => option.value === localValue.value,\n) || { value: '', label: '' });\n\nconst onOptionClick = (selectingOption: SelectorOption) => {\n  detectDirection(selectingOption.value, localValue.value);\n  localValue.value = selectingOption.value;\n};\n\nconst computedGhostStyles = ref({\n  width: '0px',\n  height: 'auto',\n  transform: 'translateY(0) translateX(0)',\n});\n\nconst findActiveTab = () => {\n  if (!container.value || !localValue.value) return;\n\n  const activeTabElement = optionRefs.value?.[localValue.value];\n\n  if (!activeTabElement) return;\n\n  const { left: containerLeft, top: containerTop } = container.value.getBoundingClientRect();\n  const {\n    width, height, left, top,\n  } = getRect(activeTabElement);\n\n  const { thickening } = props;\n\n  const normalized = multiply(thickening, 2);\n\n  computedGhostStyles.value.width = toCssPxValue(\n    add(width, normalized),\n  );\n  computedGhostStyles.value.height = toCssPxValue(\n    add(height, normalized),\n  );\n\n  computedGhostStyles.value.transform = `translateX(${\n    toCssPxValue(\n      roundToDecimalPlaces(2, (left - containerLeft) - (normalized / 2)),\n    )\n  }) translateY(${\n    toCssPxValue(\n      roundToDecimalPlaces(2, (top - containerTop) - (normalized / 2)),\n    )\n  })`;\n};\n\nconst onElementRemove = (removingElement: HTMLElement) => {\n  // add exact height to make element\n  // animate it on remove animation.\n\n  const {\n    height,\n  } = getRect(removingElement);\n\n  compose(\n    addCssProperty(['zIndex', 1]),\n    addCssProperty(['height', toCssPxValue(height)]),\n  )(removingElement);\n};\n\nconst {\n  setListeners,\n  removeListeners,\n} = useEnvironmentObserver(container, findActiveTab);\n\nwatch(localValue, findActiveTab);\nonMounted(() => {\n  findActiveTab();\n  setListeners();\n});\nonBeforeUnmount(removeListeners);\n</script>\n\n<style lang=\"scss\" module>\n@import \"src/assets/styles/utils\";\n\n@keyframes options-ghost {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n.wrapper {\n  @include transparentOnDisabled;\n}\n\n.label {\n  font-weight: 400;\n  & + .options {\n    margin-top: 6px;\n  }\n}\n\n.options {\n  position: relative;\n  display: flex;\n}\n\n.vertical {\n  flex-direction: column;\n}\n\n.item {\n  position: relative;\n  z-index: 2;\n  cursor: pointer;\n  transition: color 300ms, transform 200ms;\n  user-select: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.ghost {\n  position: absolute;\n  transition: 270ms transform, 270ms width, 360ms background-color, 300ms opacity;\n  border-radius: 5px;\n  &.animated {\n    animation: options-ghost .7s ease-in-out;\n  }\n}\n\n.primaryColor, .primaryColor2 {\n  &.options {\n    border-radius: 5px;\n  }\n  .item {\n    color: rgb(var(--color-accent-2));\n    transition: 300ms color;\n    flex-grow: 1;\n    &.active {\n      color: rgb(var(--color-accent-1));\n    }\n  }\n  .ghost {\n    background: var(--color-main-gradient);\n    border-radius: 5px;\n  }\n}\n\n.primaryColor {\n  background-color: rgb(var(--color-background-3));\n}\n\n.primaryColor2 {\n  background-color: rgb(var(--color-background-2));\n}\n\n.defaultSize {\n  &.options {\n    border-radius: 5px;\n  }\n  .item {\n    @include title4;\n    padding: 4px 10px;\n    font-weight: 600;\n    font-size: 14px;\n    height: 100%;\n    flex-grow: 1;\n  }\n  .ghost {\n    border-radius: 5px;\n  }\n}\n\n.mdSize {\n  &.options {\n    border-radius: 5px;\n  }\n  .item {\n    @include title4;\n    padding: 5.5px 10px;\n    font-weight: 600;\n    font-size: 14px;\n    height: 100%;\n    flex-grow: 1;\n  }\n  .ghost {\n    border-radius: 5px;\n  }\n}\n\n.lgSize {\n  &.options {\n    border-radius: 5px;\n  }\n  .item {\n    @include title1;\n    font-weight: 700;\n    padding: 10px;\n    height: 100%;\n    flex-grow: 1;\n  }\n  .ghost {\n    border-radius: 5px;\n  }\n}\n\n.secondaryColor5 {\n  &.options {\n    background-color: rgb(var(--color-background-2));\n  }\n  .item {\n    color: rgb(var(--color-accent-2));\n    flex-grow: 1;\n    &.active {\n      color: rgb(var(--color-accent-1));\n    }\n  }\n  .ghost {\n    background: rgb(var(--color-background-5));\n    border-radius: 5px;\n  }\n}\n\n.secondaryColor2 {\n  &.options {\n    background-color: rgb(var(--color-background-2));\n  }\n  .item {\n    color: rgb(var(--color-accent-2));\n    &.active {\n      color: rgb(var(--color-accent-1));\n    }\n  }\n  .ghost {\n    background-color: rgb(var(--color-background-3));\n  }\n}\n\n.blueGlassVerticalRight {\n  &.options {\n  }\n  .item {\n    color: rgb(var(--color-accent-2));\n    &.active {\n      color: rgb(var(--color-accent-1));\n    }\n  }\n  .ghost {\n    background-color: rgb(var(--color-background-1));\n    border-right: 2px solid rgb(var(--color-primary-1));\n  }\n}\n\n.specialFavoritesSize {\n  &.options {\n  }\n  .item {\n    flex-grow: 1;\n  }\n  .ghost {\n    border-radius: 0;\n  }\n}\n\n.simpleColor {\n  &.options {\n  }\n  .item {\n    color: rgb(var(--color-accent-2));\n    &.active {\n      color: rgb(var(--color-accent-1));\n    }\n  }\n  .ghost {\n    display: none;\n  }\n}\n\n.tabsShape {\n  &.options {\n    border-radius: 10px 10px 0 0;\n    overflow: hidden;\n  }\n  .item {\n    @include title4;\n    padding: 15px 0;\n    font-weight: 600;\n    font-size: 14px;\n    height: 100%;\n    flex-grow: 1;\n  }\n  .ghost {\n    border-radius: 10px 10px 0 0;\n  }\n}\n\n.successBackground {\n  background-color: rgb(var(--color-success)) !important;\n}\n\n.dangerBackground {\n  background-color: rgb(var(--color-danger)) !important;\n}\n\n.primaryTextColor {\n  color: rgb(var(--color-primary-1)) !important;\n}\n\n.danger2TextColor {\n  color: rgb(var(--color-danger-2)) !important;\n}\n\n.accent1TextColor {\n  color: rgb(var(--color-accent-1)) !important;\n}\n</style>\n\n<style lang=\"scss\">\n@import \"src/assets/styles\";\n\n.selectorElementAppearance {\n  &-enter-active,\n  &-leave-active {\n    transition: opacity 170ms, transform 200ms, height 200ms;\n  }\n  &-enter-from,\n  &-leave-to {\n    opacity: 0;\n    height: 0 !important;\n    transform: scale(0.9) translateY(10px);\n  }\n\n  &-enter-from {\n    transform: scale(0.9) translateY(-10px);\n  }\n}\n</style>\n"],"names":["computedStates","useComputedState","props","container","ref","optionRefs","onBeforeUpdate","localValue","useLocalValue","emit","detectDirection","nextOption","previousOption","activeOptionIndex","option","nextOptionIndex","isForward","watch","activeOption","computed","onOptionClick","selectingOption","computedGhostStyles","findActiveTab","activeTabElement","_a","containerLeft","containerTop","width","height","left","top","getRect","thickening","normalized","multiply","toCssPxValue","add","roundToDecimalPlaces","onElementRemove","removingElement","compose","addCssProperty","setListeners","removeListeners","useEnvironmentObserver","onMounted","onBeforeUnmount"],"mappings":";;;;;;;;;;;;;;;;;;;;;iBA+FMA,IAAiBC,GAAiBC,CAAK;AAEzC,QAAA,CAACA,EAAM;AACH,YAAA,IAAI,MAAM,+DAA+D;AAGjF,UAAMC,IAAYC,KACZC,IAAaD,EAAkD,CAAA,CAAE;AACvE,IAAAE,EAAe,MAAM;AACnB,MAAAD,EAAW,QAAQ;IAAC,CACrB;AAED,UAAME,IAAaC;AAAA,MACjBN;AAAA,MACAO;AAAA,MACA;AAAA,IAAA,GAGIC,IAAkB,CAACC,GAAoBC,MAA2B;AAChE,YAAAC,IAAoBX,EAAM,QAAQ;AAAA,QACtC,CAACY,MAA2BA,EAAO,UAAUF;AAAA,MAAA,GAEzCG,IAAkBb,EAAM,QAAQ;AAAA,QACpC,CAACY,MAA2BA,EAAO,UAAUH;AAAA,MAAA,GAEzCK,IAAYH,IAAoBE;AAEtC,MACEN,EADEO,IACG,eAEA,YAFY;AAAA,IAGnB;AAEF,IAAAC,EAAMV,GAAYG,CAAe;AAEjC,UAAMQ,IAAeC,EAAyB,MAAMjB,EAAM,QAAQ;AAAA,MAChE,CAACY,MAA2BA,EAAO,UAAUP,EAAW;AAAA,SACrD,EAAE,OAAO,IAAI,OAAO,GAAI,CAAA,GAEvBa,IAAgB,CAACC,MAAoC;AACzC,MAAAX,EAAAW,EAAgB,OAAOd,EAAW,KAAK,GACvDA,EAAW,QAAQc,EAAgB;AAAA,IAAA,GAG/BC,IAAsBlB,EAAI;AAAA,MAC9B,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,WAAW;AAAA,IAAA,CACZ,GAEKmB,IAAgB,MAAM;;AAC1B,UAAI,CAACpB,EAAU,SAAS,CAACI,EAAW;AAAO;AAE3C,YAAMiB,KAAmBC,IAAApB,EAAW,UAAX,gBAAAoB,EAAmBlB,EAAW;AAEvD,UAAI,CAACiB;AAAkB;AAEjB,YAAA,EAAE,MAAME,GAAe,KAAKC,MAAiBxB,EAAU,MAAM,yBAC7D;AAAA,QACJ,OAAAyB;AAAA,QAAO,QAAAC;AAAA,QAAQ,MAAAC;AAAA,QAAM,KAAAC;AAAA,MAAA,IACnBC,EAAQR,CAAgB,GAEtB,EAAE,YAAAS,EAAe,IAAA/B,GAEjBgC,IAAaC,EAASF,GAAY,CAAC;AAEzC,MAAAX,EAAoB,MAAM,QAAQc;AAAA,QAChCC,EAAIT,GAAOM,CAAU;AAAA,MAAA,GAEvBZ,EAAoB,MAAM,SAASc;AAAA,QACjCC,EAAIR,GAAQK,CAAU;AAAA,MAAA,GAGJZ,EAAA,MAAM,YAAY,cACpCc;AAAA,QACEE,EAAqB,GAAIR,IAAOJ,IAAkBQ,IAAa,CAAE;AAAA,MAGnE,iBAAAE;AAAA,QACEE,EAAqB,GAAIP,IAAMJ,IAAiBO,IAAa,CAAE;AAAA,MACjE;AAAA,IAAA,GAIEK,IAAkB,CAACC,MAAiC;AAIlD,YAAA;AAAA,QACJ,QAAAX;AAAA,MAAA,IACEG,EAAQQ,CAAe;AAE3B,MAAAC;AAAA,QACEC,EAAe,CAAC,UAAU,CAAC,CAAC;AAAA,QAC5BA,EAAe,CAAC,UAAUN,EAAaP,CAAM,CAAC,CAAC;AAAA,QAC/CW,CAAe;AAAA,IAAA,GAGb;AAAA,MACJ,cAAAG;AAAA,MACA,iBAAAC;AAAA,IAAA,IACEC,GAAuB1C,GAAWoB,CAAa;AAEnD,WAAAN,EAAMV,GAAYgB,CAAa,GAC/BuB,EAAU,MAAM;AACA,MAAAvB,KACDoB;IAAA,CACd,GACDI,EAAgBH,CAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}