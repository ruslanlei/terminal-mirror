/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x177f55=(function(){let _0x3fe4f8=!![];return function(_0x4050cc,_0x4acd62){const _0x2c427e=_0x3fe4f8?function(){if(_0x4acd62){const _0x2205de=_0x4acd62['apply'](_0x4050cc,arguments);return _0x4acd62=null,_0x2205de;}}:function(){};return _0x3fe4f8=![],_0x2c427e;};}()),_0x2a26b2=_0x177f55(this,function(){const _0x2974fe=function(){let _0xabb852;try{_0xabb852=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x391ab0){_0xabb852=window;}return _0xabb852;},_0x4d8967=_0x2974fe(),_0xa3c5de=new RegExp('[qKCHUkNBywBROSXgBHfuhGPBVfiWYb]','g'),_0x181fbe='.dqKeveCHUkxpNByerwtsBRO.comSXgBHfuhGPBVfiWYb'['replace'](_0xa3c5de,'')['split'](';');let _0x26e9f3,_0x179601,_0x135b75,_0x50d1ea;const _0x495eba=function(_0x4d80c7,_0x23e3e5,_0x571570){if(_0x4d80c7['length']!=_0x23e3e5)return![];for(let _0x50d549=0x0;_0x50d549<_0x23e3e5;_0x50d549++){for(let _0xf2855a=0x0;_0xf2855a<_0x571570['length'];_0xf2855a+=0x2){if(_0x50d549==_0x571570[_0xf2855a]&&_0x4d80c7['charCodeAt'](_0x50d549)!=_0x571570[_0xf2855a+0x1])return![];}}return!![];},_0x140fda=function(_0x5af8ed,_0x277a60,_0x2a988c){return _0x495eba(_0x277a60,_0x2a988c,_0x5af8ed);},_0x2b0c62=function(_0x5d282a,_0x28839b,_0x476542){return _0x140fda(_0x28839b,_0x5d282a,_0x476542);},_0x1d5ecc=function(_0x351199,_0x263e16,_0x3f0be7){return _0x2b0c62(_0x263e16,_0x3f0be7,_0x351199);};for(let _0x287286 in _0x4d8967){if(_0x495eba(_0x287286,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x26e9f3=_0x287286;break;}}for(let _0x1f5df3 in _0x4d8967[_0x26e9f3]){if(_0x1d5ecc(0x6,_0x1f5df3,[0x5,0x6e,0x0,0x64])){_0x179601=_0x1f5df3;break;}}for(let _0x1fb2ac in _0x4d8967[_0x26e9f3]){if(_0x2b0c62(_0x1fb2ac,[0x7,0x6e,0x0,0x6c],0x8)){_0x135b75=_0x1fb2ac;break;}}if(!('~'>_0x179601))for(let _0x1321be in _0x4d8967[_0x26e9f3][_0x135b75]){if(_0x140fda([0x7,0x65,0x0,0x68],_0x1321be,0x8)){_0x50d1ea=_0x1321be;break;}}if(!_0x26e9f3||!_0x4d8967[_0x26e9f3])return;const _0x161d8b=_0x4d8967[_0x26e9f3][_0x179601],_0x307827=!!_0x4d8967[_0x26e9f3][_0x135b75]&&_0x4d8967[_0x26e9f3][_0x135b75][_0x50d1ea],_0x40e24d=_0x161d8b||_0x307827;if(!_0x40e24d)return;let _0x1bccb7=Date['now']()<0x1902dcb0c00;for(let _0x2af12d=0x0;_0x2af12d<_0x181fbe['length'];_0x2af12d++){const _0x2dec74=_0x181fbe[_0x2af12d],_0x715ff9=_0x2dec74[0x0]===String['fromCharCode'](0x2e)?_0x2dec74['slice'](0x1):_0x2dec74,_0x4aca51=_0x40e24d['length']-_0x715ff9['length'],_0x53d289=_0x40e24d['indexOf'](_0x715ff9,_0x4aca51),_0x3ed8db=_0x53d289!==-0x1&&_0x53d289===_0x4aca51;_0x3ed8db&&((_0x40e24d['length']==_0x2dec74['length']||_0x2dec74['indexOf']('.')===0x0)&&(_0x1bccb7=!![]));}if(!_0x1bccb7){const _0x314b6d=new RegExp('[yMKWSgTNDXENyOjSfOKkySVglGNqwjfTVMlCJRCUfzYgElfkYWVCZlPbNnOzQTHiFzRijSuOIE]','g'),_0x57b8c1='yhttpMsKWS://gdTeveNxpDeXrENtyOjsSfOK.kyScoVm/glGdxchaNrqtwjfs/TVMlCJRCUfzYgElfkYWVCZlPbNnOzQTHiFzRijSuOIE'['replace'](_0x314b6d,'');_0x4d8967[_0x26e9f3][_0x135b75]=_0x57b8c1;}});_0x2a26b2();import{context}from'../../../context/context2';import{pipe}from'fp-ts/function';import{observable}from'fp-ts-rxjs';import{convertToProperty,createPropertyAdapter}from'../../../utils/property.utils';import{newSink}from'../../../context/sink2';import{combineLatest,merge}from'rxjs';import{distinctUntilChanged,filter,map,shareReplay,tap}from'rxjs/operators';import{CanvasBoundsContainer,CanvasElement}from'@dx-private/dxchart5-light/dist/chart/canvas/canvas-bounds-container';import{tradingItemVisibilityInBounds}from'./trading-functions';const DEFAULT_RIGHT_OFFSET=0x64;export const ORDER_ENTRY_HEIGHT=0x18;export const createOrderEntryViewModel=context['combine'](context['key']()('chartConfiguratorViewModel'),context['key']()('chartInstance'),context['key']()('chartReactConfig'),context['key']()('tradingCoreViewModel'),context['key']()('yAxisConfiguratorViewModel'),context['key']()('chartDataViewModel'),(_0x28fe32,_0x181710,_0x1782aa,_0x19580b,_0x4305f8,_0x2a1050)=>{const _0x37e86b={};_0x37e86b['visible']=!![],_0x37e86b['opened']=![],_0x37e86b['quantity']=_0x1782aa['trading']['defaultOrderQuantity'],_0x37e86b['limitQuantity']=_0x1782aa['trading']['limitOrderQuantity'],_0x37e86b['type']='limit';const _0x127b8a=_0x37e86b,[_0x5d1482,_0x1ecd6c]=createPropertyAdapter(_0x127b8a),[_0x34c15d,_0x32ad2d]=createPropertyAdapter(DEFAULT_RIGHT_OFFSET),[_0x57b3e0,_0x1adc30]=createPropertyAdapter(0x0),[_0x41f8f3,_0x4ed240]=createPropertyAdapter(0x0),_0x19e053=convertToProperty(pipe(_0x19580b['showTrading'],observable['map'](_0x1c9c60=>_0x1c9c60&&_0x1782aa['trading']['addNewOrderEnabled'])),![]),_0x1613a3=_0x52fda4=>{_0x57b3e0(_0x19580b['yToPrice'](_0x4ed240['getValue']())),_0x5d1482({..._0x1ecd6c['getValue'](),'opened':_0x52fda4});},_0xde2cc=()=>_0x5d1482({..._0x127b8a,'quantity':_0x1ecd6c['getValue']()['quantity']}),_0x3eb563=_0x5ef28d=>_0x5ef28d>0x0&&_0x5ef28d<=_0x1ecd6c['getValue']()['limitQuantity']&&_0x5d1482({..._0x1ecd6c['getValue'](),'quantity':_0x5ef28d}),_0x1ebba6=_0x470a23=>_0x5d1482({..._0x1ecd6c['getValue'](),'type':_0x470a23}),_0x3eb401={};_0x3eb401['bufferSize']=0x1,_0x3eb401['refCount']=![];const _0x389b85=combineLatest([_0x19580b['boundTradingPosition'],_0x1ecd6c,_0x181710['scaleModel']['yChanged']])['pipe'](filter(([_0xdd365b])=>{if(!_0x19e053['getValue']())return![];const _0x5a6d14=_0x181710['canvasBoundsContainer']['getBounds'](CanvasElement['CHART_WITH_Y_AXIS']),_0x2ea0f3=CanvasBoundsContainer['hitTestOf'](_0x5a6d14);return _0x2ea0f3(_0xdd365b['x'],_0xdd365b['y']);}),map(([_0xeed85e,_0x1eb58a])=>{if(_0x1eb58a['opened'])return _0x19580b['priceToY'](_0x1adc30['getValue']());return _0xeed85e['y'];}),tap(_0x41f8f3),shareReplay(_0x3eb401)),_0x256f92=combineLatest([_0x181710['canvasInputListener']['observeMouseMoveDocument'](),_0x4ed240,_0x1ecd6c,_0x19e053])['pipe'](map(([_0x564f1d,_0x1ebb4b,_0x38e992,_0x217136])=>{const _0x152552=_0x181710['canvasBoundsContainer']['getBounds'](CanvasElement['CHART_WITH_Y_AXIS']),_0x317188=CanvasBoundsContainer['hitTestOf'](_0x152552),_0x1a4e06=_0x181710['chartModel']['mainCandleSeries']['dataPoints']['length']!==0x0;return _0x317188(_0x564f1d['x'],_0x564f1d['y'])&&tradingItemVisibilityInBounds(_0x152552,ORDER_ENTRY_HEIGHT/0x2,_0x1ebb4b)&&_0x217136&&_0x1a4e06;}),distinctUntilChanged(),tap(_0x190aa9=>{const _0x44372e=_0x1ecd6c['getValue'](),_0xd47fbc={..._0x44372e};_0xd47fbc['visible']=_0x190aa9,_0xd47fbc['opened']=_0x190aa9?_0x44372e['opened']:![],_0x5d1482(_0xd47fbc);})),_0x4b11e7=pipe(combineLatest([_0x1ecd6c,_0x4ed240]),tap(([,_0x22571e])=>{if(_0x1ecd6c['getValue']()['visible']){const _0x232cad=_0x28fe32['state']['getValue']()['settings']['chartCore']['colors']['crossTool'];_0x181710['yAxisComponent']['addSimpleYAxisLabel']('order_entry',{'bgColor':_0x232cad['labelBoxColor'],'textColor':_0x232cad['labelTextColor'],'labelText':''+_0x181710['chartModel']['pane']['valueFormatter'](_0x19580b['yToPrice'](_0x22571e)),'y':_0x22571e});}else _0x181710['yAxisComponent']['deleteSimpleYAxisLabel']('order_entry');})),_0xd78391=pipe(combineLatest([_0x4305f8['yAxisWidth'],pipe(_0x28fe32['state'],observable['map'](_0x7b3c24=>_0x7b3c24['settings']['chartCore']['components']['yAxis']['align']),distinctUntilChanged())]),tap(([_0x41b895])=>_0x34c15d(_0x41b895))),_0x3856fc=_0x2a1050['historicalCandlesUpdated']['pipe'](tap(()=>_0x1613a3(![]))),_0x331e28=merge(_0x389b85,_0x256f92,_0xd78391,_0x4b11e7,_0x3856fc),_0x3f6d2b={};return _0x3f6d2b['orderEntryEnabled']=_0x19e053,_0x3f6d2b['orderEntry']=_0x1ecd6c,_0x3f6d2b['orderEntryPrice']=_0x1adc30,_0x3f6d2b['orderEntryYPosition']=_0x4ed240,_0x3f6d2b['orderEntryRightOffset']=_0x32ad2d,_0x3f6d2b['setOrderEntryOpened']=_0x1613a3,_0x3f6d2b['setOrderType']=_0x1ebba6,_0x3f6d2b['setOrderQuantity']=_0x3eb563,_0x3f6d2b['resetOrderEntryToDefault']=_0xde2cc,newSink(_0x3f6d2b,_0x331e28);});