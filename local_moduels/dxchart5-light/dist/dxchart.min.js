/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
var dxChart5;(()=>{var Ya={8168:(R,M,x)=>{var L=x(9092),N={};for(var F in L)L.hasOwnProperty(F)&&(N[L[F]]=F);var T=R.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var E in T)if(T.hasOwnProperty(E)){if(!("channels"in T[E]))throw new Error("missing channels property: "+E);if(!("labels"in T[E]))throw new Error("missing channel labels property: "+E);if(T[E].labels.length!==T[E].channels)throw new Error("channel and label counts mismatch: "+E);var w=T[E].channels,C=T[E].labels;delete T[E].channels,delete T[E].labels,Object.defineProperty(T[E],"channels",{value:w}),Object.defineProperty(T[E],"labels",{value:C})}T.rgb.hsl=function(h){var m=h[0]/255,y=h[1]/255,p=h[2]/255,_=Math.min(m,y,p),f=Math.max(m,y,p),d=f-_,v,S,A;return f===_?v=0:m===f?v=(y-p)/d:y===f?v=2+(p-m)/d:p===f&&(v=4+(m-y)/d),v=Math.min(v*60,360),v<0&&(v+=360),A=(_+f)/2,f===_?S=0:A<=.5?S=d/(f+_):S=d/(2-f-_),[v,S*100,A*100]},T.rgb.hsv=function(h){var m,y,p,_,f,d=h[0]/255,v=h[1]/255,S=h[2]/255,A=Math.max(d,v,S),O=A-Math.min(d,v,S),H=function(V){return(A-V)/6/O+1/2};return O===0?_=f=0:(f=O/A,m=H(d),y=H(v),p=H(S),d===A?_=p-y:v===A?_=.3333333333333333+m-p:S===A&&(_=.6666666666666666+y-m),_<0?_+=1:_>1&&(_-=1)),[_*360,f*100,A*100]},T.rgb.hwb=function(h){var m=h[0],y=h[1],p=h[2],_=T.rgb.hsl(h)[0],f=1/255*Math.min(m,Math.min(y,p));return p=1-.00392156862745098*Math.max(m,Math.max(y,p)),[_,f*100,p*100]},T.rgb.cmyk=function(h){var m=h[0]/255,y=h[1]/255,p=h[2]/255,_,f,d,v;return v=Math.min(1-m,1-y,1-p),_=(1-m-v)/(1-v)||0,f=(1-y-v)/(1-v)||0,d=(1-p-v)/(1-v)||0,[_*100,f*100,d*100,v*100]};function D(h,m){return Math.pow(h[0]-m[0],2)+Math.pow(h[1]-m[1],2)+Math.pow(h[2]-m[2],2)}T.rgb.keyword=function(h){var m=N[h];if(m)return m;var y=1/0,p;for(var _ in L)if(L.hasOwnProperty(_)){var f=L[_],d=D(h,f);d<y&&(y=d,p=_)}return p},T.keyword.rgb=function(h){return L[h]},T.rgb.xyz=function(h){var m=h[0]/255,y=h[1]/255,p=h[2]/255;m=m>.04045?Math.pow((m+.055)/1.055,2.4):m/12.92,y=y>.04045?Math.pow((y+.055)/1.055,2.4):y/12.92,p=p>.04045?Math.pow((p+.055)/1.055,2.4):p/12.92;var _=m*.4124+y*.3576+p*.1805,f=m*.2126+y*.7152+p*.0722,d=m*.0193+y*.1192+p*.9505;return[_*100,f*100,d*100]},T.rgb.lab=function(h){var m=T.rgb.xyz(h),y=m[0],p=m[1],_=m[2],f,d,v;return y/=95.047,p/=100,_/=108.883,y=y>.008856?Math.pow(y,.3333333333333333):7.787*y+.13793103448275862,p=p>.008856?Math.pow(p,.3333333333333333):7.787*p+.13793103448275862,_=_>.008856?Math.pow(_,.3333333333333333):7.787*_+.13793103448275862,f=116*p-16,d=500*(y-p),v=200*(p-_),[f,d,v]},T.hsl.rgb=function(h){var m=h[0]/360,y=h[1]/100,p=h[2]/100,_,f,d,v,S;if(y===0)return S=p*255,[S,S,S];p<.5?f=p*(1+y):f=p+y-p*y,_=2*p-f,v=[0,0,0];for(var A=0;A<3;A++)d=m+.3333333333333333*-(A-1),d<0&&d++,d>1&&d--,6*d<1?S=_+(f-_)*6*d:2*d<1?S=f:3*d<2?S=_+(f-_)*(.6666666666666666-d)*6:S=_,v[A]=S*255;return v},T.hsl.hsv=function(h){var m=h[0],y=h[1]/100,p=h[2]/100,_=y,f=Math.max(p,.01),d,v;return p*=2,y*=p<=1?p:2-p,_*=f<=1?f:2-f,v=(p+y)/2,d=p===0?2*_/(f+_):2*y/(p+y),[m,d*100,v*100]},T.hsv.rgb=function(h){var m=h[0]/60,y=h[1]/100,p=h[2]/100,_=Math.floor(m)%6,f=m-Math.floor(m),d=255*p*(1-y),v=255*p*(1-y*f),S=255*p*(1-y*(1-f));switch(p*=255,_){case 0:return[p,S,d];case 1:return[v,p,d];case 2:return[d,p,S];case 3:return[d,v,p];case 4:return[S,d,p];case 5:return[p,d,v]}},T.hsv.hsl=function(h){var m=h[0],y=h[1]/100,p=h[2]/100,_=Math.max(p,.01),f,d,v;return v=(2-y)*p,f=(2-y)*_,d=y*_,d/=f<=1?f:2-f,d=d||0,v/=2,[m,d*100,v*100]},T.hwb.rgb=function(h){var m=h[0]/360,y=h[1]/100,p=h[2]/100,_=y+p,f,d,v,S;_>1&&(y/=_,p/=_),f=Math.floor(6*m),d=1-p,v=6*m-f,f&1&&(v=1-v),S=y+v*(d-y);var A,O,H;switch(f){default:case 6:case 0:A=d,O=S,H=y;break;case 1:A=S,O=d,H=y;break;case 2:A=y,O=d,H=S;break;case 3:A=y,O=S,H=d;break;case 4:A=S,O=y,H=d;break;case 5:A=d,O=y,H=S;break}return[A*255,O*255,H*255]},T.cmyk.rgb=function(h){var m=h[0]/100,y=h[1]/100,p=h[2]/100,_=h[3]/100,f,d,v;return f=1-Math.min(1,m*(1-_)+_),d=1-Math.min(1,y*(1-_)+_),v=1-Math.min(1,p*(1-_)+_),[f*255,d*255,v*255]},T.xyz.rgb=function(h){var m=h[0]/100,y=h[1]/100,p=h[2]/100,_,f,d;return _=m*3.2406+y*-1.5372+p*-.4986,f=m*-.9689+y*1.8758+p*.0415,d=m*.0557+y*-.204+p*1.057,_=_>.0031308?1.055*Math.pow(_,.4166666666666667)-.055:_*12.92,f=f>.0031308?1.055*Math.pow(f,.4166666666666667)-.055:f*12.92,d=d>.0031308?1.055*Math.pow(d,.4166666666666667)-.055:d*12.92,_=Math.min(Math.max(0,_),1),f=Math.min(Math.max(0,f),1),d=Math.min(Math.max(0,d),1),[_*255,f*255,d*255]},T.xyz.lab=function(h){var m=h[0],y=h[1],p=h[2],_,f,d;return m/=95.047,y/=100,p/=108.883,m=m>.008856?Math.pow(m,.3333333333333333):7.787*m+.13793103448275862,y=y>.008856?Math.pow(y,.3333333333333333):7.787*y+.13793103448275862,p=p>.008856?Math.pow(p,.3333333333333333):7.787*p+.13793103448275862,_=116*y-16,f=500*(m-y),d=200*(y-p),[_,f,d]},T.lab.xyz=function(h){var m=h[0],y=h[1],p=h[2],_,f,d;f=(m+16)/116,_=y/500+f,d=f-p/200;var v=Math.pow(f,3),S=Math.pow(_,3),A=Math.pow(d,3);return f=v>.008856?v:(f-.13793103448275862)/7.787,_=S>.008856?S:(_-.13793103448275862)/7.787,d=A>.008856?A:(d-.13793103448275862)/7.787,_*=95.047,f*=100,d*=108.883,[_,f,d]},T.lab.lch=function(h){var m=h[0],y=h[1],p=h[2],_,f,d;return _=Math.atan2(p,y),f=_*360/2/Math.PI,f<0&&(f+=360),d=Math.sqrt(y*y+p*p),[m,d,f]},T.lch.lab=function(h){var m=h[0],y=h[1],p=h[2],_,f,d;return d=p/360*2*Math.PI,_=y*Math.cos(d),f=y*Math.sin(d),[m,_,f]},T.rgb.ansi16=function(h){var m=h[0],y=h[1],p=h[2],_=1 in arguments?arguments[1]:T.rgb.hsv(h)[2];if(_=Math.round(_/50),_===0)return 30;var f=30+(Math.round(p/255)<<2|Math.round(y/255)<<1|Math.round(m/255));return _===2&&(f+=60),f},T.hsv.ansi16=function(h){return T.rgb.ansi16(T.hsv.rgb(h),h[2])},T.rgb.ansi256=function(h){var m=h[0],y=h[1],p=h[2];if(m===y&&y===p)return m<8?16:m>248?231:Math.round((m-8)/247*24)+232;var _=16+36*Math.round(m/255*5)+6*Math.round(y/255*5)+Math.round(p/255*5);return _},T.ansi16.rgb=function(h){var m=h%10;if(m===0||m===7)return h>50&&(m+=3.5),m=m/10.5*255,[m,m,m];var y=(~~(h>50)+1)*.5,p=(m&1)*y*255,_=(m>>1&1)*y*255,f=(m>>2&1)*y*255;return[p,_,f]},T.ansi256.rgb=function(h){if(h>=232){var m=(h-232)*10+8;return[m,m,m]}h-=16;var y,p=Math.floor(h/36)/5*255,_=Math.floor((y=h%36)/6)/5*255,f=y%6/5*255;return[p,_,f]},T.rgb.hex=function(h){var m=((Math.round(h[0])&255)<<16)+((Math.round(h[1])&255)<<8)+(Math.round(h[2])&255),y=m.toString(16).toUpperCase();return"000000".substring(y.length)+y},T.hex.rgb=function(h){var m=h.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!m)return[0,0,0];var y=m[0];m[0].length===3&&(y=y.split("").map(function(v){return v+v}).join(""));var p=parseInt(y,16),_=p>>16&255,f=p>>8&255,d=p&255;return[_,f,d]},T.rgb.hcg=function(h){var m=h[0]/255,y=h[1]/255,p=h[2]/255,_=Math.max(Math.max(m,y),p),f=Math.min(Math.min(m,y),p),d=_-f,v,S;return d<1?v=f/(1-d):v=0,d<=0?S=0:_===m?S=(y-p)/d%6:_===y?S=2+(p-m)/d:S=4+(m-y)/d+4,S/=6,S%=1,[S*360,d*100,v*100]},T.hsl.hcg=function(h){var m=h[1]/100,y=h[2]/100,p=1,_=0;return y<.5?p=2*m*y:p=2*m*(1-y),p<1&&(_=(y-.5*p)/(1-p)),[h[0],p*100,_*100]},T.hsv.hcg=function(h){var m=h[1]/100,y=h[2]/100,p=m*y,_=0;return p<1&&(_=(y-p)/(1-p)),[h[0],p*100,_*100]},T.hcg.rgb=function(h){var m=h[0]/360,y=h[1]/100,p=h[2]/100;if(y===0)return[p*255,p*255,p*255];var _=[0,0,0],f=m%1*6,d=f%1,v=1-d,S=0;switch(Math.floor(f)){case 0:_[0]=1,_[1]=d,_[2]=0;break;case 1:_[0]=v,_[1]=1,_[2]=0;break;case 2:_[0]=0,_[1]=1,_[2]=d;break;case 3:_[0]=0,_[1]=v,_[2]=1;break;case 4:_[0]=d,_[1]=0,_[2]=1;break;default:_[0]=1,_[1]=0,_[2]=v}return S=(1-y)*p,[(y*_[0]+S)*255,(y*_[1]+S)*255,(y*_[2]+S)*255]},T.hcg.hsv=function(h){var m=h[1]/100,y=h[2]/100,p=m+y*(1-m),_=0;return p>0&&(_=m/p),[h[0],_*100,p*100]},T.hcg.hsl=function(h){var m=h[1]/100,y=h[2]/100,p=y*(1-m)+.5*m,_=0;return p>0&&p<.5?_=m/(2*p):p>=.5&&p<1&&(_=m/(2*(1-p))),[h[0],_*100,p*100]},T.hcg.hwb=function(h){var m=h[1]/100,y=h[2]/100,p=m+y*(1-m);return[h[0],(p-m)*100,(1-p)*100]},T.hwb.hcg=function(h){var m=h[1]/100,y=h[2]/100,p=1-y,_=p-m,f=0;return _<1&&(f=(p-_)/(1-_)),[h[0],_*100,f*100]},T.apple.rgb=function(h){return[h[0]/65535*255,h[1]/65535*255,h[2]/65535*255]},T.rgb.apple=function(h){return[h[0]/255*65535,h[1]/255*65535,h[2]/255*65535]},T.gray.rgb=function(h){return[h[0]/100*255,h[0]/100*255,h[0]/100*255]},T.gray.hsl=T.gray.hsv=function(h){return[0,0,h[0]]},T.gray.hwb=function(h){return[0,100,h[0]]},T.gray.cmyk=function(h){return[0,0,0,h[0]]},T.gray.lab=function(h){return[h[0],0,0]},T.gray.hex=function(h){var m=Math.round(h[0]/100*255)&255,y=(m<<16)+(m<<8)+m,p=y.toString(16).toUpperCase();return"000000".substring(p.length)+p},T.rgb.gray=function(h){var m=(h[0]+h[1]+h[2])/3;return[m/255*100]}},2085:(R,M,x)=>{var L=x(8168),N=x(4111),F={},T=Object.keys(L);function E(C){var D=function(h){return h==null?h:(arguments.length>1&&(h=Array.prototype.slice.call(arguments)),C(h))};return"conversion"in C&&(D.conversion=C.conversion),D}function w(C){var D=function(h){if(h==null)return h;arguments.length>1&&(h=Array.prototype.slice.call(arguments));var m=C(h);if(typeof m=="object")for(var y=m.length,p=0;p<y;p++)m[p]=Math.round(m[p]);return m};return"conversion"in C&&(D.conversion=C.conversion),D}T.forEach(function(C){F[C]={},Object.defineProperty(F[C],"channels",{value:L[C].channels}),Object.defineProperty(F[C],"labels",{value:L[C].labels});var D=N(C),h=Object.keys(D);h.forEach(function(m){var y=D[m];F[C][m]=w(y),F[C][m].raw=E(y)})}),R.exports=F},9092:R=>{"use strict";R.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},4111:(R,M,x)=>{var L=x(8168);function N(){for(var w={},C=Object.keys(L),D=C.length,h=0;h<D;h++)w[C[h]]={distance:-1,parent:null};return w}function F(w){var C=N(),D=[w];for(C[w].distance=0;D.length;)for(var h=D.pop(),m=Object.keys(L[h]),y=m.length,p=0;p<y;p++){var _=m[p],f=C[_];f.distance===-1&&(f.distance=C[h].distance+1,f.parent=h,D.unshift(_))}return C}function T(w,C){return function(D){return C(w(D))}}function E(w,C){for(var D=[C[w].parent,w],h=L[C[w].parent][w],m=C[w].parent;C[m].parent;)D.unshift(C[m].parent),h=T(L[C[m].parent][m],h),m=C[m].parent;return h.conversion=D,h}R.exports=function(w){for(var C=F(w),D={},h=Object.keys(C),m=h.length,y=0;y<m;y++){var p=h[y],_=C[p];_.parent!==null&&(D[p]=E(p,C))}return D}},8874:R=>{"use strict";R.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},9818:(R,M,x)=>{var L=x(8874),N=x(6851),F=Object.hasOwnProperty,T=Object.create(null);for(var E in L)F.call(L,E)&&(T[L[E]]=E);var w=R.exports={to:{},get:{}};w.get=function(h){var m=h.substring(0,3).toLowerCase(),y,p;switch(m){case"hsl":y=w.get.hsl(h),p="hsl";break;case"hwb":y=w.get.hwb(h),p="hwb";break;default:y=w.get.rgb(h),p="rgb";break}return y?{model:p,value:y}:null},w.get.rgb=function(h){if(!h)return null;var m=/^#([a-f0-9]{3,4})$/i,y=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,p=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,_=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,f=/^(\w+)$/,d=[0,0,0,1],v,S,A;if(v=h.match(y)){for(A=v[2],v=v[1],S=0;S<3;S++){var O=S*2;d[S]=parseInt(v.slice(O,O+2),16)}A&&(d[3]=parseInt(A,16)/255)}else if(v=h.match(m)){for(v=v[1],A=v[3],S=0;S<3;S++)d[S]=parseInt(v[S]+v[S],16);A&&(d[3]=parseInt(A+A,16)/255)}else if(v=h.match(p)){for(S=0;S<3;S++)d[S]=parseInt(v[S+1],0);v[4]&&(v[5]?d[3]=parseFloat(v[4])*.01:d[3]=parseFloat(v[4]))}else if(v=h.match(_)){for(S=0;S<3;S++)d[S]=Math.round(parseFloat(v[S+1])*2.55);v[4]&&(v[5]?d[3]=parseFloat(v[4])*.01:d[3]=parseFloat(v[4]))}else return(v=h.match(f))?v[1]==="transparent"?[0,0,0,0]:F.call(L,v[1])?(d=L[v[1]],d[3]=1,d):null:null;for(S=0;S<3;S++)d[S]=C(d[S],0,255);return d[3]=C(d[3],0,1),d},w.get.hsl=function(h){if(!h)return null;var m=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,y=h.match(m);if(y){var p=parseFloat(y[4]),_=(parseFloat(y[1])%360+360)%360,f=C(parseFloat(y[2]),0,100),d=C(parseFloat(y[3]),0,100),v=C(isNaN(p)?1:p,0,1);return[_,f,d,v]}return null},w.get.hwb=function(h){if(!h)return null;var m=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,y=h.match(m);if(y){var p=parseFloat(y[4]),_=(parseFloat(y[1])%360+360)%360,f=C(parseFloat(y[2]),0,100),d=C(parseFloat(y[3]),0,100),v=C(isNaN(p)?1:p,0,1);return[_,f,d,v]}return null},w.to.hex=function(){var h=N(arguments);return"#"+D(h[0])+D(h[1])+D(h[2])+(h[3]<1?D(Math.round(h[3]*255)):"")},w.to.rgb=function(){var h=N(arguments);return h.length<4||h[3]===1?"rgb("+Math.round(h[0])+", "+Math.round(h[1])+", "+Math.round(h[2])+")":"rgba("+Math.round(h[0])+", "+Math.round(h[1])+", "+Math.round(h[2])+", "+h[3]+")"},w.to.rgb.percent=function(){var h=N(arguments),m=Math.round(h[0]/255*100),y=Math.round(h[1]/255*100),p=Math.round(h[2]/255*100);return h.length<4||h[3]===1?"rgb("+m+"%, "+y+"%, "+p+"%)":"rgba("+m+"%, "+y+"%, "+p+"%, "+h[3]+")"},w.to.hsl=function(){var h=N(arguments);return h.length<4||h[3]===1?"hsl("+h[0]+", "+h[1]+"%, "+h[2]+"%)":"hsla("+h[0]+", "+h[1]+"%, "+h[2]+"%, "+h[3]+")"},w.to.hwb=function(){var h=N(arguments),m="";return h.length>=4&&h[3]!==1&&(m=", "+h[3]),"hwb("+h[0]+", "+h[1]+"%, "+h[2]+"%"+m+")"},w.to.keyword=function(h){return T[h.slice(0,3)]};function C(h,m,y){return Math.min(Math.max(m,h),y)}function D(h){var m=Math.round(h).toString(16).toUpperCase();return m.length<2?"0"+m:m}},6767:(R,M,x)=>{"use strict";var L=x(9818),N=x(2085),F=[].slice,T=["keyword","gray","hex"],E={};Object.keys(N).forEach(function(f){E[F.call(N[f].labels).sort().join("")]=f});var w={};function C(f,d){if(!(this instanceof C))return new C(f,d);if(d&&d in T&&(d=null),d&&!(d in N))throw new Error("Unknown model: "+d);var v,S;if(f==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(f instanceof C)this.model=f.model,this.color=f.color.slice(),this.valpha=f.valpha;else if(typeof f=="string"){var A=L.get(f);if(A===null)throw new Error("Unable to parse color from string: "+f);this.model=A.model,S=N[this.model].channels,this.color=A.value.slice(0,S),this.valpha=typeof A.value[S]=="number"?A.value[S]:1}else if(f.length){this.model=d||"rgb",S=N[this.model].channels;var O=F.call(f,0,S);this.color=_(O,S),this.valpha=typeof f[S]=="number"?f[S]:1}else if(typeof f=="number")f&=16777215,this.model="rgb",this.color=[f>>16&255,f>>8&255,f&255],this.valpha=1;else{this.valpha=1;var H=Object.keys(f);"alpha"in f&&(H.splice(H.indexOf("alpha"),1),this.valpha=typeof f.alpha=="number"?f.alpha:0);var V=H.sort().join("");if(!(V in E))throw new Error("Unable to parse color from object: "+JSON.stringify(f));this.model=E[V];var Q=N[this.model].labels,j=[];for(v=0;v<Q.length;v++)j.push(f[Q[v]]);this.color=_(j)}if(w[this.model])for(S=N[this.model].channels,v=0;v<S;v++){var z=w[this.model][v];z&&(this.color[v]=z(this.color[v]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}C.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(f){var d=this.model in L.to?this:this.rgb();d=d.round(typeof f=="number"?f:1);var v=d.valpha===1?d.color:d.color.concat(this.valpha);return L.to[d.model](v)},percentString:function(f){var d=this.rgb().round(typeof f=="number"?f:1),v=d.valpha===1?d.color:d.color.concat(this.valpha);return L.to.rgb.percent(v)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var f={},d=N[this.model].channels,v=N[this.model].labels,S=0;S<d;S++)f[v[S]]=this.color[S];return this.valpha!==1&&(f.alpha=this.valpha),f},unitArray:function(){var f=this.rgb().color;return f[0]/=255,f[1]/=255,f[2]/=255,this.valpha!==1&&f.push(this.valpha),f},unitObject:function(){var f=this.rgb().object();return f.r/=255,f.g/=255,f.b/=255,this.valpha!==1&&(f.alpha=this.valpha),f},round:function(f){return f=Math.max(f||0,0),new C(this.color.map(h(f)).concat(this.valpha),this.model)},alpha:function(f){return arguments.length?new C(this.color.concat(Math.max(0,Math.min(1,f))),this.model):this.valpha},red:m("rgb",0,y(255)),green:m("rgb",1,y(255)),blue:m("rgb",2,y(255)),hue:m(["hsl","hsv","hsl","hwb","hcg"],0,function(f){return(f%360+360)%360}),saturationl:m("hsl",1,y(100)),lightness:m("hsl",2,y(100)),saturationv:m("hsv",1,y(100)),value:m("hsv",2,y(100)),chroma:m("hcg",1,y(100)),gray:m("hcg",2,y(100)),white:m("hwb",1,y(100)),wblack:m("hwb",2,y(100)),cyan:m("cmyk",0,y(100)),magenta:m("cmyk",1,y(100)),yellow:m("cmyk",2,y(100)),black:m("cmyk",3,y(100)),x:m("xyz",0,y(100)),y:m("xyz",1,y(100)),z:m("xyz",2,y(100)),l:m("lab",0,y(100)),a:m("lab",1),b:m("lab",2),keyword:function(f){return arguments.length?new C(f):N[this.model].keyword(this.color)},hex:function(f){return arguments.length?new C(f):L.to.hex(this.rgb().round().color)},rgbNumber:function(){var f=this.rgb().color;return(f[0]&255)<<16|(f[1]&255)<<8|f[2]&255},luminosity:function(){for(var f=this.rgb().color,d=[],v=0;v<f.length;v++){var S=f[v]/255;d[v]=S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4)}return .2126*d[0]+.7152*d[1]+.0722*d[2]},contrast:function(f){var d=this.luminosity(),v=f.luminosity();return d>v?(d+.05)/(v+.05):(v+.05)/(d+.05)},level:function(f){var d=this.contrast(f);return d>=7.1?"AAA":d>=4.5?"AA":""},isDark:function(){var f=this.rgb().color,d=(f[0]*299+f[1]*587+f[2]*114)/1e3;return d<128},isLight:function(){return!this.isDark()},negate:function(){for(var f=this.rgb(),d=0;d<3;d++)f.color[d]=255-f.color[d];return f},lighten:function(f){var d=this.hsl();return d.color[2]+=d.color[2]*f,d},darken:function(f){var d=this.hsl();return d.color[2]-=d.color[2]*f,d},saturate:function(f){var d=this.hsl();return d.color[1]+=d.color[1]*f,d},desaturate:function(f){var d=this.hsl();return d.color[1]-=d.color[1]*f,d},whiten:function(f){var d=this.hwb();return d.color[1]+=d.color[1]*f,d},blacken:function(f){var d=this.hwb();return d.color[2]+=d.color[2]*f,d},grayscale:function(){var f=this.rgb().color,d=f[0]*.3+f[1]*.59+f[2]*.11;return C.rgb(d,d,d)},fade:function(f){return this.alpha(this.valpha-this.valpha*f)},opaquer:function(f){return this.alpha(this.valpha+this.valpha*f)},rotate:function(f){var d=this.hsl(),v=d.color[0];return v=(v+f)%360,v=v<0?360+v:v,d.color[0]=v,d},mix:function(f,d){if(!f||!f.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof f);var v=f.rgb(),S=this.rgb(),A=d===void 0?.5:d,O=2*A-1,H=v.alpha()-S.alpha(),V=((O*H===-1?O:(O+H)/(1+O*H))+1)/2,Q=1-V;return C.rgb(V*v.red()+Q*S.red(),V*v.green()+Q*S.green(),V*v.blue()+Q*S.blue(),v.alpha()*A+S.alpha()*(1-A))}},Object.keys(N).forEach(function(f){if(T.indexOf(f)===-1){var d=N[f].channels;C.prototype[f]=function(){if(this.model===f)return new C(this);if(arguments.length)return new C(arguments,f);var v=typeof arguments[d]=="number"?d:this.valpha;return new C(p(N[this.model][f].raw(this.color)).concat(v),f)},C[f]=function(v){return typeof v=="number"&&(v=_(F.call(arguments),d)),new C(v,f)}}});function D(f,d){return Number(f.toFixed(d))}function h(f){return function(d){return D(d,f)}}function m(f,d,v){return f=Array.isArray(f)?f:[f],f.forEach(function(S){(w[S]||(w[S]=[]))[d]=v}),f=f[0],function(S){var A;return arguments.length?(v&&(S=v(S)),A=this[f](),A.color[d]=S,A):(A=this[f]().color[d],v&&(A=v(A)),A)}}function y(f){return function(d){return Math.max(0,Math.min(f,d))}}function p(f){return Array.isArray(f)?f:[f]}function _(f,d){for(var v=0;v<d;v++)typeof f[v]!="number"&&(f[v]=0);return f}R.exports=C},7394:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(L,N){for(var F=L<0?"-":"",T=Math.abs(L).toString();T.length<N;)T="0"+T;return F+T}R.exports=M.default},8609:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(L,N){if(L==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var F in N)Object.prototype.hasOwnProperty.call(N,F)&&(L[F]=N[F]);return L}R.exports=M.default},6420:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=F;var L=N(x(8609));function N(T){return T&&T.__esModule?T:{default:T}}function F(T){return(0,L.default)({},T)}R.exports=M.default},7561:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var L=N(x(2512));function N(T){return T&&T.__esModule?T:{default:T}}var F=L.default;M.default=F,R.exports=M.default},8729:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.getDefaultOptions=L,M.setDefaultOptions=N;var x={};function L(){return x}function N(F){x=F}},7100:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var L=D(x(1603)),N=D(x(1354)),F=D(x(1370)),T=D(x(623)),E=D(x(6226)),w=D(x(7394)),C=D(x(2699));function D(d){return d&&d.__esModule?d:{default:d}}var h={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},m={G:function(v,S,A){var O=v.getUTCFullYear()>0?1:0;switch(S){case"G":case"GG":case"GGG":return A.era(O,{width:"abbreviated"});case"GGGGG":return A.era(O,{width:"narrow"});case"GGGG":default:return A.era(O,{width:"wide"})}},y:function(v,S,A){if(S==="yo"){var O=v.getUTCFullYear(),H=O>0?O:1-O;return A.ordinalNumber(H,{unit:"year"})}return C.default.y(v,S)},Y:function(v,S,A,O){var H=(0,E.default)(v,O),V=H>0?H:1-H;if(S==="YY"){var Q=V%100;return(0,w.default)(Q,2)}return S==="Yo"?A.ordinalNumber(V,{unit:"year"}):(0,w.default)(V,S.length)},R:function(v,S){var A=(0,F.default)(v);return(0,w.default)(A,S.length)},u:function(v,S){var A=v.getUTCFullYear();return(0,w.default)(A,S.length)},Q:function(v,S,A){var O=Math.ceil((v.getUTCMonth()+1)/3);switch(S){case"Q":return String(O);case"QQ":return(0,w.default)(O,2);case"Qo":return A.ordinalNumber(O,{unit:"quarter"});case"QQQ":return A.quarter(O,{width:"abbreviated",context:"formatting"});case"QQQQQ":return A.quarter(O,{width:"narrow",context:"formatting"});case"QQQQ":default:return A.quarter(O,{width:"wide",context:"formatting"})}},q:function(v,S,A){var O=Math.ceil((v.getUTCMonth()+1)/3);switch(S){case"q":return String(O);case"qq":return(0,w.default)(O,2);case"qo":return A.ordinalNumber(O,{unit:"quarter"});case"qqq":return A.quarter(O,{width:"abbreviated",context:"standalone"});case"qqqqq":return A.quarter(O,{width:"narrow",context:"standalone"});case"qqqq":default:return A.quarter(O,{width:"wide",context:"standalone"})}},M:function(v,S,A){var O=v.getUTCMonth();switch(S){case"M":case"MM":return C.default.M(v,S);case"Mo":return A.ordinalNumber(O+1,{unit:"month"});case"MMM":return A.month(O,{width:"abbreviated",context:"formatting"});case"MMMMM":return A.month(O,{width:"narrow",context:"formatting"});case"MMMM":default:return A.month(O,{width:"wide",context:"formatting"})}},L:function(v,S,A){var O=v.getUTCMonth();switch(S){case"L":return String(O+1);case"LL":return(0,w.default)(O+1,2);case"Lo":return A.ordinalNumber(O+1,{unit:"month"});case"LLL":return A.month(O,{width:"abbreviated",context:"standalone"});case"LLLLL":return A.month(O,{width:"narrow",context:"standalone"});case"LLLL":default:return A.month(O,{width:"wide",context:"standalone"})}},w:function(v,S,A,O){var H=(0,T.default)(v,O);return S==="wo"?A.ordinalNumber(H,{unit:"week"}):(0,w.default)(H,S.length)},I:function(v,S,A){var O=(0,N.default)(v);return S==="Io"?A.ordinalNumber(O,{unit:"week"}):(0,w.default)(O,S.length)},d:function(v,S,A){return S==="do"?A.ordinalNumber(v.getUTCDate(),{unit:"date"}):C.default.d(v,S)},D:function(v,S,A){var O=(0,L.default)(v);return S==="Do"?A.ordinalNumber(O,{unit:"dayOfYear"}):(0,w.default)(O,S.length)},E:function(v,S,A){var O=v.getUTCDay();switch(S){case"E":case"EE":case"EEE":return A.day(O,{width:"abbreviated",context:"formatting"});case"EEEEE":return A.day(O,{width:"narrow",context:"formatting"});case"EEEEEE":return A.day(O,{width:"short",context:"formatting"});case"EEEE":default:return A.day(O,{width:"wide",context:"formatting"})}},e:function(v,S,A,O){var H=v.getUTCDay(),V=(H-O.weekStartsOn+8)%7||7;switch(S){case"e":return String(V);case"ee":return(0,w.default)(V,2);case"eo":return A.ordinalNumber(V,{unit:"day"});case"eee":return A.day(H,{width:"abbreviated",context:"formatting"});case"eeeee":return A.day(H,{width:"narrow",context:"formatting"});case"eeeeee":return A.day(H,{width:"short",context:"formatting"});case"eeee":default:return A.day(H,{width:"wide",context:"formatting"})}},c:function(v,S,A,O){var H=v.getUTCDay(),V=(H-O.weekStartsOn+8)%7||7;switch(S){case"c":return String(V);case"cc":return(0,w.default)(V,S.length);case"co":return A.ordinalNumber(V,{unit:"day"});case"ccc":return A.day(H,{width:"abbreviated",context:"standalone"});case"ccccc":return A.day(H,{width:"narrow",context:"standalone"});case"cccccc":return A.day(H,{width:"short",context:"standalone"});case"cccc":default:return A.day(H,{width:"wide",context:"standalone"})}},i:function(v,S,A){var O=v.getUTCDay(),H=O===0?7:O;switch(S){case"i":return String(H);case"ii":return(0,w.default)(H,S.length);case"io":return A.ordinalNumber(H,{unit:"day"});case"iii":return A.day(O,{width:"abbreviated",context:"formatting"});case"iiiii":return A.day(O,{width:"narrow",context:"formatting"});case"iiiiii":return A.day(O,{width:"short",context:"formatting"});case"iiii":default:return A.day(O,{width:"wide",context:"formatting"})}},a:function(v,S,A){var O=v.getUTCHours(),H=O/12>=1?"pm":"am";switch(S){case"a":case"aa":return A.dayPeriod(H,{width:"abbreviated",context:"formatting"});case"aaa":return A.dayPeriod(H,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return A.dayPeriod(H,{width:"narrow",context:"formatting"});case"aaaa":default:return A.dayPeriod(H,{width:"wide",context:"formatting"})}},b:function(v,S,A){var O=v.getUTCHours(),H;switch(O===12?H=h.noon:O===0?H=h.midnight:H=O/12>=1?"pm":"am",S){case"b":case"bb":return A.dayPeriod(H,{width:"abbreviated",context:"formatting"});case"bbb":return A.dayPeriod(H,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return A.dayPeriod(H,{width:"narrow",context:"formatting"});case"bbbb":default:return A.dayPeriod(H,{width:"wide",context:"formatting"})}},B:function(v,S,A){var O=v.getUTCHours(),H;switch(O>=17?H=h.evening:O>=12?H=h.afternoon:O>=4?H=h.morning:H=h.night,S){case"B":case"BB":case"BBB":return A.dayPeriod(H,{width:"abbreviated",context:"formatting"});case"BBBBB":return A.dayPeriod(H,{width:"narrow",context:"formatting"});case"BBBB":default:return A.dayPeriod(H,{width:"wide",context:"formatting"})}},h:function(v,S,A){if(S==="ho"){var O=v.getUTCHours()%12;return O===0&&(O=12),A.ordinalNumber(O,{unit:"hour"})}return C.default.h(v,S)},H:function(v,S,A){return S==="Ho"?A.ordinalNumber(v.getUTCHours(),{unit:"hour"}):C.default.H(v,S)},K:function(v,S,A){var O=v.getUTCHours()%12;return S==="Ko"?A.ordinalNumber(O,{unit:"hour"}):(0,w.default)(O,S.length)},k:function(v,S,A){var O=v.getUTCHours();return O===0&&(O=24),S==="ko"?A.ordinalNumber(O,{unit:"hour"}):(0,w.default)(O,S.length)},m:function(v,S,A){return S==="mo"?A.ordinalNumber(v.getUTCMinutes(),{unit:"minute"}):C.default.m(v,S)},s:function(v,S,A){return S==="so"?A.ordinalNumber(v.getUTCSeconds(),{unit:"second"}):C.default.s(v,S)},S:function(v,S){return C.default.S(v,S)},X:function(v,S,A,O){var H=O._originalDate||v,V=H.getTimezoneOffset();if(V===0)return"Z";switch(S){case"X":return p(V);case"XXXX":case"XX":return _(V);case"XXXXX":case"XXX":default:return _(V,":")}},x:function(v,S,A,O){var H=O._originalDate||v,V=H.getTimezoneOffset();switch(S){case"x":return p(V);case"xxxx":case"xx":return _(V);case"xxxxx":case"xxx":default:return _(V,":")}},O:function(v,S,A,O){var H=O._originalDate||v,V=H.getTimezoneOffset();switch(S){case"O":case"OO":case"OOO":return"GMT"+y(V,":");case"OOOO":default:return"GMT"+_(V,":")}},z:function(v,S,A,O){var H=O._originalDate||v,V=H.getTimezoneOffset();switch(S){case"z":case"zz":case"zzz":return"GMT"+y(V,":");case"zzzz":default:return"GMT"+_(V,":")}},t:function(v,S,A,O){var H=O._originalDate||v,V=Math.floor(H.getTime()/1e3);return(0,w.default)(V,S.length)},T:function(v,S,A,O){var H=O._originalDate||v,V=H.getTime();return(0,w.default)(V,S.length)}};function y(d,v){var S=d>0?"-":"+",A=Math.abs(d),O=Math.floor(A/60),H=A%60;if(H===0)return S+String(O);var V=v||"";return S+String(O)+V+(0,w.default)(H,2)}function p(d,v){if(d%60===0){var S=d>0?"-":"+";return S+(0,w.default)(Math.abs(d)/60,2)}return _(d,v)}function _(d,v){var S=v||"",A=d>0?"-":"+",O=Math.abs(d),H=(0,w.default)(Math.floor(O/60),2),V=(0,w.default)(O%60,2);return A+H+S+V}var f=m;M.default=f,R.exports=M.default},2699:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var L=N(x(7394));function N(E){return E&&E.__esModule?E:{default:E}}var F={y:function(w,C){var D=w.getUTCFullYear(),h=D>0?D:1-D;return(0,L.default)(C==="yy"?h%100:h,C.length)},M:function(w,C){var D=w.getUTCMonth();return C==="M"?String(D+1):(0,L.default)(D+1,2)},d:function(w,C){return(0,L.default)(w.getUTCDate(),C.length)},a:function(w,C){var D=w.getUTCHours()/12>=1?"pm":"am";switch(C){case"a":case"aa":return D.toUpperCase();case"aaa":return D;case"aaaaa":return D[0];case"aaaa":default:return D==="am"?"a.m.":"p.m."}},h:function(w,C){return(0,L.default)(w.getUTCHours()%12||12,C.length)},H:function(w,C){return(0,L.default)(w.getUTCHours(),C.length)},m:function(w,C){return(0,L.default)(w.getUTCMinutes(),C.length)},s:function(w,C){return(0,L.default)(w.getUTCSeconds(),C.length)},S:function(w,C){var D=C.length,h=w.getUTCMilliseconds(),m=Math.floor(h*Math.pow(10,D-3));return(0,L.default)(m,C.length)}},T=F;M.default=T,R.exports=M.default},5209:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var x=function(w,C){switch(w){case"P":return C.date({width:"short"});case"PP":return C.date({width:"medium"});case"PPP":return C.date({width:"long"});case"PPPP":default:return C.date({width:"full"})}},L=function(w,C){switch(w){case"p":return C.time({width:"short"});case"pp":return C.time({width:"medium"});case"ppp":return C.time({width:"long"});case"pppp":default:return C.time({width:"full"})}},N=function(w,C){var D=w.match(/(P+)(p+)?/)||[],h=D[1],m=D[2];if(!m)return x(w,C);var y;switch(h){case"P":y=C.dateTime({width:"short"});break;case"PP":y=C.dateTime({width:"medium"});break;case"PPP":y=C.dateTime({width:"long"});break;case"PPPP":default:y=C.dateTime({width:"full"});break}return y.replace("{{date}}",x(h,C)).replace("{{time}}",L(m,C))},F={p:L,P:N},T=F;M.default=T,R.exports=M.default},3561:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(L){var N=new Date(Date.UTC(L.getFullYear(),L.getMonth(),L.getDate(),L.getHours(),L.getMinutes(),L.getSeconds(),L.getMilliseconds()));return N.setUTCFullYear(L.getFullYear()),L.getTime()-N.getTime()}R.exports=M.default},1603:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=E;var L=F(x(1171)),N=F(x(8734));function F(w){return w&&w.__esModule?w:{default:w}}var T=864e5;function E(w){(0,N.default)(1,arguments);var C=(0,L.default)(w),D=C.getTime();C.setUTCMonth(0,1),C.setUTCHours(0,0,0,0);var h=C.getTime(),m=D-h;return Math.floor(m/T)+1}R.exports=M.default},1354:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=C;var L=E(x(1171)),N=E(x(79)),F=E(x(4275)),T=E(x(8734));function E(D){return D&&D.__esModule?D:{default:D}}var w=6048e5;function C(D){(0,T.default)(1,arguments);var h=(0,L.default)(D),m=(0,N.default)(h).getTime()-(0,F.default)(h).getTime();return Math.round(m/w)+1}R.exports=M.default},1370:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=E;var L=T(x(1171)),N=T(x(8734)),F=T(x(79));function T(w){return w&&w.__esModule?w:{default:w}}function E(w){(0,N.default)(1,arguments);var C=(0,L.default)(w),D=C.getUTCFullYear(),h=new Date(0);h.setUTCFullYear(D+1,0,4),h.setUTCHours(0,0,0,0);var m=(0,F.default)(h),y=new Date(0);y.setUTCFullYear(D,0,4),y.setUTCHours(0,0,0,0);var p=(0,F.default)(y);return C.getTime()>=m.getTime()?D+1:C.getTime()>=p.getTime()?D:D-1}R.exports=M.default},623:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=C;var L=E(x(1171)),N=E(x(9209)),F=E(x(4118)),T=E(x(8734));function E(D){return D&&D.__esModule?D:{default:D}}var w=6048e5;function C(D,h){(0,T.default)(1,arguments);var m=(0,L.default)(D),y=(0,N.default)(m,h).getTime()-(0,F.default)(m,h).getTime();return Math.round(y/w)+1}R.exports=M.default},6226:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=C;var L=w(x(1171)),N=w(x(8734)),F=w(x(9209)),T=w(x(2084)),E=x(8729);function w(D){return D&&D.__esModule?D:{default:D}}function C(D,h){var m,y,p,_,f,d,v,S;(0,N.default)(1,arguments);var A=(0,L.default)(D),O=A.getUTCFullYear(),H=(0,E.getDefaultOptions)(),V=(0,T.default)((m=(y=(p=(_=h==null?void 0:h.firstWeekContainsDate)!==null&&_!==void 0?_:h==null||(f=h.locale)===null||f===void 0||(d=f.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&p!==void 0?p:H.firstWeekContainsDate)!==null&&y!==void 0?y:(v=H.locale)===null||v===void 0||(S=v.options)===null||S===void 0?void 0:S.firstWeekContainsDate)!==null&&m!==void 0?m:1);if(!(V>=1&&V<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Q=new Date(0);Q.setUTCFullYear(O+1,0,V),Q.setUTCHours(0,0,0,0);var j=(0,F.default)(Q,h),z=new Date(0);z.setUTCFullYear(O,0,V),z.setUTCHours(0,0,0,0);var X=(0,F.default)(z,h);return A.getTime()>=j.getTime()?O+1:A.getTime()>=X.getTime()?O:O-1}R.exports=M.default},6736:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.isProtectedDayOfYearToken=N,M.isProtectedWeekYearToken=F,M.throwProtectedError=T;var x=["D","DD"],L=["YY","YYYY"];function N(E){return x.indexOf(E)!==-1}function F(E){return L.indexOf(E)!==-1}function T(E,w,C){if(E==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(w,"`) for formatting years to the input `").concat(C,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(E==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(w,"`) for formatting years to the input `").concat(C,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(E==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(w,"`) for formatting days of the month to the input `").concat(C,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(E==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(w,"`) for formatting days of the month to the input `").concat(C,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}},8734:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(L,N){if(N.length<L)throw new TypeError(L+" argument"+(L>1?"s":"")+" required, but only "+N.length+" present")}R.exports=M.default},79:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=T;var L=F(x(1171)),N=F(x(8734));function F(E){return E&&E.__esModule?E:{default:E}}function T(E){(0,N.default)(1,arguments);var w=1,C=(0,L.default)(E),D=C.getUTCDay(),h=(D<w?7:0)+D-w;return C.setUTCDate(C.getUTCDate()-h),C.setUTCHours(0,0,0,0),C}R.exports=M.default},4275:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=E;var L=T(x(1370)),N=T(x(79)),F=T(x(8734));function T(w){return w&&w.__esModule?w:{default:w}}function E(w){(0,F.default)(1,arguments);var C=(0,L.default)(w),D=new Date(0);D.setUTCFullYear(C,0,4),D.setUTCHours(0,0,0,0);var h=(0,N.default)(D);return h}R.exports=M.default},9209:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=w;var L=E(x(1171)),N=E(x(8734)),F=E(x(2084)),T=x(8729);function E(C){return C&&C.__esModule?C:{default:C}}function w(C,D){var h,m,y,p,_,f,d,v;(0,N.default)(1,arguments);var S=(0,T.getDefaultOptions)(),A=(0,F.default)((h=(m=(y=(p=D==null?void 0:D.weekStartsOn)!==null&&p!==void 0?p:D==null||(_=D.locale)===null||_===void 0||(f=_.options)===null||f===void 0?void 0:f.weekStartsOn)!==null&&y!==void 0?y:S.weekStartsOn)!==null&&m!==void 0?m:(d=S.locale)===null||d===void 0||(v=d.options)===null||v===void 0?void 0:v.weekStartsOn)!==null&&h!==void 0?h:0);if(!(A>=0&&A<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var O=(0,L.default)(C),H=O.getUTCDay(),V=(H<A?7:0)+H-A;return O.setUTCDate(O.getUTCDate()-V),O.setUTCHours(0,0,0,0),O}R.exports=M.default},4118:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=C;var L=w(x(6226)),N=w(x(8734)),F=w(x(9209)),T=w(x(2084)),E=x(8729);function w(D){return D&&D.__esModule?D:{default:D}}function C(D,h){var m,y,p,_,f,d,v,S;(0,N.default)(1,arguments);var A=(0,E.getDefaultOptions)(),O=(0,T.default)((m=(y=(p=(_=h==null?void 0:h.firstWeekContainsDate)!==null&&_!==void 0?_:h==null||(f=h.locale)===null||f===void 0||(d=f.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&p!==void 0?p:A.firstWeekContainsDate)!==null&&y!==void 0?y:(v=A.locale)===null||v===void 0||(S=v.options)===null||S===void 0?void 0:S.firstWeekContainsDate)!==null&&m!==void 0?m:1),H=(0,L.default)(D,h),V=new Date(0);V.setUTCFullYear(H,0,O),V.setUTCHours(0,0,0,0);var Q=(0,F.default)(V,h);return Q}R.exports=M.default},2084:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(L){if(L===null||L===!0||L===!1)return NaN;var N=Number(L);return isNaN(N)?N:N<0?Math.ceil(N):Math.floor(N)}R.exports=M.default},5065:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=E;var L=T(x(2084)),N=T(x(1171)),F=T(x(8734));function T(w){return w&&w.__esModule?w:{default:w}}function E(w,C){(0,F.default)(2,arguments);var D=(0,N.default)(w).getTime(),h=(0,L.default)(C);return new Date(D+h)}R.exports=M.default},5616:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=A;var L=p(x(9989)),N=p(x(3239)),F=p(x(1171)),T=p(x(7100)),E=p(x(5209)),w=p(x(3561)),C=x(6736),D=p(x(2084)),h=p(x(8734)),m=x(8729),y=p(x(7561));function p(H){return H&&H.__esModule?H:{default:H}}var _=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,f=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,d=/^'([^]*?)'?$/,v=/''/g,S=/[a-zA-Z]/;function A(H,V,Q){var j,z,X,J,se,ue,be,xe,pe,Oe,Pe,Te,Be,nt,Ct,yt,At,Et;(0,h.default)(2,arguments);var yn=String(V),Ve=(0,m.getDefaultOptions)(),Ae=(j=(z=Q==null?void 0:Q.locale)!==null&&z!==void 0?z:Ve.locale)!==null&&j!==void 0?j:y.default,rt=(0,D.default)((X=(J=(se=(ue=Q==null?void 0:Q.firstWeekContainsDate)!==null&&ue!==void 0?ue:Q==null||(be=Q.locale)===null||be===void 0||(xe=be.options)===null||xe===void 0?void 0:xe.firstWeekContainsDate)!==null&&se!==void 0?se:Ve.firstWeekContainsDate)!==null&&J!==void 0?J:(pe=Ve.locale)===null||pe===void 0||(Oe=pe.options)===null||Oe===void 0?void 0:Oe.firstWeekContainsDate)!==null&&X!==void 0?X:1);if(!(rt>=1&&rt<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Dt=(0,D.default)((Pe=(Te=(Be=(nt=Q==null?void 0:Q.weekStartsOn)!==null&&nt!==void 0?nt:Q==null||(Ct=Q.locale)===null||Ct===void 0||(yt=Ct.options)===null||yt===void 0?void 0:yt.weekStartsOn)!==null&&Be!==void 0?Be:Ve.weekStartsOn)!==null&&Te!==void 0?Te:(At=Ve.locale)===null||At===void 0||(Et=At.options)===null||Et===void 0?void 0:Et.weekStartsOn)!==null&&Pe!==void 0?Pe:0);if(!(Dt>=0&&Dt<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!Ae.localize)throw new RangeError("locale must contain localize property");if(!Ae.formatLong)throw new RangeError("locale must contain formatLong property");var st=(0,F.default)(H);if(!(0,L.default)(st))throw new RangeError("Invalid time value");var Sn=(0,w.default)(st),Lt=(0,N.default)(st,Sn),Mn={firstWeekContainsDate:rt,weekStartsOn:Dt,locale:Ae,_originalDate:st},ft=yn.match(f).map(function(ve){var Ye=ve[0];if(Ye==="p"||Ye==="P"){var it=E.default[Ye];return it(ve,Ae.formatLong)}return ve}).join("").match(_).map(function(ve){if(ve==="''")return"'";var Ye=ve[0];if(Ye==="'")return O(ve);var it=T.default[Ye];if(it)return!(Q!=null&&Q.useAdditionalWeekYearTokens)&&(0,C.isProtectedWeekYearToken)(ve)&&(0,C.throwProtectedError)(ve,V,String(H)),!(Q!=null&&Q.useAdditionalDayOfYearTokens)&&(0,C.isProtectedDayOfYearToken)(ve)&&(0,C.throwProtectedError)(ve,V,String(H)),it(Lt,ve,Ae.localize,Mn);if(Ye.match(S))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Ye+"`");return ve}).join("");return ft}function O(H){var V=H.match(d);return V?V[1].replace(v,"'"):H}R.exports=M.default},2382:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=T;var L=N(x(8734));function N(E){return E&&E.__esModule?E:{default:E}}function F(E){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?F=function(C){return typeof C}:F=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},F(E)}function T(E){return(0,L.default)(1,arguments),E instanceof Date||F(E)==="object"&&Object.prototype.toString.call(E)==="[object Date]"}R.exports=M.default},9989:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=E;var L=T(x(2382)),N=T(x(1171)),F=T(x(8734));function T(w){return w&&w.__esModule?w:{default:w}}function E(w){if((0,F.default)(1,arguments),!(0,L.default)(w)&&typeof w!="number")return!1;var C=(0,N.default)(w);return!isNaN(Number(C))}R.exports=M.default},289:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(L){return function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},F=N.width?String(N.width):L.defaultWidth,T=L.formats[F]||L.formats[L.defaultWidth];return T}}R.exports=M.default},6245:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(L){return function(N,F){var T=F!=null&&F.context?String(F.context):"standalone",E;if(T==="formatting"&&L.formattingValues){var w=L.defaultFormattingWidth||L.defaultWidth,C=F!=null&&F.width?String(F.width):w;E=L.formattingValues[C]||L.formattingValues[w]}else{var D=L.defaultWidth,h=F!=null&&F.width?String(F.width):L.defaultWidth;E=L.values[h]||L.values[D]}var m=L.argumentCallback?L.argumentCallback(N):N;return E[m]}}R.exports=M.default},3421:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(F){return function(T){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},w=E.width,C=w&&F.matchPatterns[w]||F.matchPatterns[F.defaultMatchWidth],D=T.match(C);if(!D)return null;var h=D[0],m=w&&F.parsePatterns[w]||F.parsePatterns[F.defaultParseWidth],y=Array.isArray(m)?N(m,function(f){return f.test(h)}):L(m,function(f){return f.test(h)}),p;p=F.valueCallback?F.valueCallback(y):y,p=E.valueCallback?E.valueCallback(p):p;var _=T.slice(h.length);return{value:p,rest:_}}}function L(F,T){for(var E in F)if(F.hasOwnProperty(E)&&T(F[E]))return E}function N(F,T){for(var E=0;E<F.length;E++)if(T(F[E]))return E}R.exports=M.default},8926:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(L){return function(N){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},T=N.match(L.matchPattern);if(!T)return null;var E=T[0],w=N.match(L.parsePattern);if(!w)return null;var C=L.valueCallback?L.valueCallback(w[0]):w[0];C=F.valueCallback?F.valueCallback(C):C;var D=N.slice(E.length);return{value:C,rest:D}}}R.exports=M.default},1924:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var x={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},L=function(T,E,w){var C,D=x[T];return typeof D=="string"?C=D:E===1?C=D.one:C=D.other.replace("{{count}}",E.toString()),w!=null&&w.addSuffix?w.comparison&&w.comparison>0?"in "+C:C+" ago":C},N=L;M.default=N,R.exports=M.default},5062:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var L=N(x(289));function N(D){return D&&D.__esModule?D:{default:D}}var F={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},T={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},E={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},w={date:(0,L.default)({formats:F,defaultWidth:"full"}),time:(0,L.default)({formats:T,defaultWidth:"full"}),dateTime:(0,L.default)({formats:E,defaultWidth:"full"})},C=w;M.default=C,R.exports=M.default},5102:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var x={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},L=function(T,E,w,C){return x[T]},N=L;M.default=N,R.exports=M.default},7839:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var L=N(x(6245));function N(p){return p&&p.__esModule?p:{default:p}}var F={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},T={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},E={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},w={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},C={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},D={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},h=function(_,f){var d=Number(_),v=d%100;if(v>20||v<10)switch(v%10){case 1:return d+"st";case 2:return d+"nd";case 3:return d+"rd"}return d+"th"},m={ordinalNumber:h,era:(0,L.default)({values:F,defaultWidth:"wide"}),quarter:(0,L.default)({values:T,defaultWidth:"wide",argumentCallback:function(_){return _-1}}),month:(0,L.default)({values:E,defaultWidth:"wide"}),day:(0,L.default)({values:w,defaultWidth:"wide"}),dayPeriod:(0,L.default)({values:C,defaultWidth:"wide",formattingValues:D,defaultFormattingWidth:"wide"})},y=m;M.default=y,R.exports=M.default},9796:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var L=F(x(3421)),N=F(x(8926));function F(A){return A&&A.__esModule?A:{default:A}}var T=/^(\d+)(th|st|nd|rd)?/i,E=/\d+/i,w={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},C={any:[/^b/i,/^(a|c)/i]},D={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},h={any:[/1/i,/2/i,/3/i,/4/i]},m={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},y={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},p={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},f={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},d={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},v={ordinalNumber:(0,N.default)({matchPattern:T,parsePattern:E,valueCallback:function(O){return parseInt(O,10)}}),era:(0,L.default)({matchPatterns:w,defaultMatchWidth:"wide",parsePatterns:C,defaultParseWidth:"any"}),quarter:(0,L.default)({matchPatterns:D,defaultMatchWidth:"wide",parsePatterns:h,defaultParseWidth:"any",valueCallback:function(O){return O+1}}),month:(0,L.default)({matchPatterns:m,defaultMatchWidth:"wide",parsePatterns:y,defaultParseWidth:"any"}),day:(0,L.default)({matchPatterns:p,defaultMatchWidth:"wide",parsePatterns:_,defaultParseWidth:"any"}),dayPeriod:(0,L.default)({matchPatterns:f,defaultMatchWidth:"any",parsePatterns:d,defaultParseWidth:"any"})},S=v;M.default=S,R.exports=M.default},2512:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var L=w(x(1924)),N=w(x(5062)),F=w(x(5102)),T=w(x(7839)),E=w(x(9796));function w(h){return h&&h.__esModule?h:{default:h}}var C={code:"en-US",formatDistance:L.default,formatLong:N.default,formatRelative:F.default,localize:T.default,match:E.default,options:{weekStartsOn:0,firstWeekContainsDate:1}},D=C;M.default=D,R.exports=M.default},3239:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=E;var L=T(x(5065)),N=T(x(8734)),F=T(x(2084));function T(w){return w&&w.__esModule?w:{default:w}}function E(w,C){(0,N.default)(2,arguments);var D=(0,F.default)(C);return(0,L.default)(w,-D)}R.exports=M.default},1171:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=T;var L=N(x(8734));function N(E){return E&&E.__esModule?E:{default:E}}function F(E){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?F=function(C){return typeof C}:F=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},F(E)}function T(E){(0,L.default)(1,arguments);var w=Object.prototype.toString.call(E);return E instanceof Date||F(E)==="object"&&w==="[object Date]"?new Date(E.getTime()):typeof E=="number"||w==="[object Number]"?new Date(E):((typeof E=="string"||w==="[object String]")&&typeof console!="undefined"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}R.exports=M.default},5171:R=>{R.exports=function(x){return!x||typeof x=="string"?!1:x instanceof Array||Array.isArray(x)||x.length>=0&&(x.splice instanceof Function||Object.getOwnPropertyDescriptor(x,x.length-1)&&x.constructor.name!=="String")}},6851:(R,M,x)=>{"use strict";var L=x(5171),N=Array.prototype.concat,F=Array.prototype.slice,T=R.exports=function(w){for(var C=[],D=0,h=w.length;D<h;D++){var m=w[D];L(m)?C=N.call(C,F.call(m)):C.push(m)}return C};T.wrap=function(E){return function(){return E(T(arguments))}}},5721:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(L,N,F,T,E,w,C){var D=new Date(0);return D.setUTCFullYear(L,N,F),D.setUTCHours(T,E,w,C),D}R.exports=M.default},5855:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(T,E,w){var C=F(T,w.timeZone,w.locale);return C.formatToParts?L(C,E):N(C,E)}function L(T,E){for(var w=T.formatToParts(E),C=w.length-1;C>=0;--C)if(w[C].type==="timeZoneName")return w[C].value}function N(T,E){var w=T.format(E).replace(/\u200E/g,""),C=/ [\w-+ ]+$/.exec(w);return C?C[0].substr(1):""}function F(T,E,w){if(w&&!w.code)throw new Error("date-fns-tz error: Please set a language code on the locale object imported from date-fns, e.g. `locale.code = 'en-US'`");return new Intl.DateTimeFormat(w?[w.code,"en-US"]:void 0,{timeZone:E,timeZoneName:T})}R.exports=M.default},2734:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=C;var L=F(x(2712)),N=F(x(5721));function F(f){return f&&f.__esModule?f:{default:f}}var T=36e5,E=6e4,w={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function C(f,d,v){var S,A;if(f===""||(S=w.timezoneZ.exec(f),S))return 0;var O;if(S=w.timezoneHH.exec(f),S)return O=parseInt(S[1],10),y(O)?-(O*T):NaN;if(S=w.timezoneHHMM.exec(f),S){O=parseInt(S[1],10);var H=parseInt(S[2],10);return y(O,H)?(A=Math.abs(O)*T+H*E,O>0?-A:A):NaN}if(_(f)){d=new Date(d||Date.now());var V=v?d:D(d),Q=h(V,f),j=v?Q:m(d,Q,f);return-j}return NaN}function D(f){return(0,N.default)(f.getFullYear(),f.getMonth(),f.getDate(),f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds())}function h(f,d){var v=(0,L.default)(f,d),S=(0,N.default)(v[0],v[1]-1,v[2],v[3]%24,v[4],v[5],0).getTime(),A=f.getTime(),O=A%1e3;return A-=O>=0?O:1e3+O,S-A}function m(f,d,v){var S=f.getTime(),A=S-d,O=h(new Date(A),v);if(d===O)return d;A-=O-d;var H=h(new Date(A),v);return O===H?O:Math.max(O,H)}function y(f,d){return-23<=f&&f<=23&&(d==null||0<=d&&d<=59)}var p={};function _(f){if(p[f])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:f}),p[f]=!0,!0}catch(d){return!1}}R.exports=M.default},7048:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var x=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,L=x;M.default=L,R.exports=M.default},2712:(R,M)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=x;function x(w,C){var D=E(C);return D.formatToParts?N(D,w):F(D,w)}var L={year:0,month:1,day:2,hour:3,minute:4,second:5};function N(w,C){try{for(var D=w.formatToParts(C),h=[],m=0;m<D.length;m++){var y=L[D[m].type];y>=0&&(h[y]=parseInt(D[m].value,10))}return h}catch(p){if(p instanceof RangeError)return[NaN];throw p}}function F(w,C){var D=w.format(C).replace(/\u200E/g,""),h=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(D);return[h[3],h[1],h[2],h[4],h[5],h[6]]}var T={};function E(w){if(!T[w]){var C=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),D=C==="06/25/2014, 00:00:00"||C==="\u200E06\u200E/\u200E25\u200E/\u200E2014\u200E \u200E00\u200E:\u200E00\u200E:\u200E00";T[w]=D?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:w,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:w,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return T[w]}R.exports=M.default},3826:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var L=F(x(5855)),N=F(x(2734));function F(p){return p&&p.__esModule?p:{default:p}}var T=60*1e3,E={X:function(p,_,f,d){var v=w(d.timeZone,d._originalDate||p);if(v===0)return"Z";switch(_){case"X":return h(v);case"XXXX":case"XX":return D(v);case"XXXXX":case"XXX":default:return D(v,":")}},x:function(p,_,f,d){var v=w(d.timeZone,d._originalDate||p);switch(_){case"x":return h(v);case"xxxx":case"xx":return D(v);case"xxxxx":case"xxx":default:return D(v,":")}},O:function(p,_,f,d){var v=w(d.timeZone,d._originalDate||p);switch(_){case"O":case"OO":case"OOO":return"GMT"+m(v,":");case"OOOO":default:return"GMT"+D(v,":")}},z:function(p,_,f,d){var v=d._originalDate||p;switch(_){case"z":case"zz":case"zzz":return(0,L.default)("short",v,d);case"zzzz":default:return(0,L.default)("long",v,d)}}};function w(p,_){var f=p?(0,N.default)(p,_,!0)/T:_.getTimezoneOffset();if(Number.isNaN(f))throw new RangeError("Invalid time zone specified: "+p);return f}function C(p,_){for(var f=p<0?"-":"",d=Math.abs(p).toString();d.length<_;)d="0"+d;return f+d}function D(p,_){var f=_||"",d=p>0?"-":"+",v=Math.abs(p),S=C(Math.floor(v/60),2),A=C(Math.floor(v%60),2);return d+S+f+A}function h(p,_){if(p%60===0){var f=p>0?"-":"+";return f+C(Math.abs(p)/60,2)}return D(p,_)}function m(p,_){var f=p>0?"-":"+",d=Math.abs(p),v=Math.floor(d/60),S=d%60;if(S===0)return f+String(v);var A=_||"";return f+String(v)+A+C(S,2)}var y=E;M.default=y,R.exports=M.default},6558:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=w;var L=T(x(5616)),N=T(x(3826)),F=T(x(1476));function T(C){return C&&C.__esModule?C:{default:C}}var E=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function w(C,D,h){var m=String(D),y=h||{},p=m.match(E);if(p){var _=(0,F.default)(C,y);m=p.reduce(function(f,d){if(d[0]==="'")return f;var v=f.indexOf(d),S=f[v-1]==="'",A=f.replace(d,"'"+N.default[d[0]](_,d,null,y)+"'");return S?A.substring(0,v-1)+A.substring(v+1):A},m)}return(0,L.default)(C,m,y)}R.exports=M.default},6645:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=E;var L=T(x(6420)),N=T(x(6558)),F=T(x(1132));function T(w){return w&&w.__esModule?w:{default:w}}function E(w,C,D,h){var m=(0,L.default)(h);return m.timeZone=C,(0,N.default)((0,F.default)(w,C),D,m)}R.exports=M.default},4992:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=F;var L=N(x(2734));function N(T){return T&&T.__esModule?T:{default:T}}function F(T,E){return-(0,L.default)(T,E)}R.exports=M.default},722:(R,M,x)=>{"use strict";R.exports={format:x(6558),formatInTimeZone:x(6645),getTimezoneOffset:x(4992),toDate:x(1476),utcToZonedTime:x(1132),zonedTimeToUtc:x(8516)}},1476:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=m;var L=E(x(2084)),N=E(x(3561)),F=E(x(2734)),T=E(x(7048));function E(j){return j&&j.__esModule?j:{default:j}}var w=36e5,C=6e4,D=2,h={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:T.default};function m(j,z){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(j===null)return new Date(NaN);var X=z||{},J=X.additionalDigits==null?D:(0,L.default)(X.additionalDigits);if(J!==2&&J!==1&&J!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(j instanceof Date||typeof j=="object"&&Object.prototype.toString.call(j)==="[object Date]")return new Date(j.getTime());if(typeof j=="number"||Object.prototype.toString.call(j)==="[object Number]")return new Date(j);if(!(typeof j=="string"||Object.prototype.toString.call(j)==="[object String]"))return new Date(NaN);var se=y(j),ue=p(se.date,J),be=ue.year,xe=ue.restDateString,pe=_(xe,be);if(isNaN(pe))return new Date(NaN);if(pe){var Oe=pe.getTime(),Pe=0,Te;if(se.time&&(Pe=f(se.time),isNaN(Pe)))return new Date(NaN);if(se.timeZone||X.timeZone){if(Te=(0,F.default)(se.timeZone||X.timeZone,new Date(Oe+Pe)),isNaN(Te))return new Date(NaN)}else Te=(0,N.default)(new Date(Oe+Pe)),Te=(0,N.default)(new Date(Oe+Pe+Te));return new Date(Oe+Pe+Te)}else return new Date(NaN)}function y(j){var z={},X=h.dateTimePattern.exec(j),J;if(X?(z.date=X[1],J=X[3]):(X=h.datePattern.exec(j),X?(z.date=X[1],J=X[2]):(z.date=null,J=j)),J){var se=h.timeZone.exec(J);se?(z.time=J.replace(se[1],""),z.timeZone=se[1].trim()):z.time=J}return z}function p(j,z){var X=h.YYY[z],J=h.YYYYY[z],se;if(se=h.YYYY.exec(j)||J.exec(j),se){var ue=se[1];return{year:parseInt(ue,10),restDateString:j.slice(ue.length)}}if(se=h.YY.exec(j)||X.exec(j),se){var be=se[1];return{year:parseInt(be,10)*100,restDateString:j.slice(be.length)}}return{year:null}}function _(j,z){if(z===null)return null;var X,J,se,ue;if(j.length===0)return J=new Date(0),J.setUTCFullYear(z),J;if(X=h.MM.exec(j),X)return J=new Date(0),se=parseInt(X[1],10)-1,O(z,se)?(J.setUTCFullYear(z,se),J):new Date(NaN);if(X=h.DDD.exec(j),X){J=new Date(0);var be=parseInt(X[1],10);return H(z,be)?(J.setUTCFullYear(z,0,be),J):new Date(NaN)}if(X=h.MMDD.exec(j),X){J=new Date(0),se=parseInt(X[1],10)-1;var xe=parseInt(X[2],10);return O(z,se,xe)?(J.setUTCFullYear(z,se,xe),J):new Date(NaN)}if(X=h.Www.exec(j),X)return ue=parseInt(X[1],10)-1,V(z,ue)?d(z,ue):new Date(NaN);if(X=h.WwwD.exec(j),X){ue=parseInt(X[1],10)-1;var pe=parseInt(X[2],10)-1;return V(z,ue,pe)?d(z,ue,pe):new Date(NaN)}return null}function f(j){var z,X,J;if(z=h.HH.exec(j),z)return X=parseFloat(z[1].replace(",",".")),Q(X)?X%24*w:NaN;if(z=h.HHMM.exec(j),z)return X=parseInt(z[1],10),J=parseFloat(z[2].replace(",",".")),Q(X,J)?X%24*w+J*C:NaN;if(z=h.HHMMSS.exec(j),z){X=parseInt(z[1],10),J=parseInt(z[2],10);var se=parseFloat(z[3].replace(",","."));return Q(X,J,se)?X%24*w+J*C+se*1e3:NaN}return null}function d(j,z,X){z=z||0,X=X||0;var J=new Date(0);J.setUTCFullYear(j,0,4);var se=J.getUTCDay()||7,ue=z*7+X+1-se;return J.setUTCDate(J.getUTCDate()+ue),J}var v=[31,28,31,30,31,30,31,31,30,31,30,31],S=[31,29,31,30,31,30,31,31,30,31,30,31];function A(j){return j%400===0||j%4===0&&j%100!==0}function O(j,z,X){if(z<0||z>11)return!1;if(X!=null){if(X<1)return!1;var J=A(j);if(J&&X>S[z]||!J&&X>v[z])return!1}return!0}function H(j,z){if(z<1)return!1;var X=A(j);return!(X&&z>366||!X&&z>365)}function V(j,z,X){return!(z<0||z>52||X!=null&&(X<0||X>6))}function Q(j,z,X){return!(j!=null&&(j<0||j>=25)||z!=null&&(z<0||z>=60)||X!=null&&(X<0||X>=60))}R.exports=M.default},1132:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=T;var L=F(x(2734)),N=F(x(1476));function F(E){return E&&E.__esModule?E:{default:E}}function T(E,w,C){var D=(0,N.default)(E,C),h=(0,L.default)(w,D,!0),m=new Date(D.getTime()-h),y=new Date(0);return y.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),y.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),y}R.exports=M.default},8516:(R,M,x)=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=C;var L=w(x(6420)),N=w(x(1476)),F=w(x(7048)),T=w(x(2734)),E=w(x(5721));function w(D){return D&&D.__esModule?D:{default:D}}function C(D,h,m){if(typeof D=="string"&&!D.match(F.default)){var y=(0,L.default)(m);return y.timeZone=h,(0,N.default)(D,y)}var p=(0,N.default)(D,m),_=(0,E.default)(p.getFullYear(),p.getMonth(),p.getDate(),p.getHours(),p.getMinutes(),p.getSeconds(),p.getMilliseconds()).getTime(),f=(0,T.default)(h,new Date(_));return new Date(_+f)}R.exports=M.default}},Sr={};function _e(R){var M=Sr[R];if(M!==void 0)return M.exports;var x=Sr[R]={exports:{}};return Ya[R](x,x.exports,_e),x.exports}_e.n=R=>{var M=R&&R.__esModule?()=>R.default:()=>R;return _e.d(M,{a:M}),M},_e.d=(R,M)=>{for(var x in M)_e.o(M,x)&&!_e.o(R,x)&&Object.defineProperty(R,x,{enumerable:!0,get:M[x]})},_e.o=(R,M)=>Object.prototype.hasOwnProperty.call(R,M),_e.r=R=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(R,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(R,"__esModule",{value:!0})};var Cn={};(()=>{"use strict";_e.r(Cn),_e.d(Cn,{ChartBootstrap:()=>kt,createChart:()=>Ra});function R(n){return typeof n=="function"}function M(n){return R(n==null?void 0:n.lift)}function x(n){return function(e){if(M(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var L=function(n,e){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},L(n,e)};function N(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");L(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var F=function(){return F=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},F.apply(this,arguments)};function T(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function E(n,e,t,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,r);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(i=(s<3?a(i):s>3?a(e,t,i):a(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function w(n,e){return function(t,r){e(t,r,n)}}function C(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function D(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(r.next(u))}catch(g){a(g)}}function l(u){try{c(r.throw(u))}catch(g){a(g)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})}function h(n,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(t=0)),t;)try{if(r=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,s=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],s=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var m=Object.create?function(n,e,t,r){r===void 0&&(r=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,s)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function y(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&m(e,n,t)}function p(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function _(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return i}function f(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(_(arguments[e]));return n}function d(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),s=0,e=0;e<t;e++)for(var i=arguments[e],a=0,o=i.length;a<o;a++,s++)r[s]=i[a];return r}function v(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}function S(n){return this instanceof S?(this.v=n,this):new S(n)}function A(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s={},a("next"),a("throw"),a("return"),s[Symbol.asyncIterator]=function(){return this},s;function a(b){r[b]&&(s[b]=function(P){return new Promise(function(I,Y){i.push([b,P,I,Y])>1||o(b,P)})})}function o(b,P){try{l(r[b](P))}catch(I){g(i[0][3],I)}}function l(b){b.value instanceof S?Promise.resolve(b.value.v).then(c,u):g(i[0][2],b)}function c(b){o("next",b)}function u(b){o("throw",b)}function g(b,P){b(P),i.shift(),i.length&&o(i[0][0],i[0][1])}}function O(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=n[s]?function(a){return(t=!t)?{value:S(n[s](a)),done:s==="return"}:i?i(a):a}:i}}function H(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof p=="function"?p(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(a){return new Promise(function(o,l){a=n[i](a),s(o,l,a.done,a.value)})}}function s(i,a,o,l){Promise.resolve(l).then(function(c){i({value:c,done:o})},a)}}function V(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var Q=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e};function j(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&m(e,n,t);return Q(e,n),e}function z(n){return n&&n.__esModule?n:{default:n}}function X(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function J(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t}function se(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function ue(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var be=ue(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function xe(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var pe=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,s,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=p(a),l=o.next();!l.done;l=o.next()){var c=l.value;c.remove(this)}}catch(Y){e={error:Y}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var u=this.initialTeardown;if(R(u))try{u()}catch(Y){i=Y instanceof be?Y.errors:[Y]}var g=this._finalizers;if(g){this._finalizers=null;try{for(var b=p(g),P=b.next();!P.done;P=b.next()){var I=P.value;try{Te(I)}catch(Y){i=i!=null?i:[],Y instanceof be?i=v(v([],_(i)),_(Y.errors)):i.push(Y)}}}catch(Y){r={error:Y}}finally{try{P&&!P.done&&(s=b.return)&&s.call(b)}finally{if(r)throw r.error}}}if(i)throw new be(i)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Te(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&xe(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&xe(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),Oe=pe.EMPTY;function Pe(n){return n instanceof pe||n&&"closed"in n&&R(n.remove)&&R(n.add)&&R(n.unsubscribe)}function Te(n){R(n)?n():n.unsubscribe()}var Be={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},nt={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var s=nt.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,v([n,e],_(t))):setTimeout.apply(void 0,v([n,e],_(t)))},clearTimeout:function(n){var e=nt.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function Ct(n){nt.setTimeout(function(){var e=Be.onUnhandledError;if(e)e(n);else throw n})}function yt(){}var At=function(){return Ve("C",void 0,void 0)}();function Et(n){return Ve("E",void 0,n)}function yn(n){return Ve("N",n,void 0)}function Ve(n,e,t){return{kind:n,value:e,error:t}}var Ae=null;function rt(n){if(Be.useDeprecatedSynchronousErrorHandling){var e=!Ae;if(e&&(Ae={errorThrown:!1,error:null}),n(),e){var t=Ae,r=t.errorThrown,s=t.error;if(Ae=null,r)throw s}}else n()}function Dt(n){Be.useDeprecatedSynchronousErrorHandling&&Ae&&(Ae.errorThrown=!0,Ae.error=n)}var st=function(n){N(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,Pe(t)&&t.add(r)):r.destination=Ha,r}return e.create=function(t,r,s){return new ft(t,r,s)},e.prototype.next=function(t){this.isStopped?it(yn(t),this):this._next(t)},e.prototype.error=function(t){this.isStopped?it(Et(t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?it(At,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(pe),Sn=Function.prototype.bind;function Lt(n,e){return Sn.call(n,e)}var Mn=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){ve(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){ve(r)}else ve(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){ve(t)}},n}(),ft=function(n){N(e,n);function e(t,r,s){var i=n.call(this)||this,a;if(R(t)||!t)a={next:t!=null?t:void 0,error:r!=null?r:void 0,complete:s!=null?s:void 0};else{var o;i&&Be.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=function(){return i.unsubscribe()},a={next:t.next&&Lt(t.next,o),error:t.error&&Lt(t.error,o),complete:t.complete&&Lt(t.complete,o)}):a=t}return i.destination=new Mn(a),i}return e}(st);function ve(n){Be.useDeprecatedSynchronousErrorHandling?Dt(n):Ct(n)}function Ye(n){throw n}function it(n,e){var t=Be.onStoppedNotification;t&&nt.setTimeout(function(){return t(n,e)})}var Ha={closed:!0,next:yt,error:Ye,complete:yt};function Re(n,e,t,r,s){return new ka(n,e,t,r,s)}var ka=function(n){N(e,n);function e(t,r,s,i,a,o){var l=n.call(this,t)||this;return l.onFinalize=a,l.shouldUnsubscribe=o,l._next=r?function(c){try{r(c)}catch(u){t.error(u)}}:n.prototype._next,l._error=i?function(c){try{i(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=s?function(){try{s()}catch(c){t.error(c)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(st);function Ce(n,e){return x(function(t,r){var s=0;t.subscribe(Re(r,function(i){r.next(n.call(e,i,s++))}))})}var Mr=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function _r(n){return R(n==null?void 0:n.then)}var _n=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function St(n){return n}function lv(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return xr(n)}function xr(n){return n.length===0?St:n.length===1?n[0]:function(t){return n.reduce(function(r,s){return s(r)},t)}}var ye=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var s=this,i=za(e)?e:new ft(e,t,r);return rt(function(){var a=s,o=a.operator,l=a.source;i.add(o?o.call(i,l):l?s._subscribe(i):s._trySubscribe(i))}),i},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=Pr(t),new t(function(s,i){var a=new ft({next:function(o){try{e(o)}catch(l){i(l),a.unsubscribe()}},error:i,complete:s});r.subscribe(a)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[_n]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return xr(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=Pr(e),new e(function(r,s){var i;t.subscribe(function(a){return i=a},function(a){return s(a)},function(){return r(i)})})},n.create=function(e){return new n(e)},n}();function Pr(n){var e;return(e=n!=null?n:Be.Promise)!==null&&e!==void 0?e:Promise}function Ua(n){return n&&R(n.next)&&R(n.error)&&R(n.complete)}function za(n){return n&&n instanceof st||Ua(n)&&Pe(n)}function Tr(n){return R(n[_n])}function Ar(n){return Symbol.asyncIterator&&R(n==null?void 0:n[Symbol.asyncIterator])}function Er(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Wa(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Dr=Wa();function Lr(n){return R(n==null?void 0:n[Dr])}function Ir(n){return A(this,arguments,function(){var t,r,s,i;return h(this,function(a){switch(a.label){case 0:t=n.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,S(t.read())];case 3:return r=a.sent(),s=r.value,i=r.done,i?[4,S(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,S(s)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Or(n){return R(n==null?void 0:n.getReader)}function je(n){if(n instanceof ye)return n;if(n!=null){if(Tr(n))return Xa(n);if(Mr(n))return Va(n);if(_r(n))return ja(n);if(Ar(n))return Br(n);if(Lr(n))return Ga(n);if(Or(n))return Za(n)}throw Er(n)}function Xa(n){return new ye(function(e){var t=n[_n]();if(R(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Va(n){return new ye(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function ja(n){return new ye(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,Ct)})}function Ga(n){return new ye(function(e){var t,r;try{for(var s=p(n),i=s.next();!i.done;i=s.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(o){t={error:o}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}e.complete()})}function Br(n){return new ye(function(e){$a(n,e).catch(function(t){return e.error(t)})})}function Za(n){return Br(Ir(n))}function $a(n,e){var t,r,s,i;return D(this,void 0,void 0,function(){var a,o;return h(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=H(n),l.label=1;case 1:return[4,t.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),s={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(i=t.return)?[4,i.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Ge(n,e,t,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var i=e.schedule(function(){t(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function Ka(n,e,t,r,s,i,a,o){var l=[],c=0,u=0,g=!1,b=function(){g&&!l.length&&!c&&e.complete()},P=function(Y){return c<r?I(Y):l.push(Y)},I=function(Y){i&&e.next(Y),c++;var k=!1;je(t(Y,u++)).subscribe(Re(e,function(U){s==null||s(U),i?P(U):e.next(U)},function(){k=!0},void 0,function(){if(k)try{c--;for(var U=function(){var W=l.shift();a?Ge(e,a,function(){return I(W)}):I(W)};l.length&&c<r;)U();b()}catch(W){e.error(W)}}))};return n.subscribe(Re(e,P,function(){g=!0,b()})),function(){o==null||o()}}function Rr(n,e,t){return t===void 0&&(t=1/0),R(e)?Rr(function(r,s){return Ce(function(i,a){return e(r,i,s,a)})(je(n(r,s)))},t):(typeof e=="number"&&(t=e),x(function(r,s){return Ka(r,s,n,t)}))}function Fr(n){return n===void 0&&(n=1/0),Rr(St,n)}var Nr=new ye(function(n){return n.complete()});function cv(n){return n?qa(n):Nr}function qa(n){return new Observable(function(e){return n.schedule(function(){return e.complete()})})}function Yr(n){return n&&R(n.schedule)}function xn(n){return n[n.length-1]}function Ja(n){return R(xn(n))?n.pop():void 0}function zt(n){return Yr(xn(n))?n.pop():void 0}function Qa(n,e){return typeof xn(n)=="number"?n.pop():e}function Hr(n,e){return e===void 0&&(e=0),x(function(t,r){t.subscribe(Re(r,function(s){return Ge(r,n,function(){return r.next(s)},e)},function(){return Ge(r,n,function(){return r.complete()},e)},function(s){return Ge(r,n,function(){return r.error(s)},e)}))})}function kr(n,e){return e===void 0&&(e=0),x(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function eo(n,e){return je(n).pipe(kr(e),Hr(e))}function to(n,e){return je(n).pipe(kr(e),Hr(e))}function no(n,e){return new ye(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function ro(n,e){return new ye(function(t){var r;return Ge(t,e,function(){r=n[Dr](),Ge(t,e,function(){var s,i,a;try{s=r.next(),i=s.value,a=s.done}catch(o){t.error(o);return}a?t.complete():t.next(i)},0,!0)}),function(){return R(r==null?void 0:r.return)&&r.return()}})}function Ur(n,e){if(!n)throw new Error("Iterable cannot be null");return new ye(function(t){Ge(t,e,function(){var r=n[Symbol.asyncIterator]();Ge(t,e,function(){r.next().then(function(s){s.done?t.complete():t.next(s.value)})},0,!0)})})}function so(n,e){return Ur(Ir(n),e)}function io(n,e){if(n!=null){if(Tr(n))return eo(n,e);if(Mr(n))return no(n,e);if(_r(n))return to(n,e);if(Ar(n))return Ur(n,e);if(Lr(n))return ro(n,e);if(Or(n))return so(n,e)}throw Er(n)}function Wt(n,e){return e?io(n,e):je(n)}function Ee(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=zt(n),r=Qa(n,1/0),s=n;return s.length?s.length===1?je(s[0]):Fr(r)(Wt(s,t)):Nr}const ao=(n,e,t=Wr,r=!0)=>{const s=n.filter(a=>e.filter(o=>t(a,o)).length!==0),i=[];return r?s.reduce((a,o)=>(a.filter(l=>t(o,l)).length===0&&a.push(o),a),i):s},zr=(n,e)=>{const t=e.slice().filter(r=>n.find(s=>s===r));return n.map(r=>{var s;return e.indexOf(r)>=0&&(s=t.shift())!=null?s:r})},Wr=(n,e)=>n===e,hv=(n,e,t)=>n.filter(r=>e.filter(s=>t(r,s)).length===0);function uv(n,e,t){const r=n.slice(),s=r[e];return r.splice(e,1),r.splice(t,0,s),r}function Pn(n,e,t){const r=n[e];return n.splice(e,1),n.splice(t,0,r),n}function dv(n,e,t){const r=n.slice(),s=r.findIndex(e);return s!==-1&&(r.splice(s,1),r.splice(s,0,t)),r}const fv=n=>{const e={};return n.filter(t=>e[t]?!1:e[t]=!0)},vv=(n,e)=>n.reduce((t,r)=>((t[r[e]]=t[r[e]]||[]).push(r),t),{}),gv=(n,e)=>[].concat(...n.map(t=>[t,e])).slice(0,-1),pv=n=>Array.isArray(n[0]),Xr=n=>Array.isArray(n[0])?n:[n],oo=(n,e,t)=>{const r=[];let s=0;for(const i of n){const a=Math.max(e-s,0),o=Math.max(t-s,-1),l=i.slice(a,o+1);l.length>0&&r.push(l),s+=i.length}return r},Ze={EVENT_DRAW:"draw",EVENT_CROSS:"cross",EVENT_HOVER:"event_hover",EVENT_CLOSE_HOVER:"closeHover",EVENT_RESIZED:"resized_local",EVENT_CHART_DOUBLE_CLICK:"chart_double_click",EVENT_USER_MOVE:"user_move"},Xt="resized_local",It="draw",mv="draw_last_candle",lo="cross",Tn="event_hover",An="closeHover";let En=!1,co=0;const Vt=new Map,Dn=new Map,Vr=()=>{En||(En=!0,co=requestAnimationFrame(()=>{Dn.forEach((n,e)=>{n(),Dn.delete(e)}),Vt.forEach((n,e)=>{n(),Vt.delete(e)}),En=!1}))},jr=(n,e)=>{Vt.set(n,e),Vr()},bv=n=>{Vt.delete(n)},Ln=(n,e)=>{Dn.set(n,e),Vr()};function wv(n){return n&&{}.toString.call(n)==="[object Function]"}const Cv=n=>(n.forEach(e=>{if(!e.call)throw"Non function in clearer!"}),function(){n.forEach(uo),n.length=0,n=void 0});function ho(n){return function(){n.forEach(t=>typeof t=="function"&&t()),n.length=0}}function uo(n){return n.call(this)}const we=n=>~~n,fo=n=>~~(n+1),Mt=n=>~~(n+.5),vo=(n,e)=>n>>e;function go(n,e,t,r=()=>0){const s=(a,o)=>{let l=0,c=a.length-1;for(;c>=l;){const u=Math.ceil((l+c)/2);r(a[u])<=o?l=u+1:c=u-1}return c},i=(a,o)=>{let l=0,c=a.length-1;for(;c>=l;){const u=Math.ceil((l+c)/2);r(a[u])>=o?c=u-1:l=u+1}return l};return n.slice(i(n,e),s(n,t)+1)}function yv(n,e,t){let r;const s=$e();function i(){const a=r;r=void 0,a&&e(a)}return function(a){const o=r;r=a,n&&a.preventDefault(),!o&&!(typeof t=="function"&&t())&&animationFrameThrottled(s,i)}}function Se(n,e,t,r){return n.addEventListener(t,e,r),function(){n.removeEventListener(t,e,r)}}function Sv(n){if(n&&n.parentNode)return n.parentNode.removeChild(n)}function po(n){function e(t,r){const s=n(r);return s==null||!isFinite(s)?t:[Math.max(t[0],s),Math.min(t[1],s)]}return function(t){const r=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];return t?t.reduce(e,r):r}}function Mv(n,e){return n[0]=Math.max(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n}function _v(n,e){return n.concat(e)}function xv(n,e){for(const t in e)n[t]=e[t];return n}function Pv(n,e){const t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0]||n,r=e.getBoundingClientRect(),s=document.body.scrollLeft||document.documentElement.scrollLeft,i=document.body.scrollTop||document.documentElement.scrollTop,a=t.pageX-r.left-s,o=t.pageY-r.top-i;return[a,o,r]}function mo(n){let e=n;for(;e;){if(e.nodeType===1&&e.hasAttribute("data-chart-container"))return e;if(e.parentElement!==null)e=e.parentElement;else break}return e}function Tv(){return document.querySelector('div[data-element="chart-resizer"]')}function Av(n){if(n)return n.getElementsByClassName("chart--axisWrapper-y")[0]}function Ev(n,e,t){let r=n[t];return{clear:e.onPrior(events.EVENT_RESIZED,function(){r=n[t]}),valueOf(){return r}}}function Dv(n){return function(){return setTimeout(n,0)}}function Lv(n,e){for(const t in e)Object.defineProperty(n,t,{get:e[t]});return n}function Gr(n){if(typeof window!="undefined"){if(!window.jasmine)return;window.testEnv||(window.testEnv={}),window.testEnv[n.name]=n}}function bo(n,e){n.classList?n.classList.add(e):n.className.indexOf(e)===-1&&(n.className+=" "+e)}function wo(n,e){n.classList?n.classList.remove(e):n.className=n.className.replace(e,"")}function Iv(n,e,t){(t?bo:wo)(n,e)}const Co=/^(#)([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,yo=/^\s*(rgba?)\s*[(]\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*[\d.]+\s*)?[)]\s*$/i;function So(n){const e=Co.exec(n)||yo.exec(n);let t=[];return e&&(t=e.slice(2,5),e[1]==="#")?t.map(function(r){return parseInt(r,16)}):t}const Zr={};function Mo(n,e){let t=Zr[n+e];if(!t){const r=So(n);t=r&&"rgba("+r.join(",")+","+e+")",Zr[n+e]=t}return t}function Ov(n,e){e=e||{};const t=e.max||10,r=e.size||25,s=e.dim||"height";return{valueOf(){return Math.min(t,Math.max(1,Math.ceil(n[s]/r)))}}}function Bv(n,e,t,r){n=n||localStorage,n.setItem(e+"/"+t,JSON.stringify(r))}typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(e){"use strict";if(e===null)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let r=1;r<arguments.length;r++){const s=arguments[r];if(s!=null)for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}return t},writable:!0,configurable:!0});function Rv(n,e,t){e.forEach(function(r){if(r[t]){let s;n.find((i,a)=>i[t]&&i[t]===r[t]?(s=a,!0):!1),s!==void 0&&n.splice(s,1)}})}function $e(){const n=()=>Math.random().toString(16).slice(-4);return`${n()+n()}-${n()}-${n()}-${n()}-${n()+n()+n()}`}const _o=(n,e,t)=>{const r=n/e;return r>=t||r<=1/t},xo=(n,e)=>{let t=0;return(...r)=>{clearTimeout(t),t=+setTimeout(()=>n(...r),e)}},jt="HIT_TEST_";var te=(n=>(n.MAIN_BACKGROUND="MAIN_BACKGROUND",n.MAIN_CLEAR="MAIN_CLEAR",n.HIT_TEST_CLEAR="HIT_TEST_CLEAR",n.YAXIS_CLEAR="YAXIS_CLEAR",n.SERIES_CLEAR="SERIES_CLEAR",n.OVER_SERIES_CLEAR="OVER_SERIES_CLEAR",n.HIT_TEST_DRAWINGS="HIT_TEST_DRAWINGS",n.GRID="GRID",n.VOLUMES="VOLUMES",n.UNDERLAY_VOLUMES_AREA="UNDERLAY_VOLUMES_AREA",n.X_AXIS="X_AXIS",n.Y_AXIS="Y_AXIS",n.HIGH_LOW="HIGH_LOW",n.DRAWINGS="DRAWINGS",n.DATA_SERIES="DATA_SERIES",n.N_MAP_CHART="N_MAP_CHART",n.PL_CHART="PL_CHART",n.WATERMARK="WATERMARK",n.EMPTY_CHART="EMPTY_CHART",n.OFFLINE_CHART="OFFLINE_CHART",n.LABELS="LABELS",n.EVENTS="EVENTS",n.HIT_TEST_EVENTS="HIT_TEST_EVENTS",n.PL_ZERO_LINE="ZERO_LINE",n.PL_ZERO_LINE_BACKGROUND="PL_ZERO_LINE_BACKGROUND",n.CROSS_TOOL="CROSS_TOOL",n))(te||{});class Po{constructor(e,t){this.chartResizeHandler=t,this.drawingOrder=[],this.drawersMap={},this.canvasIdsList=[],this.animFrameId=`draw_${$e()}`,e.on(It,r=>{t.wasResized()&&(this.canvasIdsList&&(r&&r.length!==0?this.canvasIdsList=this.canvasIdsList.concat(r):this.canvasIdsList=void 0),jr(this.animFrameId,()=>{this.forceDraw(this.canvasIdsList),this.canvasIdsList=[]}))}),this.drawHitTestCanvas=xo(()=>{this.drawingOrder.forEach(r=>{r.indexOf(jt)!==-1&&this.drawersMap[r].draw()})},20)}redrawCanvasesImmediate(){this.chartResizeHandler.fireUpdates(),this.forceDraw()}drawLastBar(){this.drawingOrder.forEach(e=>{if(e.indexOf(jt)===-1){const t=this.drawersMap[e];t.drawLastBar&&t.drawLastBar()}})}forceDraw(e){this.drawingOrder.forEach(t=>{if(t.indexOf(jt)===-1){const r=this.drawersMap[t];if(!e||e.length===0){r.draw();return}ao(e,r.getCanvasIds(),Wr).length!==0&&r.draw()}})}drawHitTestOnly(){this.drawHitTestCanvas()}addDrawer(e,t){this.drawingOrder.indexOf(t)===-1&&this.drawingOrder.push(t),this.drawersMap[t]=e}addDrawerAfter(e,t,r){this.addDrawer(e,t);const s=this.drawingOrder.indexOf(t);this.drawingOrder.splice(s,1);const i=this.drawingOrder.indexOf(r);this.drawingOrder.splice(i+1,0,t),this.reorderDrawers(this.drawingOrder)}addDrawerBefore(e,t,r){this.addDrawer(e,t);const s=this.drawingOrder.indexOf(r);if(s!==-1){const i=this.drawingOrder.indexOf(t);return this.drawingOrder.splice(i,1),this.drawingOrder.splice(s,0,t),this.reorderDrawers(this.drawingOrder),!0}return!1}getDrawerByName(e){return this.drawersMap[e]}getNameByDrawer(e){for(const t in this.drawersMap)if(this.drawersMap[t]===e)return t}removeDrawerByName(e){const t=this.drawersMap[e];this.removeDrawer(t)}removeDrawer(e){Object.keys(this.drawersMap).forEach(t=>{if(this.drawersMap[t]===e){delete this.drawersMap[t];const r=this.drawingOrder.indexOf(t);r!==-1&&this.drawingOrder.splice(r,1)}})}reorderDrawers(e){this.drawingOrder=zr(this.drawingOrder,e)}}class $r{static paneResizer(e){return`PANE_RESIZER_${e}`}}function He(n,e,t=Kr){function r(s,i){for(const a in i)a in s?typeof s[a]=="object"&&s[a]!==null&&!Array.isArray(s[a])?r(s[a],i[a]):t!=null&&t.overrideExisting&&(s[a]=i[a]):t!=null&&t.addIfMissing&&(s[a]=i[a]);return s}return r(n,e)}function Fv(n,e,t,r=!1){!n||!e||e.length===0||e.forEach(s=>{const i=t(s),a=n.findIndex(o=>t(o)===i);a===-1?n.push(s):r?He(n[a],s,{overrideExisting:!0,addIfMissing:!0}):n.splice(a,1,s)})}const Kr={overrideExisting:!1,addIfMissing:!0};var To=Object.defineProperty,qr=Object.getOwnPropertySymbols,Ao=Object.prototype.hasOwnProperty,Eo=Object.prototype.propertyIsEnumerable,Jr=(n,e,t)=>e in n?To(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Do=(n,e)=>{for(var t in e||(e={}))Ao.call(e,t)&&Jr(n,t,e[t]);if(qr)for(var t of qr(e))Eo.call(e,t)&&Jr(n,t,e[t]);return n};const Qr="Open Sans Semibold, sans-serif",Lo=null,Nv=n=>Lo.find(e=>e===n)!==void 0,Gt=()=>({useUTCTimeOverride:!1,logEvents:!1,shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],rtl:!1,scale:{keepZoomXOnYAxisChange:!0,auto:!0,zoomToCursor:!1,lockPriceToBarRatio:!1,autoScaleOnCandles:!0,autoScaleDisableOnDrag:{enabled:!0,edgeAngle:Math.PI/15,yDiff:80},inverse:!1,zoomSensitivity:.25,defaultViewportItems:100},timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,components:{chart:{type:"candle",showCandlesBorder:!0,showActiveCandlesBorder:!0,showWicks:!0,candleLineWidth:1,lineWidth:1,areaLineWidth:1,barLineWidth:1,minWidth:.5,minCandles:10,candlePaddingPercent:.25,highlightActiveCandle:!0,cursor:"default",selectedWidth:3,minCandlesOffset:2,defaultZoomCandleWidth:7,zoomStep:0,histogram:{barCapSize:1}},yAxis:{type:"regular",visible:!0,valueLines:100,zeroPercentLine:!0,customScale:!0,customScaleDblClick:!0,align:"right",fontSize:12,fontFamily:Qr,cursor:"ns-resize",labelBoxMargin:{top:4,bottom:4,end:8,start:10},typeConfig:{badge:{rounded:!0,paddings:{top:4,bottom:4,end:4,start:4}},plain:{},rectangle:{rounded:!1,paddings:{top:4,bottom:4,end:4,start:4}}},labels:{descriptions:!1,settings:{lastPrice:{mode:"label",type:"badge"},countdownToBarClose:{mode:"none",type:"rectangle"}}},width:60},xAxis:{visible:!0,formatsForLabelsConfig:{lessThanSecond:"mm:ss",second_1:"HH:mm:ss",minute_1:"HH:mm",minute_5:"HH:mm",minute_30:"HH:mm",hour_1:"HH:mm",day_1:"dd.MM",month_1:"MMM",year_1:"YYYY"},fontSize:12,fontFamily:Qr,cursor:"ew-resize",padding:{top:8,bottom:16},fontStyle:""},events:{visible:!1,eventsVisibility:{"conference-calls":!0,dividends:!0,splits:!0,earnings:!0},height:20,cursor:"default",xAxisLabelFormat:[{format:"d MMM"}],icons:{earnings:{normal:'<svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.06066 6.5L6.5 1.06066L11.9393 6.5L6.5 11.9393L1.06066 6.5Z" stroke="#D92C40" stroke-width="1.5"/></svg>',hover:'<svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.06066 6.5L6.5 1.06066L11.9393 6.5L6.5 11.9393L1.06066 6.5Z" fill="#D92C40" stroke="#D92C40" stroke-width="1.5"/></svg>'}}},offsets:{visible:!0,right:10,top:10,bottom:20,left:0},waterMark:{visible:!1,fontFamily:"Open Sans, sans-serif",firstRowFontSize:80,firstRowBottomPadding:10,secondRowFontSize:40,secondRowBottomPadding:25,thirdRowFontSize:40,thirdRowBottomPadding:15,position:"center",offsetX:20,offsetY:20,logoWidth:20,logoHeight:20},highLow:{visible:!1,font:"12px sans-serif"},highlights:{visible:!1,fontFamily:"Open Sans",fontSize:13,border:{width:1,dash:[8,4]}},crossTool:{type:"cross-and-labels",discrete:!1,magnetTarget:"none",lineDash:[4,6],xAxisLabelFormat:[{format:"dd.MM.YYYY",showWhen:{periodMoreThen:846e5}},{format:"dd.MM.YYYY HH:mm",showWhen:{periodLessThen:846e5,periodMoreThen:6e3}},{format:"dd.MM.YYYY HH:mm:ss",showWhen:{periodLessThen:6e3}}],xLabel:{padding:{top:4,bottom:4,right:8,left:8},margin:{top:4}},yLabel:{padding:{top:4,bottom:4,end:4,start:4},type:"badge"}},grid:{visible:!0,horizontal:!1,vertical:!0,width:1,dash:[0,0],color:"#FFFFFF"},volumes:{visible:!0,showSeparately:!1,valueLines:15,barCapSize:1,volumeBarSpace:0,volumeFillColor:"#FFFFFF"},navigationMap:{visible:!1,allCandlesHistory:!0,timeLabels:{visible:!1,dateFormat:"dd.MM.YYYY HH:mm",fontFamily:"Open Sans",fontSize:13,padding:{x:10,y:1}},minSliderWindowWidth:10,cursors:{chart:"default",buttonLeft:"pointer",buttonRight:"pointer",leftResizer:"ew-resize",rightResizer:"ew-resize",slider:"grab"},knots:{height:35,width:7,border:0,lineWidth:1}},baseline:{cursor:"ns-resize",dragZone:3,height:1},paneResizer:{cursor:"ns-resize",height:1,visible:!0,fixedMode:!1,dragZone:3}},colors:{candleTheme:{upColor:"rgba(77,153,83,1)",downColor:"rgba(217,44,64,1)",noneColor:"rgba(255,255,255,1)",upWickColor:"rgba(77,153,83,1)",downWickColor:"rgba(217,44,64,1)",noneWickColor:"rgba(255,255,255,1)",borderOpacity:1},barTheme:{upColor:"rgba(77,153,83,1)",downColor:"rgba(217,44,64,1)",noneColor:"rgba(255,255,255,1)"},lineTheme:{upColor:"rgba(77,153,83,1)",downColor:"rgba(217,44,64,1)",noneColor:"rgba(255,255,255,1)"},chartAreaTheme:{backgroundMode:"regular",backgroundColor:"rgba(20,20,19,1)",backgroundGradientTopColor:"red",backgroundGradientBottomColor:"blue",axisColor:"rgba(128,128,128,1)",gridColor:"rgba(37,37,36,1)"},scatterPlot:{mainColor:"rgba(255,255,255,1)"},areaTheme:{lineColor:"rgba(127,120,214,1)",startColor:"rgba(169,38,251,1)",stopColor:"rgba(169,38,251,0.8)"},baseLineTheme:{lowerSectionStrokeColor:"rgba(217,44,64,1)",upperSectionStrokeColor:"rgba(77,153,83,1)",lowerSectionFillColor:"rgba(217, 44, 64, 0.07)",upperSectionFillColor:"rgba(77, 153, 83, 0.07)",baselineColor:"rgba(55,55,54,1)"},histogram:{upCap:"rgba(77,153,83,1)",upBottom:"rgba(77,153,83,0.1)",upBright:"rgba(77,153,83,0.4)",downCap:"rgba(217,44,64,1)",downBottom:"rgba(217,44,64,0.1)",downBright:"rgba(217,44,64,0.4)",noneCap:"rgba(255,255,255,1)",noneBottom:"rgba(255,255,255,0.1)",noneBright:"rgba(255,255,255,0.4)"},crossTool:{lineColor:"rgba(107,96,86,1)",labelBoxColor:"rgba(107,96,86,1)",labelTextColor:"rgba(255,255,255,1)"},waterMarkTheme:{firstRowColor:"rgba(255,255,255,0.2)",secondRowColor:"rgba(255,255,255,0.2)",thirdRowColor:"rgba(255,255,255,0.2)"},highlights:{NO_TRADING:{border:"rgba(107,96,86,1)",background:"transparent",label:"transparent"},AFTER_MARKET:{border:"rgba(107,96,86,1)",background:"rgba(38, 251, 149, 0.05)",label:"transparent"},PRE_MARKET:{border:"rgba(107,96,86,1)",background:"rgba(255, 170, 0, 0.05)",label:"transparent"},REGULAR:{border:"rgba(107,96,86,1)",background:"transparent",label:"transparent"}},activeCandleTheme:{upColor:"rgba(98,201,93,1)",downColor:"rgba(255,47,47,1)",noneColor:"rgba(255,255,255,1)",upWickColor:"rgba(98,201,93,1)",downWickColor:"rgba(255,47,47,1)",noneWickColor:"rgba(255,255,255,1)",borderOpacity:.5},volume:{downBarColor:"rgba(99,30,37,1)",upBarColor:"rgba(42,72,44,1)",noneBarColor:"rgba(255,255,255,0.4)",upCapColor:"rgba(42,72,44,1)",downCapColor:"rgba(99,30,37,1)",noneCapColor:"rgba(255,255,255,0.4)"},highLowTheme:{highColor:"rgba(223,222,223,1)",lowColor:"rgba(223,222,223,1)"},instrumentInfo:{textColor:"#aeb1b3"},paneResizer:{lineColor:"rgba(55,55,54,1)",bgColor:"rgba(20,20,19,1)",bgHoverColor:"rgba(55,55,54,0.6)"},events:{earnings:{color:"rgba(217,44,64,1)"},dividends:{color:"rgba(169,38,251,1)"},splits:{color:"rgba(244,187,63,1)"},"conference-calls":{color:"rgba(48,194,97,1)"}},secondaryChartTheme:[{lineTheme:{upColor:"rgba(226,61,25,1)",downColor:"rgba(226,61,25,1)",noneColor:"rgba(226,61,25,1)"},areaTheme:{lineColor:"rgba(226,61,25,1)",startColor:"rgba(226,61,25,0.8)",stopColor:"rgba(226,61,25,0)"}},{lineTheme:{upColor:"rgba(250,191,64,1)",downColor:"rgba(250,191,64,1)",noneColor:"rgba(250,191,64,1)"},areaTheme:{lineColor:"rgba(250,191,64,1)",startColor:"rgba(250,191,64,0.8)",stopColor:"rgba(250,191,64,0)"}},{lineTheme:{upColor:"rgba(169,38,251,1)",downColor:"rgba(169,38,251,1)",noneColor:"rgba(169,38,251,1)"},areaTheme:{lineColor:"rgba(169,38,251,1)",startColor:"rgba(169,38,251,0.8)",stopColor:"rgba(169,38,251,0)"}},{lineTheme:{upColor:"rgba(77,211,240,1)",downColor:"rgba(77,211,240,1)",noneColor:"rgba(77,211,240,1)"},areaTheme:{lineColor:"rgba(77,211,240,1)",startColor:"rgba(77,211,240,0.8)",stopColor:"rgba(77,211,240,0)"}},{lineTheme:{upColor:"rgba(59,203,91,1)",downColor:"rgba(59,203,91,1)",noneColor:"rgba(59,203,91,1)"},areaTheme:{lineColor:"rgba(59,203,91,1)",startColor:"rgba(59,203,91,0.8)",stopColor:"rgba(59,203,91,0)"}}],yAxis:{backgroundColor:"transparent",backgroundHoverColor:"rgba(20,20,19,1)",labelBoxColor:"rgba(20,20,19,1)",labelDescriptionFillColor:"rgba(20,20,19,1)",labelTextColor:"rgba(128,128,128,1)",labelInvertedTextColor:"rgba(20,20,19,1)",rectLabelTextColor:"rgba(255,255,255,1)",rectLabelInvertedTextColor:"rgba(20,20,19,1)",zeroPercentLine:"rgba(55,55,54,1)"},labels:{lastPrice:{textNegative:"rgba(255,255,255,1)",textPositive:"rgba(255,255,255,1)",textSelected:"rgba(0,0,0,1)",boxNegative:"rgba(217,44,64,1)",boxPositive:"rgba(77,153,83,1)",boxSelected:"rgba(255,255,255,1)"},countdownToBarClose:{textNegative:"rgba(255,255,255,1)",textPositive:"rgba(255,255,255,1)",textSelected:"rgba(255,255,255,1)",boxNegative:"rgba(217,44,64,1)",boxPositive:"rgba(77,153,83,1)",boxSelected:"rgba(255,255,255,1)"},highLow:{high:{boxColor:"rgba(107,96,86,1)",textColor:"rgba(255,255,255,1)",descriptionText:"High"},low:{boxColor:"rgba(107,96,86,1)",textColor:"rgba(255,255,255,1)",descriptionText:"Low"}},bidAsk:{bid:{boxColor:"rgba(77,153,83,1)",textColor:"rgba(255,255,255,1)",descriptionText:"Bid"},ask:{boxColor:"rgba(217,44,64,1)",textColor:"rgba(255,255,255,1)",descriptionText:"Ask"}},prePostMarket:{post:{boxColor:"rgba(38,251,149,1)",textColor:"rgba(20,20,19,1)",descriptionText:"Post"},pre:{boxColor:"rgba(255,170,0,1)",textColor:"rgba(20,20,19,1)",descriptionText:"Pre"}},prevDayClose:{boxColor:"rgba(107,96,86,1)",textColor:"rgba(255,255,255,1)"}},xAxis:{backgroundColor:"transparent",labelBoxColor:"rgba(20,20,19,1)",labelTextColor:"rgba(128,128,128,1)"},navigationMap:{backgroundColor:"transparent",buttonColor:"rgba(255,255,255,0.1)",buttonArrowColor:"rgba(212,212,211,1)",knotColor:"rgba(255,255,255,0.1)",knotLineColor:"rgba(212,212,211,1)",sliderColor:"rgba(255,255,255,0.08)",knotBorderColor:"#0b0d1a",timeLabelsTextColor:"rgba(128,128,128,1)",mapColor:"rgba(255,255,255,0.1)",mapFillColor:"rgba(255,255,255,0.1)",mapGradientTopColor:"rgba(255,255,255,0.1)",mapGradientBottomColor:"rgba(255,255,255,0.1)"}},animation:{moveDuration:1e3,candleDuration:200,paneResizer:{bgMode:!0,enabled:!0,duration:40},yAxis:{background:{enabled:!1,duration:40}}},drawingOrder:[te.MAIN_CLEAR,te.OVER_SERIES_CLEAR,te.SERIES_CLEAR,te.GRID,te.X_AXIS,te.Y_AXIS,te.UNDERLAY_VOLUMES_AREA,te.VOLUMES,te.DATA_SERIES,te.DRAWINGS,te.WATERMARK,te.N_MAP_CHART,te.EVENTS]});function Io(n,e=Gt()){return He(n,e,Kr),n}function Yv(n,e=Gt()){const t=Do({},n);return merge(t,e,DEFAULT_MERGE_OPTIONS),t}function Hv(n,e){Object.keys(n).forEach(t=>delete n[t]),Object.keys(e).forEach(t=>n[t]=e[t])}function es(n){return typeof n=="object"&&n!==null}function ts(n,e){return[...n].map(r=>In(r,e))}const Oo=n=>Array.isArray(n);function In(n,e){if(!es(n))return n;if(Oo(n))return ts(n,e);{const t=ns({},n,e);return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t}}function ns(n,e,t){if(!es(n))return t.overrideExisting?e:n;if(Array.isArray(n)&&Array.isArray(e)){const s=t.overrideExisting?e:n;return ts(s,t)}const r=Object.create(Object.getPrototypeOf(n));return Object.keys(n).forEach(s=>r[s]=In(n[s],t)),Object.keys(e).forEach(s=>{s in n?r[s]=ns(n[s],e[s],t):t.addIfMissing&&(r[s]=In(e[s],t))}),r}var Bo=ue(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),G=function(n){N(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new rs(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Bo},e.prototype.next=function(t){var r=this;rt(function(){var s,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=p(r.currentObservers),o=a.next();!o.done;o=a.next()){var l=o.value;l.next(t)}}catch(c){s={error:c}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}})},e.prototype.error=function(t){var r=this;rt(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var s=r.observers;s.length;)s.shift().error(t)}})},e.prototype.complete=function(){var t=this;rt(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,s=this,i=s.hasError,a=s.isStopped,o=s.observers;return i||a?Oe:(this.currentObservers=null,o.push(t),new pe(function(){r.currentObservers=null,xe(o,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,s=r.hasError,i=r.thrownError,a=r.isStopped;s?t.error(i):a&&t.complete()},e.prototype.asObservable=function(){var t=new ye;return t.source=this,t},e.create=function(t,r){return new rs(t,r)},e}(ye),rs=function(n){N(e,n);function e(t,r){var s=n.call(this)||this;return s.destination=t,s.source=r,s}return e.prototype.next=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,t)},e.prototype.error=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&s!==void 0?s:Oe},e}(G),On=function(n){N(e,n);function e(t){var r=n.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,s=t.thrownError,i=t._value;if(r)throw s;return this._throwIfClosed(),i},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(G);function ke(n,e){return e===void 0&&(e=St),n=n!=null?n:Ro,x(function(t,r){var s,i=!0;t.subscribe(Re(r,function(a){var o=e(a);(i||!n(s,o))&&(i=!1,s=o,r.next(a))}))})}function Ro(n,e){return n===e}let Bn;const Zt=()=>(Bn||(Bn=!!navigator.userAgent.match(/Android|iPhone|Opera Mini/)||!1),Bn);function ss(n,e){let t="";e.textStyle&&(e.textStyle.italic&&(t+="italic "),e.textStyle.bold&&(t+="bold ")),n.font=t+(e.textSize||12)+" "+(e.textFontFamily||"monospace"),n.fillStyle=e.textFill||"#FFFFFF",e.rtl?n.textAlign="right":n.textAlign="start"}function Rn(n){const e=n.font.match(/(\d+.)?\d+(px|pt)/gi);let t="10px";return e&&e.length&&(e[0].includes("pt")?t=+e[0].slice(0,e[0].indexOf("pt"))*96/72+"px":t=e[0]),parseInt(t,10)*1.33}function is(n,e,t){n.save(),ss(n,t);const r=Math.ceil(Math.max.apply(Math,e.map(a=>n.measureText(a).width))),s=Rn(n),i=s*e.length;return n.restore(),[r,i,s]}function as(n){return(n||"").split(/\r\n|\r|\n/)}function Fo(n,e,t,r,s){n.save();const[i,,a]=is(n,e,s);e.forEach((o,l)=>{var c,u,g;const b=n.measureText(o).width,P=No(t,i,b,(c=s.textAlign)!=null?c:"left");s.textStyle&&s.textStyle.underline&&Yo(n,o,P,r+a*l,(u=s.textFill)!=null?u:"",(g=s.textSize)!=null?g:""),n.fillText(o,P,r+a*l)}),n.restore()}function No(n,e,t,r){switch(r){case"left":return n;case"right":return n+e-t;default:return n}}function Yo(n,e,t,r,s,i){n.save();const a=n.measureText(e).width,o=t,l=t+a,c=r+2,u=c;let g=parseInt(i,10)/15;g<1&&(g=1),n.beginPath(),n.strokeStyle=s,n.lineWidth=g,n.moveTo(o,c),n.lineTo(l,u),n.stroke(),n.restore()}function kv(n){return`${n}px`}function Ho(n,e,t,r){const s=r.components.navigationMap.timeLabels,i=s.padding,a=os(e,s.dateFormat,t),o=as(a),l={textFontFamily:s.fontFamily,textSize:`${s.fontSize}px`},[c,u]=is(n,o,l);return[c+i.x*2,u+i.y*2]}function os(n,e,t){return t(e)(n).split(" ").join(`
`)}const ls={};function at(n,e){let t=ls[n];return t!==void 0||(e.save(),e.font=n,t=e.measureText("M").width,ls[n]=t,e.restore()),t}const cs=new Map;function Ke(n,e,t){const r=t+n;let s=cs.get(r);return s||(e.save(),e.font=t,s=e.measureText(n).width,cs.set(r,s),e.restore()),s}var vt=_e(6767),Fn=_e.n(vt);function Nn(n){return n}function ko(n){return n!=null}function Uo(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}const zo=Object.prototype.hasOwnProperty;function Wo(n,e){if(Uo(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(let s=0,i=t.length;s<i;s++)if(!zo.call(e,t[s])||!Wo(n[t[s]],e[t[s]]))return!1;return!0}function hs(n){return Object.keys(n)}function Uv(n){return n!=null}const zv=()=>{};function Yn(n,e,t){const r=vt.rgb(n).array(),s=r[0],i=r[1],a=r[2];return(s*299+i*587+a*114)/1e3<128?e:t}function Wv(n){return n.join("")}function Ot(n){if(n)return n[0]}function Ue(n){if(n&&n.length)return n[n.length-1]}function Xo(n){const e=this.indexOf(n);return e!==-1&&this.splice(e,1),this}function Vo(n,e){if(!n)return;const t=n.indexOf(e);t!==-1&&n.splice(t,1)}const Bt=(n,e,t,r=1e3)=>{var s,i,a,o;const l=(i=(s=Ot(t))==null?void 0:s.timestamp)!=null?i:0,c=(o=(a=Ue(t))==null?void 0:a.timestamp)!=null?o:0;return n>c?e?{index:t.length-1+Math.ceil((n-c)/r),exact:!0}:{index:t.length-1,exact:!0}:n<l?e?{index:we((n-l)/r),exact:!0}:{index:-1,exact:!0}:ot(t,n,u=>u.timestamp)};function ot(n,e,t){const r=t!=null?t:Nn;return!n.length||e!==e?{index:-1,exact:!0}:Hn(n,e,0,n.length,r)}function Hn(n,e,t,r,s){const i=vo(t+r,1),a=s(n[i]);return e===a?{index:i,exact:!0}:t===i?{index:t,exact:!1}:e<a?Hn(n,e,t,i,s):Hn(n,e,i,r,s)}Gr(ot);function jo(){return!!document.documentMode}function Xv(){return!jo()&&!!window.StyleMedia}const us=(n,e)=>{for(const[t,r]of Array.from(n.entries()))if(r===e)return t},Go=(n,e)=>n>=0?e[n]:e[e.length+n];var Zo=Object.defineProperty,$o=Object.defineProperties,Ko=Object.getOwnPropertyDescriptors,ds=Object.getOwnPropertySymbols,qo=Object.prototype.hasOwnProperty,Jo=Object.prototype.propertyIsEnumerable,fs=(n,e,t)=>e in n?Zo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,qe=(n,e)=>{for(var t in e||(e={}))qo.call(e,t)&&fs(n,t,e[t]);if(ds)for(var t of ds(e))Jo.call(e,t)&&fs(n,t,e[t]);return n},vs=(n,e)=>$o(n,Ko(e));const re="CHART",kn=class{};let B=kn;B.CANVAS="CANVAS",B.N_MAP="N_MAP",B.X_AXIS="X_AXIS",B.N_MAP_KNOT_L="N_MAP_KNOT_L",B.N_MAP_KNOT_R="N_MAP_KNOT_R",B.N_MAP_BTN_L="N_MAP_BTN_L",B.N_MAP_BTN_R="N_MAP_BTN_R",B.N_MAP_SLIDER_WINDOW="N_MAP_SLIDER_WINDOW",B.N_MAP_CHART="N_MAP_CHART",B.N_MAP_LABEL_R="N_MAP_LABEL_R",B.N_MAP_LABEL_L="N_MAP_LABEL_L",B.PANE_UUID=n=>"PANE_"+n,B.PANE_UUID_Y_AXIS=n=>"PANE_"+n+"_Y_AXIS",B.PANE_UUID_RESIZER=n=>"PANE_"+n+"_RESIZER",B.ALL_PANES="ALL_PANES",B.ALL_Y_AXIS="ALL_Y_AXIS",B.CHART_WITH_Y_AXIS="CHART_WITH_Y_AXIS",B.EVENTS="EVENTS",B.CHART=kn.PANE_UUID(re),B.Y_AXIS=kn.PANE_UUID_Y_AXIS(re);const Un={x:0,y:0,pageX:0,pageY:0,width:0,height:0},Qo=60,el=20,gs=35,zn=15,ps=1.5,Wn=Zt()?8*ps:8,tl=1e-6;class Xn{constructor(e,t,r,s,i){this.config=e,this.eventBus=t,this.canvasModel=r,this.formatterFactory=s,this.bounds={},this.canvasOnPageLocation={x:0,y:0,pageX:0,pageY:0,width:0,height:0},this.panesOrder=[],this.panesOrderChangedSubject=new G,this.xAxisHeight=void 0,this.yAxisWidth=Qo,this.leftRatio=0,this.rightRatio=0,this.boundsChangedSubject=new G,this.barResizerChangedSubject=new G,this._graphsHeightRatio={chart:1},this.graphsHeightRatioChangedSubject=new G,this.boundsChangedSubscriptions={},i.canvasResized.subscribe(a=>{let o=a;o||(o=this.canvasModel.canvas.getBoundingClientRect()),this.updateCanvasOnPageLocation(o),this.recalculateBounds()})}get graphsHeightRatio(){return this._graphsHeightRatio}addPaneBounds(e,t){if(this.panesOrder.indexOf(e)===-1){if(this.panesOrder.push(e),t!==void 0){const r=this.panesOrder.indexOf(e);Pn(this.panesOrder,r,t)}this.recalculatePanesHeightRatios()}}overrideChartHeightRatios(e){const t=qe(qe({},this.graphsHeightRatio),e),r=Object.values(t).reduce((s,i)=>s+i,0);Math.abs(r-1)<tl?(this._graphsHeightRatio=t,this.recalculateBounds()):console.error(`Result ratio should be equal 1, but equal ${r}`)}movePaneUp(e){const t=this.panesOrder.indexOf(e);t!==-1&&(Pn(this.panesOrder,t,t-1),this.recalculateBounds(),this.eventBus.fireDraw(),this.panesOrderChangedSubject.next(this.panesOrder))}movePaneDown(e){const t=this.panesOrder.indexOf(e);t!==-1&&(Pn(this.panesOrder,t,t+1),this.recalculateBounds(),this.eventBus.fireDraw(),this.panesOrderChangedSubject.next(this.panesOrder))}reorderPanes(e){this.panesOrder=zr(this.panesOrder,e),this.recalculateBounds()}removedPaneBounds(e){Vo(this.panesOrder,e),delete this.graphsHeightRatio[e],delete this.bounds[B.PANE_UUID(e)],delete this.bounds[B.PANE_UUID_Y_AXIS(e)],delete this.bounds[B.PANE_UUID_RESIZER(e)],this.recalculatePanesHeightRatios()}recalculateBounds(){const e=this.canvasOnPageLocation.width,t=this.canvasOnPageLocation.height,r=this.config.components.paneResizer.height,s=this.getBounds(B.CANVAS);s.x=0,s.y=0,s.width=e,s.height=t;const i=this.getYAxisWidth(),a=this.getNavMapBounds(s),o=this.getXAxisBounds(a,s),l=t-o.height-a.height,c=this.config.components.yAxis.align==="right"?s.width-i:0,u=this.config.components.yAxis.align==="right"?0:c+i,g=0,b=s.width-i;let P=g;this.panesOrder.forEach((W,q)=>{const K=this.graphsHeightRatio[this.panesOrder[q]],Z=this.config.components.paneResizer.visible;Z&&(q!==0?Rt(this.bounds,B.PANE_UUID_RESIZER(W),u,P,s.width,r,this.canvasOnPageLocation):Rt(this.bounds,B.PANE_UUID_RESIZER(W),0,0,0,0,this.canvasOnPageLocation));const $=Rt(this.bounds,B.PANE_UUID(W),u,Z?P+r:P,b,Z?l*K-this.config.components.paneResizer.height:l*K,this.canvasOnPageLocation);this.config.components.yAxis.visible?Rt(this.bounds,B.PANE_UUID_Y_AXIS(W),c,Z?P+r:P,i,Z?l*K-r:l*K,this.canvasOnPageLocation):Rt(this.bounds,B.PANE_UUID_Y_AXIS(W),0,0,0,0,this.canvasOnPageLocation),P=$.y+$.height});const I=this.getBounds(B.ALL_PANES);I.x=u,I.y=g,I.width=b,I.height=P;const Y=this.getBounds(B.ALL_Y_AXIS);Y.x=c,Y.y=0,Y.width=i,Y.height=I.height;const k=this.getBounds(B.CHART_WITH_Y_AXIS),U=this.getBounds(B.PANE_UUID(re));this.getEventsBounds(U),this.copyBounds(U,k),k.width=s.width,this.recalculateNavigationMapElementBounds(),this.updateAllBoundsPageCoordinates(),this.notifyBoundsSubscribers()}updateCanvasOnPageLocation(e){this.canvasOnPageLocation=vs(qe({},this.canvasOnPageLocation),{x:e.x,y:e.y,width:e.width,height:e.height})}updateAllBoundsPageCoordinates(){for(const e of Object.keys(this.bounds)){const t=this.bounds[e];t.pageX=t.x+this.canvasOnPageLocation.x,t.pageY=t.y+this.canvasOnPageLocation.y}}getEventsBounds(e){const t=this.getBounds(B.EVENTS);return this.config.components.events.visible?(t.x=0,t.y=e.y+e.height-this.config.components.events.height,t.width=e.width,t.height=this.config.components.events.height):this.applyDefaultBounds(t),t}getNavMapBounds(e){const t=this.getBounds(B.N_MAP);return this.config.components.navigationMap.visible?(t.x=0,t.y=e.height-gs,t.width=e.width,t.height=gs):this.applyDefaultBounds(t),t}getXAxisBounds(e,t){const r=this.getBounds(B.X_AXIS);return this.config.components.xAxis.visible?(r.x=0,r.y=t.height-this.getXAxisHeight()-e.height,r.width=t.width,r.height=this.getXAxisHeight()):this.applyDefaultBounds(r),r}getXAxisHeight(){var e,t;if(!this.xAxisHeight){const r=this.config.components.xAxis.fontSize+"px "+this.config.components.xAxis.fontFamily,s=at(r,this.canvasModel.ctx);this.xAxisHeight=s+((e=this.config.components.xAxis.padding.top)!=null?e:0)+((t=this.config.components.xAxis.padding.bottom)!=null?t:0)}return this.xAxisHeight}setYAxisWidth(e){e!==this.config.components.yAxis.width&&(this.config.components.yAxis.width=e,this.recalculateBounds())}setXAxisHeight(e){e!==this.xAxisHeight&&(this.xAxisHeight=e,this.recalculateBounds())}setPanesOrder(e){this.panesOrder=e,this.recalculateBounds()}getYAxisWidth(){return this.config.components.yAxis.visible?this.config.components.yAxis.width:0}recalculatePanesHeightRatios(){this.calculateGraphsHeightRatios(),this.recalculateBounds()}calculateGraphsHeightRatios(){let e=this.graphsHeightRatio[re];const t=[];t.push(...this.panesOrder.filter(g=>g!==re)),this.panesOrder.forEach(g=>{this.graphsHeightRatio[g]===0&&delete this.graphsHeightRatio[g]});const r=t.map(g=>this.graphsHeightRatio[g]===void 0?void 0:this.graphsHeightRatio[g]),s=r.filter(g=>g!==void 0).length,i=r.filter(g=>g===void 0).length;let a=0,o=0,l=1,c=0;i>0&&([l,c]=rl(t.length),e*=l),s===0&&(e=1-c*i),o=1-e-c*i,r.forEach(g=>{g&&(o-=g*l)}),a=o/(t.length+1);const u=r.map(g=>g?g*l+a:c+a);e+=a,this._graphsHeightRatio={},this.graphsHeightRatio[re]=e,u.forEach((g,b)=>{const P=t[b];this.graphsHeightRatio[P]=g})}recalculateNavigationMapElementBounds(){var e,t,r,s;if(this.config.components.navigationMap.visible){const i=this.getBounds(B.N_MAP),{height:a,width:o}=this.config.components.navigationMap.knots,l=a!=null?a:0,c=Zt()?o*ps:o!=null?o:0,u=l?i.y+(i.height-l)/2:i.y,g=(t=(e=this.config.components.navigationMap)==null?void 0:e.timeLabels)==null?void 0:t.visible,b=ae=>Ho(this.canvasModel.ctx,ae,this.formatterFactory,this.config)[0],P=(s=(r=this.mainCandleSeries)==null?void 0:r.getSeriesInViewport().flat())!=null?s:[],I=g&&P.length?b(P[0].candle.timestamp):0,Y=g&&P.length?b(P[P.length-1].candle.timestamp):0,k=Math.max(I,Y);if(g){const ae=this.getBounds(B.N_MAP_LABEL_L);ae.x=i.x,ae.y=i.y,ae.width=k,ae.height=i.height;const ne=this.getBounds(B.N_MAP_LABEL_R);ne.x=i.x+i.width-k,ne.y=i.y,ne.width=k,ne.height=i.height}const U=this.getBounds(B.N_MAP_BTN_L);U.x=i.x+k,U.y=i.y,U.width=zn,U.height=i.height;const W=this.getBounds(B.N_MAP_BTN_R);W.x=i.x+i.width-zn-k,W.y=i.y,W.width=zn,W.height=i.height;const q=this.getBounds(B.N_MAP_KNOT_L);q.x=(W.x-U.x-U.width)*this.leftRatio+U.x+U.width,q.y=u,q.width=c!=null?c:Wn,q.height=l!=null?l:i.height;const K=this.getBounds(B.N_MAP_KNOT_R);K.x=(W.x-U.x-U.width)*this.rightRatio+U.x+U.width-Wn,K.y=u,K.width=c!=null?c:Wn,K.height=l!=null?l:i.height;const Z=this.getBounds(B.N_MAP_SLIDER_WINDOW);Z.x=q.x+q.width,Z.y=i.y,Z.width=K.x-Z.x,Z.height=i.height;const $=this.getBounds(B.N_MAP_CHART);$.x=U.x+U.width,$.y=i.y,$.width=W.x-$.x,$.height=i.height}}isVolumesInSeparatePane(){return this.config.components.volumes.visible&&this.config.components.volumes.showSeparately}getBounds(e){return this.bounds[e]===void 0&&(this.bounds[e]=this.copyOf(Un)),this.bounds[e]}getCanvasOnPageLocation(){return this.canvasOnPageLocation}getBoundsPanes(){return this.panesOrder.reduce((e,t)=>vs(qe({},e),{[t]:this.bounds[B.PANE_UUID(t)]}),{})}getBoundsHitTest(e,t=$t){const{extensionX:r,extensionY:s,wholePage:i}=qe(qe({},$t),t);return i?(a,o)=>{const l=this.getBounds(e);return a>l.pageX-r&&a<l.pageX+l.width+r&&o>l.pageY-s&&o<l.pageY+l.height+s}:(a,o)=>{const l=this.getBounds(e);return a>l.x-r&&a<l.x+l.width+r&&o>l.y-s&&o<l.y+l.height+s}}static hitTestOf(e,t=$t){const{extensionX:r,extensionY:s,wholePage:i}=qe(qe({},$t),t);return i?(a,o)=>a>e.pageX-r&&a<e.pageX+e.width+r&&o>e.pageY-s&&o<e.pageY+e.height+s:(a,o)=>a>e.x-r&&a<e.x+e.width+r&&o>e.y-s&&o<e.y+e.height+s}isChartBoundsAvailable(){const e=this.getBounds(B.CANVAS);return e.width>0&&e.height>0}resizePaneVertically(e,t){const r=this.panesOrder.indexOf(e),s=this.getBounds(B.PANE_UUID_RESIZER(e));this.doResizePaneVertically(r,s.y-t),this.barResizerChangedSubject.next()}doResizePaneVertically(e,t){const r=e-1,s=this.getBounds(B.ALL_PANES).height,i=this.config.components.paneResizer.height+el,a=s*this.graphsHeightRatio[this.panesOrder[e]],o=s*this.graphsHeightRatio[this.panesOrder[r]],l=a+t>i,c=o-t>i;if(l&&c){const u=t/s;this.graphsHeightRatio[this.panesOrder[e]]+=u,this.graphsHeightRatio[this.panesOrder[r]]-=u,this.recalculateBounds()}}notifyBoundsSubscribers(){Object.keys(this.boundsChangedSubscriptions).forEach(e=>{this.boundsChangedSubscriptions[e].next(this.getBounds(e))}),this.boundsChangedSubject.next()}observeBoundsChanged(e){let t=this.boundsChangedSubscriptions[e];return t||(t=new On(this.getBounds(e)),this.boundsChangedSubscriptions[e]=t),t.pipe(Ce(r=>this.copyOf(r)),ke((r,s)=>this.sameBounds(r,s)))}observeAnyBoundsChanged(){return this.boundsChangedSubject.asObservable()}copyOf(e){return qe({},e)}copyBounds(e,t){t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height}sameBounds(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}applyDefaultBounds(e){this.copyBounds(Un,e)}setMainCandleSeries(e){this.mainCandleSeries=e}}const nl={0:1,1:.8,2:.6,3:.5,4:.4,5:.2},rl=n=>{var e;const t=(e=nl[n])!=null?e:.4,r=(1-t)/n;return[t,r]},Vv=(n,e)=>n.x>e.x&&n.x<e.x+e.width&&n.y>e.y&&n.y<e.y+e.height,sl=(n,e)=>n>e.y&&n<e.y+e.height,Rt=(n,e,t,r,s,i,a)=>{const o=n[e];if(o)return o.x=t,o.y=r,o.pageX=t+a.x,o.pageY=r+a.y,o.width=s,o.height=i,o;const l={x:t,y:r,pageX:t+a.x,pageY:r+a.y,width:s,height:i};return n[e]=l,l},ms=(n,e)=>Math.min(Math.max(n,e.y),e.y+e.height),$t={extensionX:0,extensionY:0,wholePage:!1},bs=(n,e)=>n.width===e.width&&n.height===e.height;class il{constructor(e){this.chart=e}addMouseHoverListener(e){return this.chart.bus.on(Tn,e)}addMouseCloseHoverListener(e){return this.chart.bus.on(An,e)}addRedrawListener(e){return this.chart.bus.on(It,e)}addResizeListener(e){return this.chart.bus.on(Xt,e)}addYAxisContextMenuClickListener(e){const t=this.chart.canvasBoundsContainer.getBoundsHitTest(B.ALL_Y_AXIS),r=this.chart.canvasInputListener.observeContextMenu(t).subscribe(s=>e(s));return()=>r.unsubscribe()}addYAxisDoubleClickListener(e){const t=this.chart.canvasBoundsContainer.getBoundsHitTest(B.Y_AXIS),r=this.chart.canvasInputListener.observeDbClick(t).subscribe(()=>e());return()=>r.unsubscribe()}}class ws{constructor(e){this.UNKNOWN_ARR=[],this.handlers={},this.muted=!1,this.unsub=(t,r)=>{const s=this.handlers[t];s!==void 0&&Xo.call(s,r)},this.add=(t,r,s)=>(r in this.handlers?t.call(this.handlers[r],s):this.handlers[r]=[s],this.unsub.bind(this,r,s)),this.on=(t,r)=>this.add(this.UNKNOWN_ARR.push,t,r),this.observe=t=>{const r=new G,s=r.next.bind(r),i=r.unsubscribe.bind(r);return this.on(t,s),r.unsubscribe=()=>{this.unsub(t,s),i()},r.asObservable()},this.onPrior=(t,r)=>this.add(this.UNKNOWN_ARR.unshift,t,r),this.off=this.unsub,this.fire=(t,...r)=>{var s;if(this.log("chart event: "+t),!this.muted){const i=(s=this.handlers[t])!=null?s:[];let a;for(a=0,i.length;a<i.length;a++)i[a].apply(null,r)}},this.fireAsync=(t,r)=>{if(!this.muted)return window.setTimeout(this.fire.bind(this,t,r),0)},this.setMuted=t=>{this.muted=t},this.types={CROSS:Ze.EVENT_CROSS,HOVER:Ze.EVENT_HOVER,CLOSE_HOVER:Ze.EVENT_CLOSE_HOVER,RESIZED:Ze.EVENT_RESIZED,CHART_DOUBLE_CLICK:Ze.EVENT_CHART_DOUBLE_CLICK},this.clear=()=>{this.handlers={}},this.log=e.logEvents&&typeof console!="undefined"&&Function.prototype.bind.call(console.log,console)||Nn}fireDraw(e){this.fire(It,e)}}Gr(ws);class Vn{constructor(e,t){this.onTickFunction=t,this.animationTimeLeft=0,this.animationInProgress=!1,this.animationTime=e.duration,this.animationTimeLeft=e.timeLeft===void 0?e.duration:e.timeLeft,this.animationInProgress=!0}tick(){this.animationTimeLeft<=0?this.animationInProgress=!1:this.animationTimeLeft--,this.onTickFunction&&this.onTickFunction()}getProgress(){return 1-this.animationTimeLeft/this.animationTime}finishAnimation(){this.animationInProgress=!1,this.animationTimeLeft=0}}class al extends Vn{constructor(e,t,r=()=>{}){super(e,r),this.colorConfigs=t,t.forEach(s=>{s.rgbColor=vt.rgb(s.color),s.initialAlpha=s.rgbColor.valpha,s.currentAnimationColor=s.rgbColor})}tick(){super.tick(),this.animationInProgress&&this.colorConfigs.forEach(e=>{e.initialAlpha===void 0||e.rgbColor===void 0||(e.type==="fading"?e.currentAnimationColor=e.rgbColor.alpha(e.initialAlpha*this.animationTimeLeft/this.animationTime):e.type==="appearing"&&(e.currentAnimationColor=e.rgbColor.alpha(e.initialAlpha*(1-this.animationTimeLeft/this.animationTime))))})}getColor(e){var t,r;return(r=(t=this.colorConfigs[e].currentAnimationColor)==null?void 0:t.toString())!=null?r:"#FFFFFF"}revert(){this.animationTimeLeft=Math.max(this.animationTime-this.animationTimeLeft,1),this.colorConfigs.forEach(e=>{e.type==="fading"?e.type="appearing":e.type="fading"})}}class ol extends Vn{constructor(e,t,r=()=>{}){super(e,r),this.colorConfigs=t,t.forEach(s=>{s.rgbStartColor=vt.rgb(s.startColor),s.rgbEndColor=vt.rgb(s.endColor),s.currentAnimationColor=s.type==="appearing"?s.rgbStartColor:s.rgbEndColor})}tick(){super.tick(),this.animationInProgress&&this.colorConfigs.forEach(e=>{const t=1-this.animationTimeLeft/this.animationTime;!e.rgbStartColor||!e.rgbEndColor||(e.type==="fading"?e.currentAnimationColor=this.calculateTransitionColor(e.rgbEndColor,e.rgbStartColor,t):e.type==="appearing"&&(e.currentAnimationColor=this.calculateTransitionColor(e.rgbStartColor,e.rgbEndColor,t)))})}getColor(e){var t,r;return(r=(t=this.colorConfigs[e].currentAnimationColor)==null?void 0:t.toString())!=null?r:"#FFFFFF"}revert(){this.animationTimeLeft=Math.max(this.animationTime-this.animationTimeLeft,1),this.colorConfigs.forEach(e=>{e.type==="fading"?e.type="appearing":e.type="fading"})}moveToLastTick(){this.animationTimeLeft=1}calculateTransitionColor(e,t,r){const s=e.red()-(e.red()-t.red())*r,i=e.green()-(e.green()-t.green())*r,a=e.blue()-(e.blue()-t.blue())*r;return vt.rgb(s,i,a)}}var ll=Math.pow;const Kt=14,qt=[];for(let n=0;n<Kt+1;n++)qt.push(ll(10,n));const jn=5e-13;class ge{static roundToNearest(e,t){return isFinite(e)?ge.isZero(e)?0:(e>0?e+=jn:e<0&&(e-=jn),ge.roundDecimal(Math.round(ge.roundDecimal(e/t))*t)):e}static roundUpToNearest(e,t){return ge.roundDecimal(Math.ceil(e/t))*t}static roundDecimal(e){if(isNaN(e)||e===Math.floor(e))return e;const t=Math.sign(e),r=Math.abs(e),s=Math.min(Kt,Kt-1-Math.floor(Math.log10(r)));for(let i=s;i>=0;i--){const a=Math.floor(qt[i]*r+.5);if(a<qt[Kt])return t*a/qt[i]}return Math.round(e)}static makeDecimal(e,t,r){if(isFinite(e)){const s=e.toFixed(t);return r?s.replace(".",r):s}else return""}static compare(e,t,r){return e>t+r?1:e<t-r?-1:(isNaN(e)?1:0)-(isNaN(t)?1:0)}static isZero(e){return ge.compare(e,0,jn)===0}static cutNumber(e,t,r=0){return{K:i=>i/1e3,M:i=>i/1e6}[t](e).toFixed(r)+t}}function cl(n){return 1-(Math.pow(2,-10*n)-.0009765625)*1.0009775171065494}function Ft(...n){for(const e of n)if(isFinite(e))return e;return NaN}class hl extends Vn{constructor(e,t,r){var s;super(t,r),this.viewportModel=e,this.animationConfig=t,this.id=$e(),this.xStart=e.xStart,this.xEnd=e.xEnd,this.yStart=e.yStart,this.yEnd=e.yEnd,this.zoomX=e.zoomX,this.zoomY=e.zoomY,this.easingFn=(s=t.easingFn)!=null?s:cl}tick(){if(super.tick(),this.animationInProgress){const e=this.easingFn(this.getProgress()),t=this.xStart+(this.animationConfig.targetXStart-this.xStart)*e,r=this.xEnd+(this.animationConfig.targetXEnd-this.xEnd)*e,s=this.yStart+(this.animationConfig.targetYStart-this.yStart)*e,i=this.yEnd+(this.animationConfig.targetYEnd-this.yEnd)*e,a=this.zoomX+(this.animationConfig.targetZoomX-this.zoomX)*e,o=this.zoomY+(this.animationConfig.targetZoomY-this.zoomY)*e;this.viewportModel.apply({xStart:t,xEnd:r,yStart:s,yEnd:i,zoomX:a,zoomY:o,inverseY:this.viewportModel.inverseY})}}finishAnimation(){super.finishAnimation(),this.viewportModel.apply({xStart:this.animationConfig.targetXStart,xEnd:this.animationConfig.targetXEnd,yStart:this.animationConfig.targetYStart,yEnd:this.animationConfig.targetYEnd,zoomX:this.animationConfig.targetZoomX,zoomY:this.animationConfig.targetZoomY,inverseY:this.viewportModel.inverseY})}}var ul=Object.defineProperty,dl=Object.defineProperties,fl=Object.getOwnPropertyDescriptors,Cs=Object.getOwnPropertySymbols,vl=Object.prototype.hasOwnProperty,gl=Object.prototype.propertyIsEnumerable,ys=(n,e,t)=>e in n?ul(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pl=(n,e)=>{for(var t in e||(e={}))vl.call(e,t)&&ys(n,t,e[t]);if(Cs)for(var t of Cs(e))gl.call(e,t)&&ys(n,t,e[t]);return n},ml=(n,e)=>dl(n,fl(e));const Ss=10,Gn="VIEWPORT_ANIMATION";class bl{constructor(e){this.eventBus=e,this.animations={}}startViewportMovementAnimation(e,t,r=Gn,s){const i=new hl(e,t,s);return this.animations[r]=i,this.ensureIntervalStarted(),i}startColorAlphaAnimation(e,t,r,s){const i=new al(ml(pl({},s),{duration:s&&s.duration||Ss}),t,r);return this.animations[e]=i,this.ensureIntervalStarted(),i}startColorTransitionAnimation(e,t,r=Ss,s){const i=new ol({duration:r},t,s);return this.animations[e]=i,this.ensureIntervalStarted(),i}getAnimation(e){return this.animations[e]}getColorAlphaAnimation(e){return this.getAnimation(e)}getColorTransitionAnimation(e){return this.getAnimation(e)}forceStopAnimation(e){const t=this.animations[e];t&&(t.animationTimeLeft=-1,t.animationInProgress=!1)}ensureIntervalStarted(){this.animationIntervalId||(this.animationIntervalId=window.setInterval(()=>this.tick(),20))}tick(){let e=!0;for(const t of Object.keys(this.animations)){const r=this.animations[t];r.tick(),r.animationInProgress&&(e=!1)}e?this.stopInterval():this.eventBus.fireDraw()}stopInterval(){clearInterval(this.animationIntervalId),this.animationIntervalId=void 0}}class ee{constructor(){this.subscriptions=[],this._state="initial",this.entities=[]}doActivate(){}doDeactivate(){this.subscriptions.forEach(e=>e()),this.subscriptions=[]}enable(){this._state!=="active"&&(this._state="deactivated",this.activate())}disable(){this._state!=="disabled"&&(this.deactivate(),this._state="disabled")}activate(){this._state!=="disabled"&&(this._state!=="active"&&(this.doActivate(),this._state="active"),this.entities.forEach(e=>e.activate()))}deactivate(){this._state!=="disabled"&&(this._state!=="deactivated"&&(this.doDeactivate(),this._state="deactivated"),this.entities.forEach(e=>e.deactivate()))}getState(){return this._state}addSubscription(e){this.subscriptions.push(e)}addRxSubscription(e){e&&this.subscriptions.push(e.unsubscribe.bind(e))}addChildEntity(e){this.entities.push(e),this._state==="active"&&e.activate()}removeChildEntity(e){this.entities=this.entities.filter(t=>t!==e)}}const wl=n=>e=>{const{top:t,bottom:r}=n(),s=e.high-e.low,i=s*t/100,a=s*r/100,o=e.low-a,l=e.high+i;return{low:o,high:l}},Ms=(n,e)=>({isHighLowActive:()=>!0,calculateHighLow:t=>{const r=e.calculateHighLow(t),{top:s,bottom:i}=n(),a=r.high-r.low,o=a*s/100,l=a*i/100,c=r.low-l,u=r.high+o;return{low:c,high:u}}}),jv=n=>Array.isArray(n[0])?n:[n];class Cl{constructor(e,t,r){this.paneManager=e,this.canvasModel=t,this.seriesDrawers=r}draw(){const e=this.canvasModel.ctx;Object.values(this.paneManager.paneComponents).forEach(t=>{e.save(),gt(e,t.getBounds()),t.dataSeries.forEach(r=>this.drawSeries(e,r)),e.restore()})}drawSeries(e,t){if(t.config.visible){const r=t.config.type,s=this.seriesDrawers[r];if(s){const i=t.getSeriesInViewport(t.scaleModel.xStart-1,t.scaleModel.xEnd+1);i&&i.length>=1&&s.draw(e,i,t,{})}else console.error(`Data series drawer with type ${r} isn't registered!`)}}getCanvasIds(){return[this.canvasModel.canvasId]}}const gt=(n,e)=>{n.beginPath(),n.rect(e.x,e.y,e.width,e.height),n.clip(),n.closePath()},_t=(n,e,t,r,s=e)=>{r.forceBold?n.lineWidth=r.forceBold:t.hovered?n.lineWidth=s:n.lineWidth=e};function _s(n){n===void 0&&(n={});var e=n.connector,t=e===void 0?function(){return new G}:e,r=n.resetOnError,s=r===void 0?!0:r,i=n.resetOnComplete,a=i===void 0?!0:i,o=n.resetOnRefCountZero,l=o===void 0?!0:o;return function(c){var u,g,b,P=0,I=!1,Y=!1,k=function(){g==null||g.unsubscribe(),g=void 0},U=function(){k(),u=b=void 0,I=Y=!1},W=function(){var q=u;U(),q==null||q.unsubscribe()};return x(function(q,K){P++,!Y&&!I&&k();var Z=b=b!=null?b:t();K.add(function(){P--,P===0&&!Y&&!I&&(g=Zn(W,l))}),Z.subscribe(K),!u&&P>0&&(u=new ft({next:function($){return Z.next($)},error:function($){Y=!0,k(),g=Zn(U,s,$),Z.error($)},complete:function(){I=!0,k(),g=Zn(U,a),Z.complete()}}),je(q).subscribe(u))})(c)}}function Zn(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(e===!0){n();return}if(e!==!1){var s=new ft({next:function(){s.unsubscribe(),n()}});return je(e.apply(void 0,v([],_(t)))).subscribe(s)}}const Jt=(n,e)=>n/e,Me=(n,e)=>n/e,ze=(n,e)=>n*e,xs=(n,e)=>(n-e)*100/e,Ps=(n,e)=>n*e/100+e,Ts=n=>Math.log2(n),$n=n=>Math.pow(2,n);class yl extends ee{constructor(){super(...arguments),this._xStart=0,this._xEnd=0,this._yStart=0,this._yEnd=0,this._zoomX=1,this._zoomY=1,this._inverseY=!1,this.changed=new G,this.xChanged=this.changed.pipe(Ce(()=>({start:this.xStart,end:this.xEnd})),ke((e,t)=>e.start===t.start&&e.end===t.end),_s()),this.yChanged=this.changed.pipe(Ce(()=>({start:this.yStart,end:this.yEnd})),ke((e,t)=>e.start===t.start&&e.end===t.end),_s())}toX(e){return this.getBounds().x+Me(e-this.xStart,this.zoomX)}xPixels(e){return Me(e,this.zoomX)}toY(e){return this.inverseY?this.getBounds().y+Me(e-this.yStart,this.zoomY):this.getBounds().y+this.getBounds().height-Me(e-this.yStart,this.zoomY)}yPixels(e){return Me(e,this.zoomY)}fromX(e){const t=e-this.getBounds().x;return ze(t+Me(this.xStart,this.zoomX),this.zoomX)}fromY(e){const t=e-this.getBounds().y;return this.inverseY?ze(t+Me(this.yStart,this.zoomY),this.zoomY):ze(this.getBounds().height-t+Me(this.yStart,this.zoomY),this.zoomY)}recalculateZoomX(){this.zoomX=this.calculateZoomX(this.xStart,this.xEnd)}recalculateZoomY(){this.zoomY=this.calculateZoomY(this.yStart,this.yEnd)}calculateZoomX(e,t){return Jt(t-e,this.getBounds().width)}calculateZoomY(e,t){return Jt(t-e,this.getBounds().height)}recalculateZoom(e=!0){this.recalculateZoomX(),this.recalculateZoomY(),e&&this.fireChanged()}setXScale(e,t,r=!0){this.xStart=e,this.xEnd=t,this.recalculateZoomX(),r&&this.fireChanged()}setYScale(e,t,r=!0){this.yStart=e,this.yEnd=t,this.recalculateZoomY(),r&&this.fireChanged()}export(){return{xStart:this.xStart,xEnd:this.xEnd,yStart:this.yStart,yEnd:this.yEnd,zoomX:this.zoomX,zoomY:this.zoomY,inverseY:this.inverseY}}apply(e){this.xStart=e.xStart,this.xEnd=e.xEnd,this.yStart=e.yStart,this.yEnd=e.yEnd,this.zoomX=e.zoomX,this.zoomY=e.zoomY,this.inverseY=e.inverseY,this.fireChanged()}fireChanged(){this.changed.next()}get xStart(){return this._xStart}set xStart(e){this._xStart=e}get xEnd(){return this._xEnd}set xEnd(e){this._xEnd=e}get yStart(){return this._yStart}set yStart(e){this._yStart=e}get yEnd(){return this._yEnd}set yEnd(e){this._yEnd=e}get zoomX(){return this._zoomX}set zoomX(e){this._zoomX=e}get zoomY(){return this._zoomY}set zoomY(e){this._zoomY=e}get inverseY(){return this._inverseY}set inverseY(e){this._inverseY=e}isViewportValid(){return this.xStart!==this.xEnd&&this.yStart!==this.yEnd&&isFinite(this.yStart)&&isFinite(this.yEnd)}}const Sl=(n,e)=>!hs(n).some(t=>n[t]!==e[t]);let We=window.devicePixelRatio,Qt=window.matchMedia(`screen and (resolution: ${window.devicePixelRatio}dppx)`);const Kn=()=>{Qt.removeEventListener("change",Kn),We=window.devicePixelRatio,Qt=window.matchMedia(`screen and (resolution: ${window.devicePixelRatio}dppx)`),Qt.addEventListener("change",Kn)};Qt.addEventListener("change",Kn);const Ml=()=>We,_l=n=>Mt(We*n)/We,ie=n=>we(We*n)/We,As=n=>fo(We*n)/We,qn=.3,xl=(n,e)=>{const t=e.barTheme[`${n}Color`];return Fn()(t).alpha(qn).toString()},Pl=(n,e)=>{const t=e.lineTheme[`${n}Color`];return Fn()(t).alpha(qn).toString()},Es=(n,e)=>{const t=e.candleTheme[`${n}Color`];return Fn()(t).alpha(qn).toString()},Tl=3;class Ds{constructor(e,t,r,s,i,a,o){this.canvasModel=e,this.config=t,this.volumesModel=r,this.chartModel=s,this.viewportModel=i,this.volumesColorByChartTypeMap=a,this.drawPredicate=o,this.volumeBarColors={down:"#FF00FF",up:"#FF00FF",none:"#FF00FF"}}calculateColors(e){var t;const r=(t=this.volumesColorByChartTypeMap[e])!=null?t:Es;this.volumeBarColors.down=r("down",this.config.colors),this.volumeBarColors.up=r("up",this.config.colors),this.volumeBarColors.none=r("none",this.config.colors)}draw(){if(this.config.components.volumes.visible&&this.drawPredicate()){this.calculateColors(this.config.components.chart.type);const e=this.canvasModel.ctx;e.save();const t=this.viewportModel.getBounds();gt(e,t),this.drawVolumes(),e.restore()}}drawLastBar(){this.config.components.volumes.visible}drawVolumes(){const e=this.volumesModel.volumeMax.getValue();if(e===0)return;const t=this.chartModel.mainCandleSeries.getSeriesInViewport().flat();t.forEach((r,s)=>{if(r.candle.volume){const i=this.viewportModel.getBounds(),a=i.height,o=t[s+1]!==void 0?ie(this.viewportModel.toX(t[s+1].startUnit)):void 0,l=ie(this.viewportModel.toX(r.startUnit)),c=o!==void 0?o-l:ie(Me(r.width,this.viewportModel.zoomX));if(this.config.components.volumes.showSeparately){const u=ie(this.viewportModel.toY(r.candle.volume)),g=ie(this.viewportModel.toY(0))-u;this.drawVolume(r,l,u,c,g)}else{const u=e/(a/Tl),g=Math.max(Me(r.candle.volume,u),2),b=ie(i.y+a-g);this.drawVolume(r,l,b,c,g)}}})}drawVolume(e,t,r,s,i){const a=this.canvasModel.ctx,o=r,l=r+i,c=e.name;a.fillStyle=this.volumeBarColors[c],a.strokeStyle=this.volumeBarColors[c],s===0?(a.beginPath(),a.moveTo(t,o),a.lineTo(t,As(l)),a.stroke()):a.fillRect(t,r,s,As(i))}getCanvasIds(){return[this.canvasModel.canvasId]}}const Ls=5,Al=1e-10,El=/\.?0+$/,Is=/(\.[1-9]*)0+$/,Dl=n=>{const e=(t,r)=>{const s=Math.pow(10,Ls),i=Math.round(t*s)/s;return i<1&&i>=Al?i.toFixed(Ls).replace(El,"").replace(Is,""):(i+"").replace(Is,"")+(r||"")};return Math.abs(n)>999999999?(n=Math.round(n/1e6)*1e6,e(n/1e9,"B")):Math.abs(n)>999999?(n=1e3*Math.round(n/1e3),e(n/1e6,"M")):Math.abs(n)>9999?e(n/1e3,"K"):e(n)},en=class extends ee{constructor(n,e,t,r,s,i,a){super(),this.canvasModel=n,this.chartComponent=e,this.drawingManager=t,this.config=r,this.volumesModel=s,this.volumesColorByChartTypeMap=i,this.paneManager=a,r.components.volumes.showSeparately&&this.activateSeparateVolumes()}doActivate(){super.doActivate(),this.addRxSubscription(this.chartComponent.chartModel.candlesUpdatedSubject.subscribe(()=>{var n,e;return!((n=this.scaleModel)!=null&&n.isViewportValid())&&((e=this.scaleModel)==null?void 0:e.doAutoScale(!0))})),this.addRxSubscription(this.volumesModel.volumeMax.subscribe(()=>{var n;return(n=this.scaleModel)==null?void 0:n.doAutoScale()}))}activateSeparateVolumes(){if(this.paneManager.paneComponents[en.UUID]===void 0){const n=this.paneManager.createPane(en.UUID,{paneFormatters:{regular:Dl},useDefaultHighLow:!1,increment:1}),{scaleModel:e}=n,t=Ms(()=>({top:10,bottom:0,left:0,right:0,visible:!0}),this.volumesModel.highLowProvider);e.autoScaleModel.setHighLowProvider("volumes",t),e.doAutoScale(!0),this.scaleModel=e;const r=new Ds(this.canvasModel,this.config,this.volumesModel,this.chartComponent.chartModel,e,this.volumesColorByChartTypeMap,()=>this.config.components.volumes.showSeparately);this.drawingManager.addDrawer(r,te.UNDERLAY_VOLUMES_AREA)}}deactiveSeparateVolumes(){this.paneManager.removePane(en.UUID),delete this.scaleModel,this.drawingManager.removeDrawerByName(te.UNDERLAY_VOLUMES_AREA)}fromY(n){var e,t;return(t=(e=this.scaleModel)==null?void 0:e.fromY(n))!=null?t:0}};let tn=en;tn.UUID="volumes";class Ll extends ee{constructor(e,t,r,s,i){super(),this.element=e,this.canvasInputListener=t,this.canvasBoundsContainer=r,this.chartConfig=s,this.hitTestCanvasModel=i,this.normalLayer=new Map,this.extensionLayer=new Map,this.cursorChangedSubject=new G}doActivate(){super.doActivate(),this.canvasInputListener.observeMouseMoveNoDrag().subscribe(e=>{const t=this.hitTestCanvasModel.resolveCursor(e);if(t!==void 0){this.updateCursor(t);return}e&&(this.normalLayer.forEach(r=>{r.hitTest(e.x,e.y)&&this.updateCursor(r.cursor)}),this.extensionLayer.forEach(r=>{r.hitTest(e.x,e.y)&&this.updateCursor(r.cursor)}))})}setCursorTypeForBounds(e,t,r,s=0){const i=Xn.hitTestOf(t,{extensionY:s});s?this.extensionLayer.set(e,{cursor:r,hitTest:i}):this.normalLayer.set(e,{cursor:r,hitTest:i})}addCursorForCanvasEl(e,t,r){this.observeCursorType(e,t,r)}removeCursorForCanvasEl(e){this.normalLayer.delete(e),this.extensionLayer.delete(e)}observeCursorChanged(){return this.cursorChangedSubject.pipe(ke())}observeCursorType(e,t,r){const s=r?this.canvasBoundsContainer.getBoundsHitTest(e,{extensionY:r}):this.canvasBoundsContainer.getBoundsHitTest(e);r?this.extensionLayer.set(e,{cursor:t,hitTest:s}):this.normalLayer.set(e,{cursor:t,hitTest:s})}updateCursor(e){this.element.style.cursor!==e&&(this.element.style.cursor=e,this.cursorChangedSubject.next(e))}toggleVolumesMode(e){const t=B.PANE_UUID(tn.UUID),r=B.PANE_UUID_RESIZER(tn.UUID);e?(this.observeCursorType(t,this.chartConfig.components.chart.cursor),this.observeCursorType(r,this.chartConfig.components.paneResizer.cursor,this.chartConfig.components.paneResizer.dragZone)):(this.normalLayer.delete(t),this.extensionLayer.delete(r))}}const Il=n=>{const e=n.canvasArea!==null,t=n.snapshotCanvas!==null,r=n.backgroundCanvas!==null,s=n.mainCanvas!==null,i=n.overDataSeriesCanvas!==null,a=n.staticDrawingCanvas!==null,o=n.dynamicDrawingCanvas!==null,l=n.yAxisLabelsCanvas!==null,c=n.crossToolCanvas!==null,u=n.hitTestCanvas!==null,g=n.chartResizer!==null,b=n.chartContainer!==null,P=n.dataSeriesCanvas!==null;return e&&t&&r&&s&&i&&a&&o&&l&&c&&u&&g&&b&&P},Ol=`<div data-element="chartResizer" style="position: relative; min-height: 20px; height: 100%; width: 100%; touch-action: manipulation; z-index: 0;">
	<div data-element="chartContainer" style="position: absolute; height: 100%; width: 100%;" class="chart chartArea--graph">
		<div data-element="canvasArea" style="position: relative; height: 100%; width: 100%; touch-action: manipulation;">
			<canvas data-element="snapshotCanvas" style="z-index: 0"></canvas>
			<canvas data-element="backgroundCanvas" style="z-index: 1"></canvas>
			<canvas data-element="mainCanvas" style="z-index: 2"></canvas>
			<canvas data-element="staticDrawingCanvas" style="z-index: 3"></canvas>
			<canvas data-element="dataSeriesCanvas" style="z-index: 5"></canvas>
			<canvas data-element="overDataSeriesCanvas" style="z-index: 6"></canvas>
			<canvas data-element="dynamicDrawingCanvas" style="z-index: 7"></canvas>
			<canvas data-element="yAxisLabelsCanvas" style="z-index: 8"></canvas>
			<canvas data-element="crossToolCanvas" style="z-index: 9"></canvas>
			<canvas data-element="hitTestCanvas" style="z-index: 10"></canvas>
		</div>
	</div>
</div>
`;function Bl(){const n=document.createElement("template");return n.innerHTML=Ol,n}function Rl(n){const e={},t=Array.from(n.querySelectorAll("[data-element]"));if(t.length!==0&&t.forEach(r=>{var s;e[(s=r.getAttribute("data-element"))!=null?s:""]=r}),Il(e))return e;throw new Error("Some chart elements are missing")}class Fl{constructor(e,t){this.canvasModel=e,this.config=t}draw(){this.canvasModel.clear();const e=this.canvasModel.ctx;if(this.config.colors.chartAreaTheme.backgroundMode==="gradient"){const t=e.createLinearGradient(0,0,this.canvasModel.width,this.canvasModel.height);t.addColorStop(0,this.config.colors.chartAreaTheme.backgroundGradientTopColor),t.addColorStop(1,this.config.colors.chartAreaTheme.backgroundGradientBottomColor),e.fillStyle=t}else e.fillStyle=this.config.colors.chartAreaTheme.backgroundColor;e.fill(),e.fillRect(0,0,this.canvasModel.width,this.canvasModel.height)}getCanvasIds(){return[this.canvasModel.canvasId]}}const Os=(n,e,t,r,s,i)=>{const a=Ml(),o=[t*a,r*a,s*a,i*a],l=n.getImageData(...o);e.putImageData(l,o[0],o[1])};class Nl{constructor(e,t,r){this.seriesDrawers=e,this.canvasModel=t,this.paneManager=r}draw(){const e=this.canvasModel.ctx;Object.values(this.paneManager.paneComponents).forEach(t=>{e.save(),gt(e,t.getBounds()),t.dataSeries.forEach(r=>this.drawSeries(e,r)),e.restore()})}drawSeries(e,t){if(t.config.visible){const r=t.config.type,s=this.seriesDrawers[r];if(s){const i={singleColor:this.canvasModel.idToColor(t.id),forceBold:7};s.draw(e,t.getSeriesInViewport(t.scaleModel.xStart-1,t.scaleModel.xEnd+1),t,i)}}}getCanvasIds(){return[this.canvasModel.canvasId]}}const Bs=1;function nn(n,e){return e===n?"none":e>n?"up":"down"}function Yl(n,e){return e>n?"up":"down"}function Hl(n,e,t=!1){const{expansion:r,impVolatility:s,vwap:i,volume:a,timestamp:o}=n;let l=n.hi,c=n.lo,u=n.open;const g=n.close;t&&(l=g,c=g,u=g);let b=n.idx;return e!==void 0&&(b=e),{hi:l,lo:c,open:u,close:g,timestamp:o,volume:a,expansion:r,idx:b,impVolatility:s,vwap:i}}class rn{constructor(e,t,r,s,i,a,o,l,c=!1,u=!1,g=!1){this.centerUnit=e,this.startUnit=e-t/2,this.width=t,this.open=r,this.close=s,this.high=i,this.low=a,this.name=o,this.candle=l,this.hasBorder=c,this.isActive=u,this.isHollow=g}bodyHeight(e){return ie(Math.abs(e.toY(this.open)-e.toY(this.close)))}candleHeight(e){return ie(Math.abs(e.toY(this.high)-e.toY(this.low)))}bodyAsVLine(e){if(this.width<2)return[this.centerUnit,this.yLineStart(e),this.width,this.candleHeight(e)]}bodyRect(e){return[this.startUnit,this.yBodyStart(e),this.width,this.bodyHeight(e)]}getCandle(){return this.candle}yBodyKeyPoints(e){const t=ie(e.toY(this.high)),r=ie(e.toY(this.low)),s=ie(e.toY(this.open)),i=ie(e.toY(this.close)),[a,o]=s>i?[i,s]:[s,i],[l,c]=t>r?[r,t]:[t,r];return[l,a,o,c]}yLineEnd(e){return ie(Math.max(e.toY(this.high),e.toY(this.low)))}yLineStart(e){return ie(Math.min(e.toY(this.high),e.toY(this.low)))}yBodyStart(e){return ie(Math.min(e.toY(this.open),e.toY(this.close)))}yBodyEnd(e){return ie(Math.max(e.toY(this.open),e.toY(this.close)))}xCenter(e){return ie(e.toX(this.centerUnit))}xStart(e){return _l(e.toX(this.startUnit))}}const Rs=(n,{x:e,width:t,activeCandle:r})=>new rn(e,t,n.open,n.close,n.hi,n.lo,nn(n.open,n.close),n,!0,Jn(n,r)),kl=(n,{x:e,width:t,activeCandle:r,prevCandle:s})=>{var i;return new rn(e,t,n.open,n.close,n.hi,n.lo,Yl((i=s==null?void 0:s.close)!=null?i:n.close,n.close),n,!0,Jn(n,r),n.close>n.open)},Ul=(n,{x:e,width:t,activeCandle:r,prevCandle:s})=>{var i;return new rn(e,t,n.open,n.close,n.hi,n.lo,nn((i=s==null?void 0:s.close)!=null?i:n.close,n.close),n,!0,Jn(n,r),n.close>n.open)},Jn=(n,e)=>{const t=e&&e.idx===n.idx;return t!=null?t:!1},Fs=()=>Bs;var zl=Object.defineProperty,Wl=Object.defineProperties,Xl=Object.getOwnPropertyDescriptors,Ns=Object.getOwnPropertySymbols,Vl=Object.prototype.hasOwnProperty,jl=Object.prototype.propertyIsEnumerable,Ys=(n,e,t)=>e in n?zl(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Gl=(n,e)=>{for(var t in e||(e={}))Vl.call(e,t)&&Ys(n,t,e[t]);if(Ns)for(var t of Ns(e))jl.call(e,t)&&Ys(n,t,e[t]);return n},Zl=(n,e)=>Wl(n,Xl(e));const $l=n=>({isHighLowActive:()=>!0,calculateHighLow:e=>{const t=e?e.xStart:n.scaleModel.xStart,r=e?e.xEnd:n.scaleModel.xEnd,{dataIdxStart:s,dataIdxEnd:i}=n.calculateDataViewportIndexes(t,r),a=n.visualPoints.slice(s,i+1),o=Hs(a),l=()=>{var c,u;return(u=(c=n.visualPoints[s])==null?void 0:c.close)!=null?u:1};return Zl(Gl({},o),{low:n.view.toAxisUnits(o.low,l),high:n.view.toAxisUnits(o.high,l)})}}),Hs=n=>{const e={high:Number.NEGATIVE_INFINITY,low:Number.POSITIVE_INFINITY,highIdx:0,lowIdx:0};for(let t=0;t<n.length;t++){const r=n[t];r.high>e.high&&(e.high=r.high,e.highIdx=t),r.low<e.low&&(e.low=r.low,e.lowIdx=t)}return e},ks={color:"#FF00FF",lineWidth:1,hoveredLineWidth:2},Us={paintConfig:[ks],type:"LINEAR",highLowActive:!0,visible:!0,labelLastValue:"viewport",labelMode:"label",labelAppearanceType:"badge"};var Kl=Object.defineProperty,zs=Object.getOwnPropertySymbols,ql=Object.prototype.hasOwnProperty,Jl=Object.prototype.propertyIsEnumerable,Ws=(n,e,t)=>e in n?Kl(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ql=(n,e)=>{for(var t in e||(e={}))ql.call(e,t)&&Ws(n,t,e[t]);if(zs)for(var t of zs(e))Jl.call(e,t)&&Ws(n,t,e[t]);return n};class ec{constructor(e,t,r){this.series=e,this.config=t,this.yAxisBoundsProvider=r}getUnorderedLabels(){if(this.config.visible){const t=this.config.labelLastValue==="series"?this.series.getLastDataSeriesPoint:this.series.getLastVisualSeriesPoint,r=[],s=this.yAxisBoundsProvider(),i=this.config.labelMode,a=this.config.labelAppearanceType,o=t();if(o!==void 0){const l=this.series.view.toY(o.close),c=this.series.valueFormatter(o.close),u=this.getLabelDrawConfig();return r.push(Ql({y:l,description:this.series.name,mode:i,labelType:a,labelText:c},u)),[{labels:[...r],bounds:s}]}}return[]}getLabelDrawConfig(){var e;const t=this.series.config,s=((e=t.paintConfig[0])!=null?e:ks).color;return{textColor:Yn(s,"white","black"),bgColor:s,paddingBottom:t.labelPaddingBottom,paddingEnd:t.labelPaddingEnd,paddingTop:t.labelPaddingTop}}}const sn=n=>JSON.parse(JSON.stringify(n));function Qn(n){return Object.entries(n)}class tc{constructor(e,t){this.scaleModel=e,this.dataSeries=t,this.prevAnimationId=""}getBaselineForPercent(e){const t=this.scaleModel.currentAnimation;let r;if(t!=null&&t.animationInProgress){t.id!==this.prevAnimationId&&(this.initialBaseline=void 0,this.targetBaseline=void 0,this.prevAnimationId=t.id);const s=t.easingFn(t.getProgress());this.initialBaseline===void 0&&(this.initialBaseline=e(ot(this.dataSeries.visualPoints,t.xStart,i=>i.centerUnit).index)),this.targetBaseline===void 0&&(this.targetBaseline=e(ot(this.dataSeries.visualPoints,t.animationConfig.targetXStart,i=>i.centerUnit).index)),r=this.initialBaseline+(this.targetBaseline-this.initialBaseline)*s}else r=e();return r}}class nc{constructor(e,t,r,s){this.dataSeries=e,this.scaleModel=t,this.getAxisType=r,this.getBaseLine=s,this.toY=i=>this.scaleModel.toY(this.toAxisUnits(i)),this.toX=i=>this.scaleModel.toX(i),this.xPixels=i=>this.scaleModel.xPixels(i),this.yPixels=i=>this.scaleModel.yPixels(i),this.percentAnimationHandler=new tc(this.scaleModel,this.dataSeries)}toAxisUnits(e,t=this.getBaseLine){switch(this.getAxisType()){case"percent":const r=this.percentAnimationHandler.getBaselineForPercent(t);return xs(e,r);case"logarithmic":return Ts(e);case"regular":return e}}priceFromY(e){const t=this.scaleModel.fromY(e);return this.fromAxisUnits(t)}fromAxisUnits(e){switch(this.getAxisType()){case"percent":return Ps(e,this.getBaseLine());case"logarithmic":return $n(e);case"regular":return e}}}var rc=Object.defineProperty,sc=Object.defineProperties,ic=Object.getOwnPropertyDescriptors,Xs=Object.getOwnPropertySymbols,ac=Object.prototype.hasOwnProperty,oc=Object.prototype.propertyIsEnumerable,Vs=(n,e,t)=>e in n?rc(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,lc=(n,e)=>{for(var t in e||(e={}))ac.call(e,t)&&Vs(n,t,e[t]);if(Xs)for(var t of Xs(e))oc.call(e,t)&&Vs(n,t,e[t]);return n},cc=(n,e)=>sc(n,ic(e));class js extends ee{constructor(e,t,r=sn(Us)){super(),this.paneComponent=e,this.id=t,this.name="",this.hovered=!1,this._dataPoints=[],this.pricePrecisions=[.01],this.linkedDataSeriesModels=[],this._dataPointsFlat=[],this._visualPoints=[],this._visualPointsFlat=[],this.dataIdxStart=0,this.dataIdxEnd=0,this.getPaintConfig=s=>{var i;return(i=this.config.paintConfig[s])!=null?i:this.config.paintConfig[0]},this.getBaseLine=(s=this.dataIdxStart)=>{var i,a;return(a=(i=this.visualPoints[s])==null?void 0:i.close)!=null?a:1},this.getTextForPoint=s=>`${s.close}`,this.getLastVisualSeriesPoint=()=>{const s=this.visualPoints,i=ot(s,this.scaleModel.xEnd,a=>a.centerUnit).index;return s[i]},this.getLastDataSeriesPoint=()=>{const s=this.visualPoints;return Ue(s)},this.config=He(r,Us),this.scaleModel=e.scaleModel,this.view=new nc(this,this.scaleModel,()=>this.paneComponent.getAxisType(),this.getBaseLine),this.yAxisLabelProvider=new ec(this,this.config,e.getYAxisBounds),this.highLowProvider=uc(this),e.addDataSeries(this),this.addRxSubscription(this.scaleModel.xChanged.subscribe(()=>this.recalculateDataViewportIndexes())),this.addRxSubscription(this.scaleModel.scaleInversedSubject.subscribe(()=>this.recalculateVisualPoints()))}get dataPoints2D(){return this._dataPoints}get dataPoints(){return this._dataPointsFlat}set dataPoints(e){this._dataPoints=Xr(e),this._dataPointsFlat=this._dataPoints.flat(),this.visualPoints=this._toVisualPoints(this._dataPoints)}get visualPoints(){return this._visualPointsFlat}get visualPoints2D(){return this._visualPoints}set visualPoints(e){this._visualPoints=Xr(e),this._visualPointsFlat=this._visualPoints.flat()}_toVisualPoints(e){return e.map(t=>this.toVisualPoints(t))}toVisualPoints(e){return e.map((t,r)=>({centerUnit:r,close:t.close}))}recalculateVisualPoints(){this.visualPoints=this._toVisualPoints(this.dataPoints2D)}recalculateDataViewportIndexes(e=this.scaleModel.xStart,t=this.scaleModel.xEnd){const{dataIdxStart:r,dataIdxEnd:s}=this.calculateDataViewportIndexes(e,t);this.dataIdxStart=r,this.dataIdxEnd=s}calculateDataViewportIndexes(e,t){const r=ot(this.visualPoints,e,i=>i.centerUnit).index,s=ot(this.visualPoints,t,i=>i.centerUnit).index;return{dataIdxStart:r,dataIdxEnd:s}}valueFormatter(e){return er(e)}getSeriesInViewport(e,t){let r=this.dataIdxStart,s=this.dataIdxEnd;if(t!==void 0&&e!==void 0){const i=this.calculateDataViewportIndexes(e,t);r=i.dataIdxStart,s=i.dataIdxEnd}return oo(this.visualPoints2D,r,s)}}const hc=n=>{const e={high:Number.NEGATIVE_INFINITY,low:Number.POSITIVE_INFINITY,highIdx:0,lowIdx:0};for(let t=0;t<n.length;t++){const r=n[t];r.close>e.high&&(e.high=r.close,e.highIdx=t),r.close<e.low&&(e.low=r.close,e.lowIdx=t)}return e},uc=n=>({isHighLowActive:()=>n.config.highLowActive,calculateHighLow:e=>{const t=hc(n.getSeriesInViewport(e==null?void 0:e.xStart,e==null?void 0:e.xEnd).flat());return cc(lc({},t),{high:n.view.toAxisUnits(t.high),low:n.view.toAxisUnits(t.low)})}}),er=n=>{const t=i=>Math.ceil(Math.log(Math.abs(i))*Math.LOG10E),s=((i,a=5)=>Math.max(0,a-Math.max(0,t(i))))(n);return ge.makeDecimal(n,s)},dc=30,fc=(n,e,t)=>{const r=n.startViewportMovementAnimation(e,{duration:dc,targetXStart:t.xStart,targetXEnd:t.xEnd,targetYStart:t.yStart,targetYEnd:t.yEnd,targetZoomX:t.zoomX,targetZoomY:t.zoomY});e.currentAnimation=r};class vc{constructor(e,t){this.delegate=e,this.auto=!0,this.highLowPostPorcessor={},this.highLowProviders=t!=null?t:{}}setHighLowProvider(e,t){this.highLowProviders[e]=t}deleteHighLowProvider(e){delete this.highLowProviders[e]}setHighLowPostProcessor(e,t){this.highLowPostPorcessor[e]=t}setAutoAndRecalculateState(e,t){this.auto=t,t&&gc(this.delegate,e,Object.values(this.highLowProviders),Object.values(this.highLowPostPorcessor))}}const gc=(n,e,t,r)=>{const s=t.filter(o=>o.isHighLowActive()).map(o=>o.calculateHighLow(e)),i=Gs(s),a=r.reduce((o,l)=>l(o),i);e.yStart=a.low,e.yEnd=a.high,e.zoomY=n.calculateZoomY(e.yStart,e.yEnd)};function Gs(n){if(n.length===0)return pc();let e=n[0].high,t=n[0].low;return n.forEach(r=>{isFinite(r.high)&&r.high>=e&&(e=r.high),isFinite(r.low)&&r.low<=t&&(t=r.low)}),{low:t,high:e}}const pc=()=>({high:Number.NEGATIVE_INFINITY,low:Number.POSITIVE_INFINITY});var mc=Object.defineProperty,Zs=Object.getOwnPropertySymbols,bc=Object.prototype.hasOwnProperty,wc=Object.prototype.propertyIsEnumerable,$s=(n,e,t)=>e in n?mc(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ks=(n,e)=>{for(var t in e||(e={}))bc.call(e,t)&&$s(n,t,e[t]);if(Zs)for(var t of Zs(e))wc.call(e,t)&&$s(n,t,e[t]);return n};const Cc=(n,e,t,r)=>{var s,i,a,o;const l=Ks({},n),c=(i=(s=e[t])==null?void 0:s.startUnit)!=null?i:0,u=(o=(a=Go(-t,e))==null?void 0:a.startUnit)!=null?o:0;let g=n.xStart,b=n.xEnd;return l.xStart>=u&&(g=u,b=b-(l.xStart-u)),l.xEnd<c&&(g=c-ze(r.width,l.zoomX),b=c),l.xStart=g,l.xEnd=b,l},yc=(n,e,t,r)=>{const s=Ks({},e),i=r(),a=s.xEnd-s.xStart,o=a<t.minCandles,l=i.width/t.minWidth,c=a>l;if(i.width>0){if(c)return s.xStart=s.xEnd-l,s.zoomX=Jt(s.xEnd-s.xStart,i.width),s;if(o)return s.xEnd=n.xEnd,s.xStart=s.xEnd-t.minCandles,s.zoomX=Jt(s.xEnd-s.xStart,i.width),s}return s},Sc=(n,e)=>n/e,Mc=(n,e)=>n/e,Gv=(n,e)=>n*e,qs=(n,e)=>{const t=n.zoomY;n.zoomY=Mc(n.zoomX,e);const r=n.zoomY/t,s=n.yEnd-n.yStart,a=s*r-s;n.yEnd=n.yEnd+a},_c=(n,e)=>{const t=n.xStart;n.xStart=e,n.xEnd=n.xEnd+(e-t)},xc=(n,e)=>{const t=n.yStart;n.yStart=e,n.yEnd=n.yEnd+(e-t)},Js=(n,e,t,r,s)=>{const i=(e.xEnd-e.xStart)*r,a=i*t,o=i*(1-t);return s?(e.xStart=e.xStart+a,e.xEnd=e.xEnd-o):(e.xStart=e.xStart-a,e.xEnd=e.xEnd+o),e.zoomX=n.calculateZoomX(e.xStart,e.xEnd),e},Pc=(n,e,t,r)=>Js(n,e,1,t,r);var Tc=Object.defineProperty,Qs=Object.getOwnPropertySymbols,Ac=Object.prototype.hasOwnProperty,Ec=Object.prototype.propertyIsEnumerable,ei=(n,e,t)=>e in n?Tc(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,an=(n,e)=>{for(var t in e||(e={}))Ac.call(e,t)&&ei(n,t,e[t]);if(Qs)for(var t of Qs(e))Ec.call(e,t)&&ei(n,t,e[t]);return n};const Dc=()=>({high:Number.NEGATIVE_INFINITY,low:Number.POSITIVE_INFINITY,highIdx:0,lowIdx:0});class ti extends yl{constructor(e,t,r){super(),this.config=e,this.getBounds=t,this.canvasAnimation=r,this.scaleInversedSubject=new G,this.history=[],this.zoomXYRatio=0,this.xConstraints=[],this.scalePostProcessor=(s,i)=>this.xConstraints.reduce((a,o)=>o(s,a),i),this.state=sn(e.scale),this.autoScaleModel=new vc(this),this.offsets=this.config.components.offsets,this.addXConstraint((s,i)=>yc(s,i,this.config.components.chart,this.getBounds))}addXConstraint(e){this.xConstraints=[...this.xConstraints,e]}updateOffsets(e){this.offsets=an(an({},this.offsets),e),this.doAutoScale(!0)}getOffsets(){return this.offsets}zoomXToPercent(e,t,r=!1,s=this.config.scale.zoomSensitivity){this.haltAnimationIfNeeded();const i=this.export();Js(this,i,e,s,t),this.zoomXTo(i,r)}zoomXToEnd(e,t=this.config.scale.zoomSensitivity){this.haltAnimationIfNeeded();const r=this.export();Pc(this,r,t,e),this.zoomXTo(r)}haltAnimationIfNeeded(){var e;(e=this.currentAnimation)!=null&&e.animationInProgress&&this.config.components.yAxis.type==="percent"&&(this.currentAnimation.finishAnimation(),this.doAutoScale())}zoomXTo(e,t){const r=an({},e),s=this.scalePostProcessor(r,e);this.state.lockPriceToBarRatio&&qs(s,this.zoomXYRatio),this.state.auto&&this.autoScaleModel.setAutoAndRecalculateState(s,!0),t?this.apply(s):fc(this.canvasAnimation,this,s)}setXScale(e,t){const r=this.export();super.setXScale(e,t,!1);const s=this.export(),i=this.scalePostProcessor(r,s);this.state.lockPriceToBarRatio&&qs(i,this.zoomXYRatio),this.state.auto&&this.autoScaleModel.setAutoAndRecalculateState(i,!0),this.apply(i)}moveXStart(e){const t=this.export(),r=an({},t);_c(t,e);const s=this.scalePostProcessor(r,t);this.state.auto&&this.autoScaleModel.setAutoAndRecalculateState(s,!0),this.apply(s)}moveYStart(e){if(!this.state.auto){const t=this.export();xc(t,e),this.apply(t)}}doAutoScale(e=!1){if(!this.isViewportAnimationInProgress()&&this.state.auto||e){const t=this.export();this.autoScaleModel.setAutoAndRecalculateState(t,!0),Sl(t,this.export())||this.apply(t)}}isViewportAnimationInProgress(){const e=this.currentAnimation;return e==null?void 0:e.animationInProgress}pushToHistory(e){this.history.push(e)}popFromHistory(){return this.history.pop()}clearHistory(){this.history=[]}isDefaultXBounds(){return this.xStart===0&&this.xEnd===0}isDefaultYBounds(){return this.yStart===0&&this.yEnd===0}isScaleReady(){return!this.isDefaultXBounds()&&!this.isDefaultYBounds()}autoScale(e=!0){this.config.components.yAxis.type==="percent"?this.state.auto=!0:this.state.auto=e,e&&(this.clearHistory(),this.doAutoScale())}setLockPriceToBarRatio(e=!1){const{type:t}=this.config.components.yAxis;if(t==="percent"||t==="logarithmic"){this.state.lockPriceToBarRatio=!1;return}e&&this.recalculateZoomXYRatio(),this.state.lockPriceToBarRatio=e}recalculateZoomXYRatio(){this.zoomXYRatio=Sc(this.zoomX,this.zoomY)}}class Lc extends ti{constructor(e,t,r,s){super(t,r,s),this.delegate=e,this.config=t,this.getBounds=r}doActivate(){this.addRxSubscription(this.delegate.xChanged.subscribe(()=>this.doAutoScale(this.state.auto)))}get xStart(){return this.delegate.xStart}set xStart(e){this.delegate.xStart=e}get xEnd(){return this.delegate.xEnd}set xEnd(e){this.delegate.xEnd=e}get zoomX(){return this.delegate.zoomX}set zoomX(e){this.delegate.zoomX=e}observeXChanged(){return this.delegate.xChanged}fireChanged(){this.delegate.changed.next(),this.changed.next()}}const pt=class{static autoDetectIncrementOfValueRange(n){const e=this.getDigitsInNumber(n);return n===0?.01:Math.pow(10,e-3)}static getDigitsInNumber(n){const e=r=>we(Math.log10((r^r>>31)-(r>>31)))+1;let t=e(n);return t===1&&n<1&&(t=e(n*1e9)-9),t}static getPriceIncrement(n,e){var t;const r=(t=e.priceIncrements)!=null?t:[];if(!this.validatePriceIncrementsOrPrecisions(r))return this.DEFAULT_INCREMENT;if(isNaN(n))return Math.round(r[0]);n=Math.abs(n);let s=1;const i=1e-6;for(;s<r.length&&n>r[s]+Math.min(r[s-1],r[s+1])*i;)s+=2;return s>=r.length||n<r[s]-Math.min(r[s-1],r[s+1])*i?r[s-1]:Math.min(r[s-1],r[s+1])}static getPricePrecision(n,e){if(!this.validatePriceIncrementsOrPrecisions(e))return 0;if(isNaN(n))return Math.round(e[0]);n=Math.abs(n);let t=1;for(;t<e.length&&n>e[t];)t+=2;return Math.round(e[t-1])}static roundPriceToIncrement(n,e,t){const r=pt.getPriceIncrement(t||n,e);return ge.roundToNearest(n,r)}static computePrecisions(n){const e=[...n];for(let t=0;t<n.length;t+=2)e[t]=pt.calculatePrecision(n[t]);for(let t=1;t<n.length;t+=2)e[t]=n[t]+Math.min(n[t-1],n[t+1])*pt.RELATIVE_EPS;return e}static calculatePrecision(n){let e=n>1?Math.abs(Math.floor(n)-n):n;for(let t=0;t<pt.MAXIMUM_PRECISION;t++){const r=Math.floor(e+.5),s=Math.abs(e*pt.RELATIVE_EPS);if(r>=e-s&&r<=e+s)return t;e*=10}return pt.MAXIMUM_PRECISION}static validatePriceIncrementsOrPrecisions(n){return!(n.length===0||!Array.isArray(n)||n.findIndex(e=>e!==0)===-1)}};let Ie=pt;Ie.DEFAULT_INCREMENT=.01,Ie.DEFAULT_PRECISION=2,Ie.RELATIVE_EPS=1e-8,Ie.MAXIMUM_PRECISION=10;const Ic=Gt().colors;class lt extends js{constructor(e,t,r,s,i,a,o,l=Ic){super(e,t),this.eventBus=r,this.candlesTransformersByChartType=a,this.candleWidthByChartType=o,this.colors=l,this.zippedHighLow=Dc(),this.lastPriceMovement="none",this.lastVisualCandleChangedSubject=new G,this.meanCandleWidth=Bs,this._instrument=i,this.instrument=i,this.highLowProvider=$l(this),this.scaleModel=s,this.name=i.symbol}get dataPoints(){return super.dataPoints}set dataPoints(e){super.dataPoints=e,this.applyPriceMovement()}get instrument(){return this._instrument}set instrument(e){var t;this._instrument=e,this.pricePrecisions=Ie.computePrecisions((t=e.priceIncrements)!=null?t:[.01])}recalculateDataViewportIndexes(e=this.scaleModel.xStart,t=this.scaleModel.xEnd){super.recalculateDataViewportIndexes(e,t),this.recalculateZippedHighLow(),this.eventBus.fireDraw()}applyPriceMovement(){const e=Ue(this.dataPoints);e&&(this.lastPriceMovement=nn(e.open,e.close))}recalculateVisualPoints(){super.recalculateVisualPoints(),this.recalculateMeanCandleWidth(this.visualPoints)}recalculateZippedHighLow(){return this.zippedHighLow=Hs(this.visualPoints.slice(this.dataIdxStart,this.dataIdxEnd))}updateCurrentPrice(e){this.previousPrice=this.currentPrice||e,this.currentPrice=e,this.currentPrice!==this.previousPrice&&(this.lastPriceMovement=this.currentPrice>this.previousPrice?"up":"down")}updateCandleSeriesColors(e){this.colors=He(e,this.colors),this.recalculateVisualPoints()}observeLastVisualCandleChanged(){return this.lastVisualCandleChangedSubject.asObservable()}doDeactivate(){super.doDeactivate()}toVisualPoints(e,t=0){var r,s;if(e.length===0)return[];const i=this.config.type,a=[];let o=t;const l=(r=this.candleWidthByChartType[i])!=null?r:Fs;for(let c=0;c<e.length;c++){const u=e[c],g=e[c-1],b=l(u),P=o+b/2,I=(s=this.candlesTransformersByChartType[i])!=null?s:Rs;a.push(I(u,{x:P,width:b,prevCandle:g,activeCandle:this.activeCandle})),o+=b}return a}recalculateMeanCandleWidth(e){this.meanCandleWidth=e.reduce((t,r)=>t+r.width,0)/e.length}setActiveCandle(e){this.activeCandle=e,this.recalculateVisualPoints()}clearData(){this.dataPoints=[],this.clearVisualCandles(),this.clearPrices()}clearPrices(){this.previousPrice=void 0,this.currentPrice=void 0,this.lastPriceMovement="none"}clearVisualCandles(){this.visualPoints=[]}}function Zv(n){switch(n){case"line":case"area":return!0;default:return!1}}class Oc{constructor(e){this.config=e}draw(e,t,r,s){if(r instanceof lt){const i=t.flat();if(i.length===0)return;s.singleColor?e.strokeStyle=s.singleColor:e.strokeStyle=r.colors.areaTheme.lineColor,r.hovered?e.lineWidth=this.config.selectedWidth:e.lineWidth=this.config.areaLineWidth;const a=r.paneComponent.getBounds(),o=i[0],l=r.view.toX(o.centerUnit);for(let c=0;c<i.length;c++){const u=i[c-1],g=i[c+1],b=i[c],P=r.view.toX(b.centerUnit),I=r.view.toY(b.close),Y=a.y+a.height;if(u===void 0)e.beginPath(),e.lineTo(we(P),Y),e.moveTo(we(P),I);else if(g===void 0){e.lineTo(we(P),I),e.stroke(),e.lineTo(we(P),Y),e.lineTo(we(l),Y),e.closePath();let k;s.singleColor?e.fillStyle=s.singleColor:e.fillStyle=r.colors.areaTheme.startColor&&r.colors.areaTheme.stopColor?(k=e.createLinearGradient(0,0,0,a.height),k.addColorStop(0,r.colors.areaTheme.startColor),k.addColorStop(1,r.colors.areaTheme.stopColor),k):"",e.fill()}else e.lineTo(we(P),I)}}}}function tr(n,e,t,r,s,i=4,a=!0,o=!1){n.save(),n.beginPath(),n.moveTo(e+i,t),n.lineTo(e+r-i,t),n.quadraticCurveTo(e+r,t,e+r,t+i),n.lineTo(e+r,t+s-i),n.quadraticCurveTo(e+r,t+s,e+r-i,t+s),n.lineTo(e+i,t+s),n.quadraticCurveTo(e,t+s,e,t+s-i),n.lineTo(e,t+i),n.quadraticCurveTo(e,t,e+i,t),n.closePath(),a&&n.fill(),o&&n.stroke(),n.restore()}function Bc(n,e,t,r,s,i,a,o,l,c,u=4,g=!0,b=!1){const P=c==="right"?o:-o,I=c==="right"?u:-u,Y=u;n.save(),n.beginPath(),l?n.moveTo(i+I,a):n.moveTo(i,a),l?(n.lineTo(i+P-I,a),n.quadraticCurveTo(i+P,a,i+P,a-Y),n.lineTo(i+P,t+Y),n.quadraticCurveTo(i+P,t,i+P-I,t),n.lineTo(e+I,t)):(n.lineTo(i+P,a),n.lineTo(i+P,t),n.lineTo(e,t)),l?(n.quadraticCurveTo(e,t,e-I/3,t+Y/3),n.lineTo(r+I/3,s-Y/3),n.quadraticCurveTo(r,s,r+I/3,s+Y/3),n.lineTo(i-I/3,a-Y/3),n.quadraticCurveTo(i,a,i+I/3,a)):(n.lineTo(r,s),n.lineTo(i,a)),n.closePath(),g&&n.fill(),b&&n.stroke(),n.restore()}function Rc(n,e,t,r,s,i=1){n.save(),n.lineWidth=i,n.beginPath(),n.moveTo(e,t),n.lineTo(r,s),n.stroke(),n.closePath(),n.restore()}function mt(n,e){n.save(),n.lineWidth%2&&n.translate(.5,.5),e(),n.restore()}function ni(n,e,t){const r=Math.min(e.x,t.x)+.5,s=Math.min(e.y,t.y),i=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y);n.fillRect(r,s,i,a)}class Fc{constructor(e){this.config=e}setFillStyle(e,t,r,s){if(t.singleColor)e.strokeStyle=t.singleColor;else{const i=r.colors.barTheme;i&&(e.strokeStyle=i[`${s.name}Color`])}}draw(e,t,r,s){if(r instanceof lt){const i=t.flat();_t(e,this.config.barLineWidth,r,s),mt(e,()=>{for(const a of i){this.setFillStyle(e,s,r,a),e.beginPath();const o=ie(r.view.toX(a.centerUnit)),l=ie(r.view.toX(a.startUnit)),[c,u,g,b]=a.yBodyKeyPoints(r.view),P=ie(r.view.xPixels(a.width)/2),I=ie(r.view.toY(a.close)),Y=ie(r.view.toY(a.open));this.config.showWicks?(e.moveTo(o,c),e.lineTo(o,b)):(e.moveTo(o,u),e.lineTo(o,g)),e.moveTo(o,I),e.lineTo(o+P,I),e.moveTo(l,Y),e.lineTo(o,Y),e.stroke()}})}}}class Nc{constructor(e,t){this.baseLineModel=e,this.canvasBoundContainer=t}draw(e,t,r,s){if(s!==void 0&&r instanceof lt){const i=t.flat(),a=this.baseLineModel.baselineYPercents,o=this.canvasBoundContainer.getBounds(B.CHART),l=o.y+o.height*(a/100),c=i[0];for(let u=0;u<i.length;u++){const g=i[u],b=i[u-1],P=i[u+1],I=r.view.toX(c.centerUnit),Y=r.view.toX(g.centerUnit),k=r.view.toY(g.close),U=b?r.view.toY(b.close)<l:!1,W=k<l;if(b!==void 0&&U!==W){ri(e,r,s,U);const q=r.view.toX(b.centerUnit),K=r.view.toY(b.close),Z=Y-q,$=k-K,ae=Z/$,ne=k-l,oe=ae*ne,ce=q+(Z-oe);e.lineTo(ce,l),e.stroke(),e.lineTo(I,l),e.closePath(),e.fill(),e.beginPath(),e.moveTo(ce,l)}b===void 0?(e.beginPath(),e.moveTo(Y,k)):P===void 0?(ri(e,r,s,W),e.lineTo(Y,k),e.stroke(),e.lineTo(Y,l),e.lineTo(I,l),e.closePath(),e.fill(),e.beginPath(),e.moveTo(I,l),e.lineTo(Y,l),e.strokeStyle=r.colors.baseLineTheme.baselineColor,e.stroke()):e.lineTo(Y,k)}}}}const ri=(n,e,t,r)=>{t.singleColor?(n.fillStyle=t.singleColor,n.strokeStyle=t.singleColor):(n.fillStyle=r?e.colors.baseLineTheme.upperSectionFillColor:e.colors.baseLineTheme.lowerSectionFillColor,n.strokeStyle=r?e.colors.baseLineTheme.upperSectionStrokeColor:e.colors.baseLineTheme.lowerSectionStrokeColor)};class Yc{constructor(e){this.config=e,this.pixelLength=1,this.lineWidthCU=1,this.halfLineWidthCU=1}draw(e,t,r,s){if(r instanceof lt){const i=t.flat();_t(e,this.config.candleLineWidth,r,s,this.config.candleLineWidth),mt(e,()=>{this.pixelLength=1/We,this.halfLineWidthCU=e.lineWidth/2,this.lineWidthCU=e.lineWidth;for(const a of i){const{candleTheme:o,activeCandleTheme:l}=r.colors;o&&l&&this.drawCandle(e,s,r,a)}})}}drawCandle(e,t,r,s){const{candleTheme:i,activeCandleTheme:a}=r.colors,o=s.name,l=s.isActive?a:i,c=s.isHollow;t.singleColor?e.fillStyle=t.singleColor:c?e.fillStyle=l[`${o}WickColor`]:e.fillStyle=l[`${o}Color`];const u=ie(r.view.toX(s.startUnit)),g=ie(r.view.xPixels(s.width)),b=s.bodyHeight(r.view),[P,I,Y,k]=s.yBodyKeyPoints(r.view),U=l[`${o}Color`],W=o==="none"?U:l[`${o}WickColor`];e.fillStyle=U,t.singleColor?e.strokeStyle=t.singleColor:e.strokeStyle=W;const q=c||(s.hasBorder&&s.isActive?this.config.showActiveCandlesBorder:this.config.showCandlesBorder),K=this.config.showWicks;if(g<2)e.beginPath(),e.moveTo(u,K?P:I),e.lineTo(u,K?k:Y),e.stroke();else if(g<3)e.beginPath(),e.moveTo(u,K?P:I),e.lineTo(u,K?k:Y),e.moveTo(u+1,I),e.lineTo(u+1,Y),e.stroke();else if(g===3){const Z=g/We;this.drawCandlesWicks(e,u+Z,P,k,I,Y),c||(e.beginPath(),e.moveTo(u+Z,I),e.lineTo(u+Z,Y),e.stroke()),this.drawCandleBorder(e,t,l,s,u+this.halfLineWidthCU,I+this.halfLineWidthCU,g-this.lineWidthCU,b-this.lineWidthCU)}else{const Z=ie(r.view.toX(s.centerUnit));this.drawCandlesWicks(e,Z,P,k,I,Y-1);const $=this.config.candlePaddingPercent,ae=Math.max(ie(g*$/2),this.pixelLength),ne=u+ae,oe=g-ae*2;c||(t.singleColor&&(e.fillStyle=t.singleColor),e.fillRect(ne,I,oe,b)),q&&this.drawCandleBorder(e,t,l,s,ne+this.halfLineWidthCU,I+this.halfLineWidthCU,oe-this.lineWidthCU,b-this.lineWidthCU)}}drawCandlesWicks(e,t,r,s,i,a){this.config.showWicks&&(e.beginPath(),e.moveTo(t,r),e.lineTo(t,i),e.moveTo(t,a),e.lineTo(t,s),e.stroke())}drawCandleBorder(e,t,r,s,i,a,o,l){if(t.singleColor)e.strokeStyle=t.singleColor;else{const c=s.name;e.strokeStyle=c==="none"?r[`${c}Color`]:r[`${c}WickColor`]}e.strokeRect(i,a,o,l)}}class Hc{constructor(e){this.config=e}draw(e,t,r,s){if(r instanceof lt){const i=t.flat(),a=r.scaleModel.getBounds(),o=a.y+a.height;for(const l of i){e.beginPath();const c=l.name,u=this.config.barCapSize,g=r.colors.histogram;if(g===void 0)return;s.singleColor?e.fillStyle=s.singleColor:e.fillStyle=g[`${c}Bright`];const b=l.xStart(r.view),P=ie(r.view.toY(l.close)),I=ie(r.view.xPixels(l.width));e.fillRect(b,P,I,u);const Y=e.createLinearGradient(0,P+u,0,o);s.singleColor?e.fillStyle=s.singleColor:(Y.addColorStop(0,g[`${c}Cap`]),Y.addColorStop(1,g[`${c}Bottom`]),e.fillStyle=Y),I===0?(e.beginPath(),e.strokeStyle=Y,e.moveTo(b,P+u),e.lineTo(b,o),e.stroke(),e.closePath()):e.fillRect(b,P+u,I,o-P-u)}}}}class kc{constructor(e){this.config=e}draw(e,t,r,s){if(r instanceof lt){const i=t.flat();_t(e,this.config.lineWidth,r,s,this.config.selectedWidth);const a=r.colors.lineTheme;for(let o=1;o<i.length;o++){const l=i[o-1],c=i[o],u=c.name;s.singleColor?e.strokeStyle=s.singleColor:e.strokeStyle=a[`${u}Color`];const g=r.view.toX(l.centerUnit),b=r.view.toY(l.close),P=r.view.toX(c.centerUnit),I=r.view.toY(c.close);e.beginPath(),e.moveTo(g,b),e.lineTo(P,I),e.stroke()}}}}const Uc=1.5;class zc{constructor(e){this.config=e}draw(e,t,r,s){var i;e.fillStyle=(i=s.singleColor)!=null?i:this.config.mainColor;for(const a of t.flat()){e.beginPath();const o=ie(r.view.toX(a.centerUnit)),l=ie(r.view.toY(a.close));e.arc(o,l,Uc,0,Math.PI*2,!0),e.fill()}}}const Wc=["candle","bar","line","area","scatterPlot","hollow","histogram","baseline","trend"];class Xc{constructor(e,t,r){this.drawer=e,this.config=t,this.chartBounds=r}draw(e,t,r,s){this.isChartTypeAllowed()&&(this.beforeDraw(e),this.drawer.draw(e,t,r,s),this.afterDraw(e,r))}beforeDraw(e){e.restore(),e.save(),gt(e,this.chartBounds())}isChartTypeAllowed(){return Wc.includes(this.config.components.chart.type)}afterDraw(e,t){e.restore(),e.save(),gt(e,t.scaleModel.getBounds())}}class Vc{constructor(e){this.chartModel=e}draw(e,t,r,s){t.forEach((i,a)=>{var o;const l=r.getPaintConfig(a);e.fillStyle=(o=s.singleColor)!=null?o:l.color,i.forEach(c=>{const u=this.chartModel.getVisualCandle(Mt(c.centerUnit)),g=c.close;if(u&&g===1){const b=this.chartModel.scaleModel.zoomX,P=ie(Me(u.width,b)),I=ie(u.bodyHeight(this.chartModel.scaleModel)),Y=u.xCenter(this.chartModel.scaleModel)-P/2,k=u.yBodyStart(this.chartModel.scaleModel),U=this.chartModel.config.components.chart.candlePaddingPercent,W=ie(P*U/2),q=Y+W,K=P-W*2;e.fillRect(q,k,K,I)}})})}}const si=(n,e,t)=>{n.length!==0&&n.forEach((r,s)=>{const{centerUnit:i,close:a}=r,o=t.toX(i),l=t.toY(a);s===0?e.moveTo(o,l):e.lineTo(o,l)})};var jc=Object.defineProperty,ii=Object.getOwnPropertySymbols,Gc=Object.prototype.hasOwnProperty,Zc=Object.prototype.propertyIsEnumerable,ai=(n,e,t)=>e in n?jc(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,oi=(n,e)=>{for(var t in e||(e={}))Gc.call(e,t)&&ai(n,t,e[t]);if(ii)for(var t of ii(e))Zc.call(e,t)&&ai(n,t,e[t]);return n};class $c{constructor(){}draw(e,t,r,s){r.config.visible&&(t.forEach((i,a)=>{var o;const l=r.getPaintConfig(a);_t(e,l.lineWidth,r,s,l.hoveredLineWidth);const c=(o=s.singleColor)!=null?o:l.color;e.strokeStyle=c,this.drawLine(e,i,r.view)}),r.linkedDataSeriesModels.forEach((i,a)=>{if(ci(i.config.type)&&ci(r.config.type)&&i.config.visible){const o=[],l=r,c=l.getSeriesInViewport(l.scaleModel.xStart-1,l.scaleModel.xEnd+1),u=i.getSeriesInViewport(i.scaleModel.xStart-1,i.scaleModel.xEnd+1);c.forEach((g,b)=>{const P=Math.min(g.length,u[b].length);for(let k=0;k<P;k++){const U=[oi({},g[k]),oi({},u[b][k])];o.push({diffPoints:U})}const I=l.getPaintConfig(b).color,Y=i.getPaintConfig(a).color;this.drawDifference(e,I,Y,o,l,i,s)})}}))}drawLine(e,t,r){e.beginPath(),si(t,e,r),e.stroke()}drawDifference(e,t,r,s,i,a,o){const[l,c]=[[],[]];s.forEach(b=>{const[P,I]=b.diffPoints;l.push(P),c.push(I)});const u=li(l,i.view),g=li(c,a.view);this.fillCloud(e,r,u,g,o),this.fillCloud(e,t,g,u,o)}fillCloud(e,t,r,s,i){var a,o,l,c;e.save(),e.beginPath();const u=(o=(a=Ot(r))==null?void 0:a.x)!=null?o:0,g=(c=(l=Ue(r))==null?void 0:l.x)!=null?c:0;e.lineTo(u,0),r.forEach(b=>{e.lineTo(b.x,b.y)}),e.lineTo(g,0),e.closePath(),e.clip(),e.beginPath(),r.forEach((b,P)=>{P===0?e.moveTo(b.x,b.y):e.lineTo(b.x,b.y)}),s.slice().reverse().forEach(b=>{e.lineTo(b.x,b.y)}),e.closePath(),e.fillStyle=i.singleColor?i.singleColor:Mo(t||"#383838",.3),e.fill(),e.restore()}}const li=(n,e)=>n.map(t=>{const{centerUnit:r,close:s}=t,i=e.toX(r),a=e.toY(s);return{x:i,y:a}}),ci=n=>n==="DIFFERENCE";class Kc{constructor(){}draw(e,t,r,s){const i=r.view.toY(0);t.forEach((a,o)=>{var l;const c=r.getPaintConfig(o);_t(e,c.lineWidth,r,s,c.hoveredLineWidth),e.strokeStyle=(l=s.singleColor)!=null?l:c.color,e.beginPath(),a.forEach(u=>{const g=r.view.toX(u.centerUnit),b=r.view.toY(u.close);e.moveTo(g,we(i)),e.lineTo(g,we(b))}),e.stroke()})}}class qc{constructor(){}draw(e,t,r,s){t.forEach((i,a)=>{var o;const l=r.getPaintConfig(a);_t(e,l.lineWidth,r,s,l.hoveredLineWidth),e.strokeStyle=(o=s.singleColor)!=null?o:l.color,this.drawLinePath(e,i,r.view)})}drawLinePath(e,t,r){e.beginPath(),si(t,e,r),e.stroke()}}class Jc{constructor(){}draw(e,t,r,s){t.forEach((i,a)=>{var o;const l=r.getPaintConfig(a),c=l.lineWidth;e.fillStyle=(o=s.singleColor)!=null?o:l.color,e.lineWidth=1,i.forEach(u=>{e.beginPath();const g=r.view.toX(u.centerUnit),b=r.view.toY(u.close);e.arc(g,b,c,0,Math.PI*2),e.fill()})})}}class Qc{constructor(e){this.config=e}draw(e,t,r,s){e.save(),t.forEach((i,a)=>{var o;const l=r.getPaintConfig(a);e.fillStyle=(o=s.singleColor)!=null?o:l.color;const c=l.lineWidth+"px "+this.config.components.yAxis.fontFamily;e.font=c,i.forEach(u=>{const g=r.getTextForPoint(u),b=Ke(g,e,c),P=at(c,e),I=r.view.toX(u.centerUnit)-b/2,Y=r.view.toY(u.close)+P;e.fillText(g,I,Y)})}),e.restore()}}class eh{constructor(){}draw(e,t,r,s){t.forEach((i,a)=>{var o;const l=r.getPaintConfig(a);e.fillStyle=(o=s.singleColor)!=null?o:l.color,i.forEach(c=>{const u=r.view.toX(c.centerUnit),g=r.view.toY(c.close);this.drawCandleTriangle(e,u,g,l.lineWidth)})})}drawCandleTriangle(e,t,r,s){e.beginPath(),e.moveTo(t-s/2,r),e.lineTo(t,r-s),e.lineTo(t+s/2,r),e.fill()}}const hi={disableChartPanning:!0};class ui extends ee{constructor(e,t,r,s,i){super(),this.hitTest=e,this.dragCallbacks=t,this.canvasInputListener=r,this.chartPanComponent=s,this.dragComponentOptions=i,this.dragging=!1,this.draggedPixels=0,this.onDragStart=a=>{this.dragging=!0,this.draggedPixels=0,this.dragCallbacks.onDragStart&&this.dragCallbacks.onDragStart(a),this.dragComponentOptions.disableChartPanning&&this.chartPanComponent.deactivatePanHandlers()},this.onDragTick=a=>{this.dragging&&(this.draggedPixels+=a,this.dragCallbacks.onDragTick({delta:a,draggedPixels:this.draggedPixels}))},this.onDragEnd=()=>{this.dragging&&(this.dragging=!1,this.dragCallbacks.onDragEnd&&this.dragCallbacks.onDragEnd(this.draggedPixels),this.dragComponentOptions.disableChartPanning&&this.chartPanComponent.activateChartPanHandlers())}}doActivate(){super.doActivate()}doDeactivate(){super.doDeactivate()}}class on extends ui{constructor(e,t,r,s,i=hi){super(e,t,r,s,i)}doActivate(){super.doActivate(),this.addRxSubscription(this.canvasInputListener.observeYDragStart(this.hitTest).subscribe(this.onDragStart)),this.addRxSubscription(this.canvasInputListener.observeYDrag().subscribe(this.onDragTick)),this.addRxSubscription(this.canvasInputListener.observeYDragEnd().subscribe(this.onDragEnd))}doDeactivate(){super.doDeactivate()}}const th="BASELINE_RESIZER";class nh extends ee{constructor(e,t,r,s,i,a,o){super(),this.chartModel=e,this.canvasModel=r,this.canvasInputListener=s,this.config=i,this.canvasBoundContainer=a,this.cursorHandler=o,this.resizerBounds={x:0,y:0,pageX:0,pageY:0,height:0,width:0},this.baselineYPercents=50,this.ht=Xn.hitTestOf(this.resizerBounds,{extensionY:this.config.components.paneResizer.dragZone}),this.dragTickCb=c=>{const{delta:u}=c,g=this.canvasBoundContainer.getBounds(B.CHART),b=this.canvasInputListener.getCurrentPoint().y;u!==0&&sl(b,g)&&(this.moveBaseLine(b),this.canvasModel.fireDraw())};const l=new on(this.ht,{onDragTick:this.dragTickCb},s,t);this.addChildEntity(l)}doActivate(){super.doActivate(),this.addRxSubscription(this.canvasBoundContainer.observeBoundsChanged(B.CHART).subscribe(()=>this.recalculateBounds())),this.chartModel.chartTypeChanged.subscribe(e=>{e==="baseline"?this.cursorHandler.setCursorTypeForBounds("BASELINE_RESIZER",this.resizerBounds,this.config.components.baseline.cursor,this.config.components.baseline.dragZone):this.cursorHandler.extensionLayer.delete("BASELINE_RESIZER")})}recalculateBounds(){const e=this.canvasBoundContainer.getBounds(B.CHART),t=this.canvasBoundContainer.getBounds(B.Y_AXIS);this.resizerBounds.x=e.x,this.resizerBounds.width=e.width+t.width,this.resizerBounds.height=this.config.components.baseline.height;const r=e.y+e.height*(this.baselineYPercents/100);this.resizerBounds.y=r,this.canvasBoundContainer.bounds[th]=this.resizerBounds}moveBaseLine(e){const t=this.canvasBoundContainer.getBounds(B.CHART);this.baselineYPercents=(e-t.y)*100/t.height,this.resizerBounds.y=e}doDeactivate(){super.doDeactivate()}}const ln=n=>{const e=Ft(n.close,n.open,n.hi,n.lo);if(!isFinite(e))throw new Error("Received candle without any price");const t=Ft(n.hi,Math.max(n.open,n.close),e),r=Ft(n.lo,Math.min(n.open,n.close),e),s=Ft(n.open,n.lo,e),i=Ft(n.close,n.hi,e);return{hi:t,lo:r,open:s,close:i,timestamp:n.timestamp,volume:n.volume,expansion:n.expansion,idx:n.idx,impVolatility:n.impVolatility}},di=n=>{for(let e=0;e<n.length;++e)n[e].idx=e},fi=n=>{n.forEach(e=>{e.idx=void 0})};var rh=Object.defineProperty,vi=Object.getOwnPropertySymbols,sh=Object.prototype.hasOwnProperty,ih=Object.prototype.propertyIsEnumerable,gi=(n,e,t)=>e in n?rh(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ah=(n,e)=>{for(var t in e||(e={}))sh.call(e,t)&&gi(n,t,e[t]);if(vi)for(var t of vi(e))ih.call(e,t)&&gi(n,t,e[t]);return n};class oh{constructor(){this.symbol="MOCK",this.priceIncrements=[.01]}}class lh extends ee{constructor(e,t,r,s,i,a,o,l,c,u,g,b){super(),this.chartModel=e,this.canvasModel=t,this.config=r,this.scaleModel=s,this.canvasBoundsContainer=i,this.drawingManager=a,this.hitTestCanvasModel=o,this.canvasInputListener=l,this.dataSeriesDrawers={},this.strToBarType=I=>{var Y;return(Y=this.barTypeValues.find(k=>k===I))!=null?Y:"candle"},this.addChildEntity(this.chartModel),this.registerDefaultCandlesTransformers(),this.baselineModel=new nh(this.chartModel,u,this.canvasModel,this.canvasInputListener,this.config,this.canvasBoundsContainer,b),this.addChildEntity(this.baselineModel);const P=new Nl(this.dataSeriesDrawers,this.hitTestCanvasModel,g);this.drawingManager.addDrawerBefore(P,jt+"DATA_SERIES",te.HIT_TEST_EVENTS),this.dataSeriesDrawer=new Cl(g,t,this.dataSeriesDrawers),this.drawingManager.addDrawer(this.dataSeriesDrawer,te.DATA_SERIES),this.registerDefaultDataSeriesDrawers(),this.backgroundDrawer=new Fl(c,this.config),a.addDrawer(this.backgroundDrawer,te.MAIN_BACKGROUND),b.addCursorForCanvasEl(B.PANE_UUID(re),r.components.chart.cursor)}doActivate(){super.doActivate()}registerDefaultCandlesTransformers(){this.registerCandlesTransformer("candle",Rs),this.registerCandlesTransformer("trend",Ul),this.registerCandlesTransformer("hollow",kl)}get barTypeValues(){return hs(this.dataSeriesDrawers)}registerCandlesTransformer(e,t){this.chartModel.registerCandlesTransformer(e,t)}registerLastCandleLabelHandler(e,t){this.chartModel.registerLastCandleLabelHandler(e,t)}registerCandlesWidthCalculator(e,t){this.chartModel.registerCandlesWidthCalculator(e,t)}registerDefaultDataSeriesDrawers(){const e=new Yc(this.config.components.chart);this.registerDataSeriesTypeDrawer("candle",e),this.registerDataSeriesTypeDrawer("trend",e),this.registerDataSeriesTypeDrawer("hollow",e),this.registerDataSeriesTypeDrawer("bar",new Fc(this.config.components.chart)),this.registerDataSeriesTypeDrawer("line",new kc(this.config.components.chart)),this.registerDataSeriesTypeDrawer("scatterPlot",new zc(this.config.colors.scatterPlot)),this.registerDataSeriesTypeDrawer("area",new Oc(this.config.components.chart)),this.registerDataSeriesTypeDrawer("baseline",new Nc(this.baselineModel,this.canvasBoundsContainer)),this.registerDataSeriesTypeDrawer("histogram",new Hc(this.config.components.chart.histogram));const t=()=>this.canvasBoundsContainer.getBounds(B.PANE_UUID(re));this.registerDataSeriesTypeDrawer("LINEAR",new qc),this.registerDataSeriesTypeDrawer("HISTOGRAM",new Kc),this.registerDataSeriesTypeDrawer("POINTS",new Jc),this.registerDataSeriesTypeDrawer("COLOR_CANDLE",new Xc(new Vc(this.chartModel),this.config,t)),this.registerDataSeriesTypeDrawer("TEXT",new Qc(this.config)),this.registerDataSeriesTypeDrawer("TRIANGLE",new eh),this.registerDataSeriesTypeDrawer("DIFFERENCE",new $c)}setChartType(e){this.config.components.chart.type=e,this.chartModel.rememberCurrentTimeframe(),this.chartModel.mainCandleSeries.config.type=e,this.chartModel.mainCandleSeries.updateCandleSeriesColors(ah({},this.config.colors)),this.chartModel.mainCandleSeries.recalculateVisualPoints(),this.chartModel.chartTypeChanged.next(e),this.canvasModel.fireDraw()}resetChartScale(){this.chartModel.doBasicScale()}setShowWicks(e){this.config.components.chart.showWicks=e,this.canvasModel.fireDraw()}setMainSeries(e){var t;const r=(t=e.instrument)!=null?t:this.chartModel.mainCandleSeries.instrument;this.chartModel.mainCandleSeries.instrument=r,this.chartModel.setAllSeries({candles:e.candles,instrument:r},this.chartModel.getSecondarySeries().map(s=>{var i;const a=(i=s.instrument)!=null?i:this.chartModel.mainCandleSeries.instrument,o=s.dataPoints;return fi(o),{candles:o,instrument:a}})),this.updatePriceIncrementsIfNeeded(r)}setSecondarySeries(e){var t;const r=(t=e.instrument)!=null?t:this.chartModel.mainCandleSeries.instrument,s=this.chartModel.setSecondaryCandleSeries(e.candles,r);if(this.updatePriceIncrementsIfNeeded(r),s)return s}setAllSeries(e,t){var r;const s=(r=e.instrument)!=null?r:this.chartModel.mainCandleSeries.instrument;this.updatePriceIncrementsIfNeeded(s),t.forEach(i=>{var a;const o=(a=i.instrument)!=null?a:this.chartModel.mainCandleSeries.instrument;this.updatePriceIncrementsIfNeeded(o)}),this.chartModel.setAllSeries(e,t)}toXFromCandleIndex(e){return this.chartModel.toX(e)}toXFromTimestamp(e){return this.chartModel.candleFromTimestamp(e).xCenter(this.chartModel.scaleModel)}toY(e){return this.chartModel.toY(e)}updateAllSeries(e,t){this.chartModel.updateAllSeries(e,t),this.canvasModel.fireDraw()}removeSecondarySeries(e){this.chartModel.removeSecondaryCandleSeries(e)}prependCandles(e,t){this.chartModel.prependCandles(e,t)}addLastCandle(e,t){this.chartModel.addLastCandle(e,t)}updateLastCandle(e,t){this.chartModel.updateLastCandle(e,t)}updateCandles(e,t){this.chartModel.updateCandles(e,t)}setOffsets(e){this.chartModel.setOffsets(e)}getDataSeriesDrawer(e){return this.dataSeriesDrawers[e]}registerDataSeriesTypeDrawer(e,t){this.dataSeriesDrawers[e]=t}updatePriceIncrementsIfNeeded(e){(!e.priceIncrements||!Ie.validatePriceIncrementsOrPrecisions(e.priceIncrements))&&(e.priceIncrements=[Ie.autoDetectIncrementOfValueRange(this.scaleModel.yEnd-this.scaleModel.yStart)])}observeOffsetsChanged(){return this.chartModel.offsetsChanged}observeChartTypeChanged(){return this.chartModel.chartTypeChanged}observeCandlesChanged(){return this.chartModel.observeCandlesChanged()}observeCandlesUpdated(){return this.chartModel.candlesUpdatedSubject}}const cn={width:20,height:20};class pi{constructor(e,t,r,s,i,a={}){this.eventBus=e,this.canvas=t,this.drawingManager=r,this.resizer=i,this.width=0,this.height=0,this.prevHeight=0,this.prevWidth=0,this.type=nr;var o;s.push(this),this.parent=mo(t);const l=t.getContext("2d",a);if(l===null)throw new Error("Couldn't get 2d context????");this.context=l,this._canvasId=(o=t.getAttribute("data-element"))!=null?o:"",this.updateCanvasWidthHeight(t,this.getChartResizerElement().getBoundingClientRect())}updateDPR(e){var t;const{width:r,height:s}=e,i=(t=window.devicePixelRatio)!=null?t:1;this.canvas.style.height=s+"px",this.canvas.style.width=r+"px",this.canvas.width=r*i,this.canvas.height=s*i,this.width=r,this.height=s,this.ctx.scale(i,i)}get canvasId(){return this._canvasId}get ctx(){return this.context}clear(){this.context.clearRect(0,0,this.width,this.height)}isLinked(){var e,t;return(t=(e=this.type)==null?void 0:e.linked)!=null?t:!1}fireDraw(){this.eventBus.fireDraw([this.canvasId])}updateCanvasWidthHeight(e,t=this.getChartResizerElement().getBoundingClientRect()){e.clientWidth!==this.width&&(e.width=e.clientWidth,this.width=e.clientWidth);const r=t.height;r!==this.height&&(e.style.height=r+"px",this.height=r,e.height=r,this.prevHeight=r)}getChartResizerElement(){var e;return(e=this.resizer)!=null?e:this.parent}isReady(){return this.width>cn.width&&this.height>cn.height}}const nr={name:"candle"},ch={candle:nr,bar:{name:"candle"},line:{name:"line",linked:!0},area:{name:"area",linked:!0}};function hh(n,e,t,r,s,i,a){var o;const l=bt(n,e,s,i,a,t);return l.type=(o=ch[r])!=null?o:nr,l}function bt(n,e,t,r,s,i){const a=new pi(n,e,r,s,i);return mi(a,t),a}function mi(n,e){const t=n.canvas;e.fixedSize&&(t.width=e.fixedSize.width,t.height=e.fixedSize.height,t.style.width=e.fixedSize.width+"px",t.style.height=e.fixedSize.height+"px",n.width=e.fixedSize.width,n.height=e.fixedSize.height),t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.direction="ltr"}function bi(n){if(n.length>1){const e=n.reduce((s,i,a)=>{if(a!==n.length-1){const o=n[a+1].timestamp-i.timestamp;s[o]?s[o]++:s[o]=1}return s},{});let t=0,r;for(const s of Object.keys(e)){const i=parseInt(s,10),a=e[i];a>t&&i>0&&(t=a,r=i)}if(r)return r}}const uh=n=>e=>{if(e.length!==0){const t=e.slice(Math.max(e.length-n.state.defaultViewportItems,0)),r=t[0],s=t[t.length-1];n.setXScale(r.startUnit,s.startUnit+s.width+n.offsets.right),n.doAutoScale(!0),n.recalculateZoomXYRatio(),n.fireChanged()}},dh=(n,e)=>(t,r=null)=>{const[s,i]=t,a=e.candleFromTimestamp(s).startUnit,o=e.candleFromTimestamp(i).startUnit,l=r===null?0:e.mainCandleSeries.meanCandleWidth*2,c=r?a-l:a+l,u=r?o+l:o-l;n.setXScale(c,u)},hn=60,wi=(n,e,t=hn)=>{const r=Nt(n.dataPoints,e,t),s=n.meanCandleWidth;r.volume=s;const i=n.visualPoints;let a;if(i.length===0)a=0;else if(e>=i.length){const o=i[i.length-1],c=(e-(i.length-1))*s;a=o.centerUnit+c}else{const o=i[0],c=-e*s;a=o.centerUnit-c}return new rn(a,s,r.open,r.close,r.lo,r.hi,nn(r.open,r.close),r)},Nt=(n,e,t=hn)=>({hi:NaN,lo:NaN,open:NaN,close:NaN,timestamp:fh(n,e,t),volume:NaN,expansion:!0,idx:e});function fh(n,e,t=hn){var r,s;const i=Mt(e);if(n.length===0)return 0;const a=Ue(n);if(i>=n.length&&a)return Ci(a,i,t);const o=Ot(n);return i<0&&o?Ci(o,i,t):(s=(r=n[i])==null?void 0:r.timestamp)!=null?s:0}const Ci=(n,e,t=hn)=>{var r;return n.timestamp+(e-((r=n.idx)!=null?r:0))*t};var vh=Object.defineProperty,gh=Object.defineProperties,ph=Object.getOwnPropertyDescriptors,yi=Object.getOwnPropertySymbols,mh=Object.prototype.hasOwnProperty,bh=Object.prototype.propertyIsEnumerable,Si=(n,e,t)=>e in n?vh(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,rr=(n,e)=>{for(var t in e||(e={}))mh.call(e,t)&&Si(n,t,e[t]);if(yi)for(var t of yi(e))bh.call(e,t)&&Si(n,t,e[t]);return n},sr=(n,e)=>gh(n,ph(e));class wh{constructor(e){this.config=e,this.secondaryChartColorsPool=this.createColorPool(this.config.colors.secondaryChartTheme),this.usedChartColors={}}isEmpty(){return Object.keys(this.secondaryChartColorsPool).length===Object.keys(this.usedChartColors).length}createColorPool(e){return e.reduce((t,r,s)=>(t[`color${s}`]=sr(rr({},sn(this.config.colors)),{lineTheme:Object.assign({},r.lineTheme),areaTheme:Object.assign({},r.areaTheme)}),t),{})}takeColorFromPool(e){if(this.isEmpty()){console.error("limit of candle series");return}return this.usedChartColors=sr(rr({},this.usedChartColors),{[e]:Object.keys(this.secondaryChartColorsPool).filter(t=>!Object.values(this.usedChartColors).includes(t))[0]}),this.secondaryChartColorsPool[this.usedChartColors[e]]}addColorToPool(e){this.usedChartColors[e]&&delete this.usedChartColors[e]}updateColorConfig(e,t){var r,s;const i=this.secondaryChartColorsPool[this.usedChartColors[e]];if(i){const a=t;this.secondaryChartColorsPool[this.usedChartColors[e]]=sr(rr({},t),{lineTheme:Object.assign(i.lineTheme,(r=a.lineTheme)!=null?r:{}),areaTheme:Object.assign(i.areaTheme,(s=a.areaTheme)!=null?s:{})})}}}var Ch=Object.defineProperty,Mi=Object.getOwnPropertySymbols,yh=Object.prototype.hasOwnProperty,Sh=Object.prototype.propertyIsEnumerable,_i=(n,e,t)=>e in n?Ch(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ir=(n,e)=>{for(var t in e||(e={}))yh.call(e,t)&&_i(n,t,e[t]);if(Mi)for(var t of Mi(e))Sh.call(e,t)&&_i(n,t,e[t]);return n};class Mh extends ee{constructor(e,t,r,s,i,a,o,l,c){super(),this.paneManager=e,this.bus=t,this.canvasModel=r,this.config=s,this.scaleModel=i,this.formatterFactory=a,this.mainCanvasParent=o,this.canvasBoundsContainer=l,this.chartResizeHandler=c,this.prevChartWidth=0,this.prevYWidth=0,this.period=0,this.candleSeries=[],this.candlesUpdatedSubject=new G,this.candlesSetSubject=new G,this.candlesPrependSubject=new G,this.nextCandleTimeStampSubject=new G,this.axisTypeSetSubject=new G,this.chartTypeChanged=new G,this.mainInstrumentChangedSubject=new G,this.scaleInversedSubject=new G,this.offsetsChanged=new G,this.candlesTransformersByChartType={},this.lastCandleLabelsByChartType={},this.candleWidthByChartType={},this.lastTimeFrame=[0,0],this.FAKE_CANDLES_DEFAULT=100,this.toY=u=>this.mainCandleSeries.view.toY(u),this.getPeriod=()=>this.period,this.chartTypeChanged.next(this.config.components.chart.type),this.secondaryChartColors=new wh(this.config),this.candleSeries[0]=this.createCandleSeriesModel(new oh,ir({},this.config.colors)),this.mainCandleSeries.config.type=this.config.components.chart.type,i.addXConstraint((u,g)=>Cc(g,this.mainCandleSeries.visualPoints,this.config.components.chart.minCandlesOffset,i.getBounds())),this.basicScaleViewportTransformer=uh(i),this.timeFrameViewportTransformer=dh(i,this),this.pane=this.paneManager.paneComponents[re]}get mainCandleSeries(){return this.candleSeries[0]}get secondaryCandleSeries(){return this.candleSeries.filter(e=>e!==this.mainCandleSeries)}doActivate(){super.doActivate(),this.addRxSubscription(this.canvasBoundsContainer.observeBoundsChanged(B.PANE_UUID(re)).pipe(ke(bs)).subscribe(e=>{this.handleChartResize(e)})),this.addRxSubscription(this.canvasBoundsContainer.barResizerChangedSubject.subscribe(()=>this.recalculateViewportModelZoomY()))}handleChartResize(e){if(e.width>cn.width&&e.height>cn.height){const t=this.getEffectiveChartWidth(),r=this.getEffectiveYAxisWidth();if(this.prevChartWidth===0){this.scaleModel.isViewportValid()?this.scaleModel.recalculateZoom():this.doBasicScale(),this.prevChartWidth=t,this.prevYWidth=r;return}if(r!==this.prevYWidth){if(this.config.scale.keepZoomXOnYAxisChange){const i=ze(r-this.prevYWidth,this.scaleModel.zoomX);this.scaleModel.setXScale(this.scaleModel.xStart,this.scaleModel.xEnd-i)}else this.scaleModel.recalculateZoomX();this.prevYWidth=r,this.prevChartWidth=t;return}const s=ze(t-this.prevChartWidth,this.scaleModel.zoomX);this.scaleModel.setXScale(this.scaleModel.xStart-s,this.scaleModel.xEnd),this.scaleModel.recalculateZoomY(),this.prevYWidth=r,this.prevChartWidth=t}}recalculateViewportModelZoomY(){this.scaleModel.recalculateZoomY(),this.scaleModel.fireChanged(),this.bus.fireDraw([this.canvasModel.canvasId])}setMainCandleSeries(e,t){this.mainCandleSeries.instrument=t,this.setAllSeries({candles:e,instrument:t},this.getSecondarySeries().map(r=>{const s=r.dataPoints;return fi(s),{candles:s,instrument:r.instrument}}))}setSecondaryCandleSeries(e,t=this.mainCandleSeries.instrument,r=!0){const s=un(e.map(ln)),i=this.reindexCandlesBasedOnSeries(this.mainCandleSeries.dataPoints,s),a=this.secondarySeriesAdjustments(this.mainCandleSeries.dataPoints,i),l=this.secondaryCandleSeries.some(c=>c.instrument.symbol===t.symbol)?this.secondaryCandleSeries.find(c=>c.instrument.symbol===t.symbol):this.createSecondaryCandleSeriesModel(t);if(l)return l.dataPoints=a,r&&(this.scaleModel.doAutoScale(),l.recalculateVisualPoints(),this.candlesSetSubject.next(),this.bus.fireDraw([this.canvasModel.canvasId])),l}setAllSeries(e,t){var r;this.mainCandleSeries.instrument=(r=e.instrument)!=null?r:this.mainCandleSeries.instrument,e.instrument&&this.mainInstrumentChangedSubject.next(e.instrument),this.rememberCurrentTimeframe();const s=un(e.candles.map(ln));this.mainCandleSeries.clearData(),di(s),this.mainCandleSeries.dataPoints=s,this.secondaryCandleSeries.filter(i=>t.filter(a=>{var o;return((o=a.instrument)==null?void 0:o.symbol)===i.instrument.symbol}).length===0).forEach(i=>this.removeSecondaryCandleSeries(i)),t.map(i=>this.setSecondaryCandleSeries(i.candles,i.instrument,!1)),this.candleSeries.forEach(i=>{i.recalculateDataViewportIndexes(),i.recalculateVisualPoints()}),this.recalculatePeriod(),this.autoScaleOnCandles(),this.scaleModel.doAutoScale(),this.candlesSetSubject.next(),this.bus.fireDraw([this.canvasModel.canvasId])}recalculatePeriod(){const e=bi(this.mainCandleSeries.dataPoints);e&&(this.period=e)}autoScaleOnCandles(){this.scaleModel.state.autoScaleOnCandles&&(this.doBasicScale(),this.scaleModel.autoScale(!0))}doBasicScale(){this.basicScaleViewportTransformer(this.mainCandleSeries.visualPoints),this.bus.fireDraw()}doPreviousTimeFrameScale(e=null){this.timeFrameViewportTransformer(this.lastTimeFrame,e),this.scaleModel.state.autoScaleOnCandles&&this.scaleModel.doAutoScale(!0),this.bus.fireDraw()}rememberCurrentTimeframe(){this.mainCandleSeries.visualPoints.length!==0&&(this.lastTimeFrame=[this.candleFromX(this.scaleModel.toX(this.scaleModel.xStart),!0).timestamp,this.candleFromX(this.scaleModel.toX(this.scaleModel.xEnd),!0).timestamp])}updateAllSeries(e,t){const r=[e,...t];if(!this.candleSeries.every(l=>r.find(c=>{var u;return((u=c.instrument)==null?void 0:u.symbol)===l.instrument.symbol}))||t.length!==this.secondaryCandleSeries.length){console.error("All series update failed. Instruments for series are different.");return}const s=un(e.candles.map(ln)),i=Pi(this.mainCandleSeries.dataPoints,s),a=i.candles;di(a),this.mainCandleSeries.dataPoints=a,t.map(l=>{var c,u,g,b;const P=un(l.candles.map(ln)),I=Pi((b=(g=this.findSecondarySeriesBySymbol((u=(c=l.instrument)==null?void 0:c.symbol)!=null?u:""))==null?void 0:g.dataPoints)!=null?b:[],P).candles;return this.setSecondaryCandleSeries(I,l.instrument,!1)}),this.candleSeries.forEach(l=>{l.recalculateVisualPoints(),l.recalculateDataViewportIndexes()}),this.scaleModel.moveXStart(this.scaleModel.xStart+i.prepended),this.candlesPrependSubject.next(i.prepended);const o=bi(this.mainCandleSeries.dataPoints);o&&(this.period=o),this.candlesUpdatedSubject.next(),this.bus.fireDraw()}createSecondaryCandleSeriesModel(e){const t=ir(ir({},this.config.colors),this.secondaryChartColors.takeColorFromPool(e.symbol));return this.createCandleSeriesModel(e,t)}createCandleSeriesModel(e,t){const r=new lt(this.paneManager.paneComponents[re],this.paneManager.hitTestContoller.getNewDataSeriesHitTestId(),this.bus,this.scaleModel,e,this.candlesTransformersByChartType,this.candleWidthByChartType,t);return r.config.type="line",this.candleSeries.push(r),r}removeSecondaryCandleSeries(e){return this.secondaryChartColors.addColorToPool(e.instrument.symbol),this.candleSeries=this.candleSeries.filter(t=>t!==e),e.deactivate(),this.paneManager.paneComponents[re].removeDataSeries(e),this.scaleModel.doAutoScale(),e.colors}secondarySeriesAdjustments(e,t){const r=[];return e.forEach(s=>{var i;const a=(i=s.idx)!=null?i:0,o=t[a];if(o)r.push(o);else{let l=xi(t,a,-1);if(l||(l=xi(t,a,1)),l){const c=Hl(l,a,!0);r.push(c)}}}),r}updateSecondaryCandleSeriesConfig(e,t,r){const s=He(e,Gt().colors);this.secondaryChartColors.updateColorConfig(t,s);const i=this.findSecondarySeriesBySymbol(t);i&&(i.config.type=r,i.updateCandleSeriesColors(s),this.bus.fireDraw([this.canvasModel.canvasId])),this.bus.fireDraw([this.canvasModel.canvasId])}setAutoScale(e){this.scaleModel.autoScale(e)}getEffectiveYAxisWidth(){return this.canvasBoundsContainer.getBounds(B.PANE_UUID_Y_AXIS(re)).width}getEffectiveChartWidth(){return this.canvasBoundsContainer.getBounds(B.PANE_UUID(re)).width}getEffectiveChartHeight(){return this.canvasBoundsContainer.getBounds(B.PANE_UUID(re)).height}setOffsets(e){this.scaleModel.updateOffsets(e);const t=this.getCandlesCountWithRightOffset(),r=this.mainCandleSeries.visualPoints;this.hasCandles()&&t>=r.length&&this.scaleModel.setXScale(this.scaleModel.xStart,this.candleFromIdx(t).startUnit),this.offsetsChanged.next(),this.bus.fireDraw()}getOffsets(){return this.scaleModel.getOffsets()}fromY(e){return this.scaleModel.fromY(e)}priceFromY(e,t){return(t!=null?t:this.mainCandleSeries).view.priceFromY(e)}toX(e){const t=this.candleFromIdx(e);return this.scaleModel.toX(t.centerUnit)}getBaseLine(){return this.mainCandleSeries.getBaseLine()}candleFromX(e,t=!1,r=this.mainCandleSeries){const s=this.scaleModel.fromX(e);return this.candleFromUnit(s,t,r)}candleFromUnit(e,t=!1,r=this.mainCandleSeries){var s,i;const a=ot(r.visualPoints,e,g=>g.startUnit),o=r.visualPoints,l=this.getLastVisualCandle();o[a.index]!==void 0&&(e<0||l&&e>l.startUnit+l.width)&&(a.index+=we((e-o[a.index].centerUnit)/this.mainCandleSeries.meanCandleWidth));const c=a.index,u=Math.max(Math.min(o.length-1,c),0);return(c<0||c>=o.length)&&t?Nt(this.mainCandleSeries.dataPoints,c,this.getPeriod()):(i=(s=o[u])==null?void 0:s.candle)!=null?i:Nt(this.mainCandleSeries.dataPoints,u,this.getPeriod())}candleFromTimestamp(e,t=!0){const r=Bt(e,t,this.mainCandleSeries.dataPoints,this.getPeriod());return this.candleFromIdx(r.index)}candleFromIdx(e){const t=this.mainCandleSeries.visualPoints[e];return t||wi(this.mainCandleSeries,e,this.getPeriod())}isReady(){return this.canvasModel.isReady()&&this.hasCandles()}registerCandlesTransformer(e,t){this.candlesTransformersByChartType[e]=t}registerCandlesWidthCalculator(e,t){this.candleWidthByChartType[e]=t}registerLastCandleLabelHandler(e,t){this.lastCandleLabelsByChartType[e]=t}hasCandles(){return this.mainCandleSeries.visualPoints.length!==0}getVisualCandle(e){var t,r,s;const i=e-((s=(r=(t=this.mainCandleSeries.visualPoints[0])==null?void 0:t.candle)==null?void 0:r.idx)!=null?s:0);return this.mainCandleSeries.visualPoints[i]}getFirstIdx(){return this.mainCandleSeries.dataIdxStart}getLastIdx(){return this.mainCandleSeries.dataIdxEnd}getFirstTimestamp(e=!0){return e?this.candleFromIdx(this.getFirstIdx()).candle.timestamp:this.candleFromUnit(this.scaleModel.xStart,!0).timestamp}getLastTimestamp(e=!0){return e?this.candleFromIdx(this.getLastIdx()).candle.timestamp:this.candleFromUnit(this.scaleModel.xEnd,!0).timestamp}setTimestampRange(e,t){const r=this.candleFromTimestamp(e).startUnit,s=this.candleFromTimestamp(t),i=s.startUnit+s.width;return this.scaleModel.setXScale(r,i)}getLastCandle(){const e=this.mainCandleSeries.dataPoints;return Ue(e)}getLastVisualCandle(){const e=this.mainCandleSeries.visualPoints;return Ue(e)}getMaxCandlesFitLength(){return we(this.getEffectiveChartWidth()/this.config.components.chart.minWidth)}getSecondarySeries(){return this.secondaryCandleSeries}isSeriesInstrument(e,t){return e.instrument.symbol===t}findSeriesBySymbol(e){return this.candleSeries.filter(t=>this.isSeriesInstrument(t,e))}findSecondarySeriesBySymbol(e){return this.secondaryCandleSeries.find(t=>this.isSeriesInstrument(t,e))}reindexCandlesBasedOnSeries(e,t){const r=this.getPeriod();return t.reduce((s,i)=>{const a=i.timestamp,o=Bt(a,!1,e,r);return o.index>=0&&o.index<e.length&&(i.idx=o.index,s[o.index]=i),s},[])}isCandleInViewport(e){return this.getFirstIdx()<=e&&e<=this.getLastIdx()}updateCandles(e,t=this.mainCandleSeries.instrument.symbol){const r=this.mainCandleSeries.instrument.symbol===t,s=this.findSeriesBySymbol(t);if(s.length===0){console.warn("updateCandles failed. Can't find series",t);return}s.forEach(i=>{const a=i.dataPoints;let o=!1,l=!1,c;e.forEach(u=>{var g;if(!u)return;const b=Bt(u.timestamp,!0,a,this.getPeriod()),P=Math.min(b.index,a.length);o=o||P===a.length,a[P]=u,u.idx=P,i.dataPoints=a,i.recalculateDataViewportIndexes(),l=l||this.isCandleInViewport(P);const I=P>=a.length-1,Y=c&&u.timestamp<c.timestamp;if(I&&!Y&&(c=u),o&&c&&r&&l){const k=(g=this.candleWidthByChartType[this.config.components.chart.type])!=null?g:Fs;this.scaleModel.moveXStart(this.scaleModel.xStart+k(c))}}),c&&i.updateCurrentPrice(c.close),l&&c&&e.length===1?this.bus.fireDraw([this.canvasModel.canvasId]):i.recalculateVisualPoints()}),this.scaleModel.doAutoScale(),this.candlesUpdatedSubject.next()}observeCandlesChanged(){return Ee(this.candlesSetSubject,this.candlesUpdatedSubject)}getCandles(){return this.mainCandleSeries.dataPoints}getCandlesWithFake(e=0,t){let r=this.getCandles().slice();const s=this.getCandlesCount(),i=t!=null?t:s+this.FAKE_CANDLES_DEFAULT;r=r.slice(Math.max(0,e),Math.min(s,i));const a=[],o=[];for(let c=s;c<i;c++)a.push(Nt(this.mainCandleSeries.dataPoints,c,this.getPeriod()));const l=Math.min(0,i);for(let c=e;c<l;c++)o.push(Nt(this.mainCandleSeries.dataPoints,c,this.getPeriod()));return[...o,...r,...a]}getCandlesCount(){return this.mainCandleSeries.dataPoints.length}getCandlesCountWithRightOffset(){return this.getCandlesCount()+this.getOffsets().right}clearData(){this.candleSeries.forEach(e=>e.clearData())}prependCandles(e,t){const r=e.slice(),s=[];return t.forEach(i=>{const o=Bt(i.timestamp,!1,e).index;o<0?s.push(i):e[o].timestamp===i.timestamp?r[o]=i:console.warn(`Couldn't update candle with timestamp ${i.timestamp}`)}),{prepended:s.length,candles:[...s,...r]}}addLastCandle(e,t=this.mainCandleSeries.instrument.symbol){this.updateCandles([e],t)}updateLastCandle(e,t=this.mainCandleSeries.instrument.symbol){this.updateCandles([e],t)}}const un=n=>n.slice().sort((e,t)=>e.timestamp===t.timestamp?0:e.timestamp>t.timestamp?1:-1),xi=(n,e,t)=>{if(e>=n.length)return n[n.length-1];for(let r=e;r<n.length&&r>=0;r+=t){const s=n[r];if(s)return s}},Pi=(n,e)=>{const t=n.slice(),r=[],s=[];return e.forEach(i=>{const o=Bt(i.timestamp,!1,n).index;o<0?r.push(i):o>=n.length?s.push(i):n[o].timestamp===i.timestamp?t[o]=i:console.warn(`Couldn't update candle with timestamp ${i.timestamp}`)}),{prepended:r.length,appended:s.length,candles:[...r,...t,...s]}};class xt{constructor(e){this.canvasModel=e}draw(){this.canvasModel.clear()}getCanvasIds(){return[this.canvasModel.canvasId]}}class ar{constructor(e){this.drawers=e!=null?e:new Map}draw(){this.drawers.forEach(e=>e.draw())}addDrawer(e,t){const r=t!=null?t:"drawer"+this.drawers.size;this.drawers.set(r,e)}drawLastBar(){this.drawers.forEach(e=>e.drawLastBar&&e.drawLastBar())}removeDrawer(e){const t=us(this.drawers,e);t?this.drawers.delete(t):console.warn("Couldn't find drawer type")}removeDrawerByName(e){this.drawers.delete(e)}getDrawer(e){return this.drawers.get(e)}moveTop(e){const t=us(this.drawers,e);t?this.moveTopByName(t):console.warn("Couldn't find drawer type")}moveTopByName(e){if(this.drawers.size===1)return;const t=this.drawers.get(e);this.drawers.delete(e),t&&this.drawers.set(e,t)}getSize(){return this.drawers.size}getAll(){return this.drawers}getCanvasIds(){const e=Array.from(this.drawers).map(([,r])=>r.getCanvasIds()).flat(3),t=new Set([...e]);return Array.from(t)}}class _h{constructor(e,t,r){this.model=e,this.crossToolCanvasModel=t,this.crossToolTypeDrawers=r}draw(){const e=this.crossToolTypeDrawers[this.model.type];e?this.model.currentHover&&e.draw(this.crossToolCanvasModel.ctx,this.model.currentHover):console.error(`No cross tool drawer type registered for drawer type ${this.model.type}`)}getCanvasIds(){return[this.crossToolCanvasModel.canvasId]}}const xh=()=>n=>n.toString(),Ph=(n,e)=>{var t;const r="date.get"+(e((t=n.timezone)!=null?t:"")?"":"UTC"),s={YYYY:a("FullYear"),YY:a("FullYear")+" % 100",MMM:o("shortMonths","Month"),MMMM:l(o("shortMonths","Month")),M:"1+"+a("Month"),d:a("Date"),H:a("Hours"),m:a("Minutes"),s:a("Seconds"),sss:a("Milliseconds"),EEE:o("shortDays","Day"),SSS:"this.addTwoZeros("+a("Milliseconds")+")",T:"date.getTime()"};["s","m","H","d","M"].forEach(function(u){s[u+u]="this.addZero("+s[u]+")"});const i=new RegExp(Object.keys(s).sort().reverse().join("|"),"g");function a(u){return r+u+"()"}function o(u,g){return"this."+u+"["+a(g)+"]"}function l(u){return u+".toUpperCase()"}function c(u){return"' + ("+s[u]+") + '"}return function(u){var g;const b={shortDays:Th(n),shortMonths:Ah(n),addZero(P){return P<10?"0"+P:P},addTwoZeros(P){return(P<100?"0":"")+(P<10?"0":"")+P},tzDate:e((g=n.timezone)!=null?g:"")||function(P){return P instanceof Date?P:new Date(+P)}};return new Function("date","date=this.tzDate(date); return '"+u.replace(i,c)+"'").bind(b)}};function Jv(n){const e=n("T");return function(t){return new Date(+e(t))}}function Th(n){var e;return(e=n.shortDays)!=null?e:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}function Ah(n){var e;return(e=n.shortMonths)!=null?e:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}const Ti=(n,e,t)=>{if(n){if(typeof n=="string")return t(n);if(Array.isArray(n)){const r=n.filter(s=>{if(s.showWhen){const i=[];return s.showWhen.periodLessThen&&i.push(()=>{var a,o;return e<((o=(a=s.showWhen)==null?void 0:a.periodLessThen)!=null?o:0)}),s.showWhen.periodMoreThen&&i.push(()=>{var a,o;return e>=((o=(a=s.showWhen)==null?void 0:a.periodMoreThen)!=null?o:0)}),i.every(a=>a())}else return!0});if(r.length>0){const s=r[0];if(s.format)return t(s.format);if(s.customFormatter)return s.customFormatter}}}return xh()};function Qv(n,e,t){const r=e[n.type];let s;if(isFunction2(r))s=r;else if(typeof r=="string")s=t(r);else throw new Error(`Format missing in xAxis.labels.formats for '${n.type}' type label`);return s}class Eh extends ee{constructor(e,t,r,s,i,a,o){super(),this.eventBus=e,this.config=t,this.crossToolCanvasModel=r,this.canvasInputListener=s,this.chartModel=i,this.timeZoneModel=a,this.formatterFactory=o,this.currentHover=null,this.type="cross-and-labels",this.xFormatter=()=>"",this.type=t.type}setType(e){this.type=e}doActivate(){super.doActivate(),this.addRxSubscription(this.canvasInputListener.observeMouseMove().subscribe(()=>{this.fireDraw()})),this.addSubscription(this.eventBus.on(Tn,(e,t)=>{t&&(this.updateHover(e),this.fireDraw())})),this.addSubscription(this.eventBus.on(An,()=>{this.currentHover=null,this.fireDraw()})),this.addRxSubscription(Ee(this.chartModel.candlesSetSubject,this.timeZoneModel.observeTimeZoneChanged()).subscribe(()=>this.recalculateCrossToolXFormatter()))}fireDraw(){this.type!=="none"&&this.crossToolCanvasModel.fireDraw()}updateHover(e){if(this.currentHover===null?this.currentHover={x:e.x,y:0,time:e.timeFormatted}:(this.currentHover.x=e.x,this.currentHover.time=e.timeFormatted),e.candleHover)switch(this.config.magnetTarget){case"O":this.currentHover.y=e.candleHover.openY;break;case"C":this.currentHover.y=e.candleHover.closeY;break;case"H":this.currentHover.y=e.candleHover.highY;break;case"L":this.currentHover.y=e.candleHover.lowY;break;case"OHLC":this.currentHover.y=e.candleHover.closestOHLCY;break;case"none":this.currentHover.y=e.y;break}else this.currentHover.y=e.y}recalculateCrossToolXFormatter(){const e=this.config.xAxisLabelFormat;this.xFormatter=Ti(e,this.chartModel.getPeriod(),this.formatterFactory)}}class Dh{constructor(e,t=()=>!0){this.dataProvider=e,this.dataUpdatedPredicate=t,this.calculatedInThisFrame=!1,this.animFrameId=`anim_cache_${$e()}`}calculateOrGet(){var e;return this.calculatedInThisFrame||(this.cache=this.dataProvider(),this.dataUpdatedPredicate()&&(this.calculatedInThisFrame=!0),jr(this.animFrameId,()=>{this.calculatedInThisFrame=!1})),(e=this.cache)!=null?e:this.dataProvider()}forceCalculateOrGet(){return this.invalidate(),this.calculateOrGet()}getLastCachedValue(){return this.cache}updateCacheValue(e){this.cache=e}invalidate(){this.cache=void 0,this.calculatedInThisFrame=!1}}const Lh=0,Ih=.01;class or{constructor(e,t,r,s,i=!1,a,o,l=Nn){this.increment=e,this.startEndProvider=t,this.lengthProvider=r,this.valueFormatter=s,this.withZero=i,this.axisTypeProvider=a,this.baseLineProvider=o,this.labelFilter=l,this.gridDistanceMultipliers=[2,4,5,10],this.lastSingleLabelHeightValue=0,this.distanceBetweenLabelsChangeSubject=new G,this.newGeneratedLabelsSubject=new G,this.lastStart=0,this.lastEnd=0,this.labelsCache=new Dh(()=>this.labelFilter(this.doGenerateLabels()))}generateRegularLabels(e,t,r){const s=[];this.withZero&&s.push({value:0,text:"0"});let i=ge.roundToNearest(e,r);for(;i<t;){const a=ge.roundToNearest(i,r),o=this.valueFormatter(a);s.push({value:a,text:o}),i=ge.roundDecimal(i+r)}return s}generatePercentLabels(e,t,r){const s=[],i=this.baseLineProvider();let a=ge.roundToNearest(e,r);for(;a<t;){const o=ge.roundToNearest(a,r),l=Ps(o,i),c=this.valueFormatter(l);s.push({value:o,text:c}),a=ge.roundDecimal(a+r)}return s}generateLogarithmLabels(e,t,r){const s=[];let i=ge.roundToNearest(e,r);for(;i<t;){const a=$n(i),o=this.valueFormatter(a);s.push({value:i,text:o}),i=ge.roundDecimal(i+r)}return s}doGenerateLabels(){var e;const t=this.lengthProvider();if(t<=0)return[];const[r,s]=this.calculateMinMax(),i=this.getAxisStep(r,s,t);this.lastSingleLabelHeightValue||(this.lastSingleLabelHeightValue=i);let a;const o=this.axisTypeProvider();if(o==="logarithmic"?a=this.generateLogarithmLabels(r,s,i):o==="percent"?a=this.generatePercentLabels(r,s,i):a=this.generateRegularLabels(r,s,i),this.lastSingleLabelHeightValue!==i&&this.labelsCache.cache){const l=(e=this.labelsCache.getLastCachedValue())!=null?e:[];this.distanceBetweenLabelsChangeSubject.next([l,a]),this.lastSingleLabelHeightValue=i}return this.newGeneratedLabelsSubject.next(a),a}calculateMinMax(){const[e,t]=this.startEndProvider(),r=this.lengthProvider(),s=or.getLabelBounds(e,t,r);return[s[0],s[1]]}getAxisStep(e,t,r){const s=t-e,a=r/23,o=this.calculateIncrement(s),l=s/a;return this.calculateAxisStep(l,o)}observeDistanceBetweenLabelsChanged(){return this.distanceBetweenLabelsChangeSubject.asObservable()}observeLabelsChanged(){return this.newGeneratedLabelsSubject.asObservable()}calculateIncrement(e){if(this.increment)return this.increment;if(!isNaN(e)){const t=Ie.autoDetectIncrementOfValueRange(e);return this.adjustIncrementOnAxisType(t)}return this.adjustIncrementOnAxisType(Ih)}adjustIncrementOnAxisType(e){switch(this.axisTypeProvider()){case"percent":return e;case"logarithmic":const[t]=this.calculateMinMax(),s=$n(t)+e;return Ts(s)-t;case"regular":return e}}generateNumericLabels(){const[e,t]=this.startEndProvider();return(e!==this.lastStart||t!==this.lastEnd)&&this.labelsCache.invalidate(),this.lastStart=e,this.lastEnd=t,this.labelsCache.calculateOrGet()}static getLabelBounds(e,t,r){const s=Math.abs((t-e)*(Lh/r));return[e-s,t+s]}calculateAxisStep(e,t){if(t===0)return console.error("NumericAxisLabelsGenerator failed at calculateAxisStep: increment = 0"),0;let r=t,s=t,i=0;for(;r<e&&r>0;)i>=this.gridDistanceMultipliers.length&&(i=0,s*=10),r=s*this.gridDistanceMultipliers[i++];return r}}class Ai extends or{constructor(e,t,r,s,i=()=>"regular",a=()=>1){super(e,()=>[r.yStart,r.yEnd],()=>r.getBounds().height,s,!1,i,a,void 0),this.chartModel=t}calculateIncrement(e){var t;const r=(t=this.chartModel)==null?void 0:t.mainCandleSeries.instrument;if(this.chartModel&&r&&Array.isArray(r.priceIncrements)){const s=Ue(this.chartModel.getCandles()),i=s&&s.close?s.close:0,a=Ie.getPriceIncrement(i,r);return this.adjustIncrementOnAxisType(a)}return super.calculateIncrement(e)}}function Oh(n,e){if(n.filter(i=>i!==null).length<=1)return n.map(i=>i.y);const t=e-2,r=n.map((i,a)=>Bh(i,a,t)).filter(ko).sort(Rh),s=new Array(r.length);return r.forEach((i,a)=>{if(i===null)return;const o=r[a+1];if(o&&o.top<i.bottom){const l=o.labelWeight-i.labelWeight===1?2:0,c=i.bottom-o.top+l;o.top+=c,o.bottom+=c}s[i.actualIndex]=(i.top+i.bottom)/2}),s}const Bh=(n,e,t)=>n?{top:n.y-t/2,bottom:n.y+t/2,labelWeight:n.weight,actualIndex:e}:null,Rh=(n,e)=>{const t=n.top,r=e.top;return t>r?1:t<r||t===r&&n.labelWeight<e.labelWeight?-1:0};var Fh=Object.defineProperty,Nh=Object.defineProperties,Yh=Object.getOwnPropertyDescriptors,Ei=Object.getOwnPropertySymbols,Hh=Object.prototype.hasOwnProperty,kh=Object.prototype.propertyIsEnumerable,Di=(n,e,t)=>e in n?Fh(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Li=(n,e)=>{for(var t in e||(e={}))Hh.call(e,t)&&Di(n,t,e[t]);if(Ei)for(var t of Ei(e))kh.call(e,t)&&Di(n,t,e[t]);return n},Ii=(n,e)=>Nh(n,Yh(e));const lr={MAIN:"MAIN"};class Uh extends ee{constructor(e,t,r,s,i,a){super(),this.eventBus=e,this.chartModel=t,this.canvasBoundsContainer=r,this.config=s,this.canvasModel=i,this.updateYAxisWidth=a,this.orderedLabels=[],this.customLabels={},this.labelsProviders={},this.labelsPositionRecalculatedSubject=new G,this.animFrameId=`anim_cache_${$e()}`,this.initModel()}doActivate(){super.doActivate(),this.addRxSubscription(Ee(this.chartModel.observeCandlesChanged(),this.canvasBoundsContainer.observeBoundsChanged(B.CHART),this.chartModel.nextCandleTimeStampSubject,this.canvasBoundsContainer.barResizerChangedSubject,this.chartModel.scaleModel.changed).subscribe(()=>{this.updateLabels()}))}initModel(){this.initLabelsGroups(),this.recalculateLabels(),this.canvasModel.fireDraw()}initLabelsGroups(){if(Object.keys(this.labelsProviders).length!==0)for(const e of Object.keys(this.labelsProviders))this.createGroup(e),Object.entries(this.labelsProviders[e]).forEach(([t,r])=>{this.addToGroup(r,e,t)})}updateLabels(e=!1){this.recalculateLabels(),Ln(this.animFrameId,()=>{e&&this.updateYAxisWidth(),this.canvasModel.fireDraw()})}recalculateLabels(){var e,t;this.orderedLabels=[];const r=this.config.components.yAxis.fontSize+((e=this.config.components.yAxis.labelBoxMargin.top)!=null?e:0)+((t=this.config.components.yAxis.labelBoxMargin.bottom)!=null?t:0);for(const s of Object.values(this.labelsProviders)){const i=Object.values(s).map(l=>l.getUnorderedLabels()).flat(),a=i.map(l=>l.labels).flat().map(l=>{var c;return{y:l.y,weight:(c=l.labelWeight)!=null?c:Number.POSITIVE_INFINITY}}),o=Oh(a,r);i.forEach(l=>{const c=o.splice(0,l.labels.length);this.orderedLabels.push(this.updateLabelsCoordinates(l,c))})}this.orderedLabels=this.orderedLabels.reverse()}createGroup(e){!this.labelsProviders[e]&&(this.labelsProviders[e]={})}addToGroup(e,t,r){this.labelsProviders[t]&&(Object.values(this.labelsProviders[t]).includes(e)||(this.labelsProviders[t][r]=e))}updateLabelsCoordinates(e,t){return Ii(Li({},e),{labels:e.labels.map((r,s)=>Ii(Li({},r),{lineY:r.y,y:t[s]}))})}observeLabelsPositionsRecalculated(){return this.labelsPositionRecalculatedSubject.asObservable()}registerYAxisLabelsProvider(e,t,r){var s;const i=(s=this.labelsProviders[e])!=null?s:{};i[r]=t,this.labelsProviders[e]=i,this.initModel()}unregisterYAxisLabelsProvider(e,t){var r;const s=(r=this.labelsProviders[e])!=null?r:{};delete s[t],this.labelsProviders[e]&&Object.keys(this.labelsProviders[e]).length===0&&delete this.labelsProviders[e],this.initModel()}}function le(n,e){return x(function(t,r){var s=0;t.subscribe(Re(r,function(i){return n.call(e,i,s++)&&r.next(i)}))})}function cr(n,e,t){var r=R(n)||e||t?{next:n,error:e,complete:t}:n;return r?x(function(s,i){var a;(a=r.subscribe)===null||a===void 0||a.call(r);var o=!0;s.subscribe(Re(i,function(l){var c;(c=r.next)===null||c===void 0||c.call(r,l),i.next(l)},function(){var l;o=!1,(l=r.complete)===null||l===void 0||l.call(r),i.complete()},function(l){var c;o=!1,(c=r.error)===null||c===void 0||c.call(r,l),i.error(l)},function(){var l,c;o&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):St}class zh extends ee{constructor(e,t,r,s){super(),this.scaleModel=e,this.yAxisLabelsGenerator=t,this.canvasBoundsContainer=r,this.updateYAxisWidth=s,this.labels=[],this.prevYAxisHeight=0,this.animFrameId=`anim_cache_${$e()}`}doActivate(){super.doActivate(),this.addRxSubscription(Ee(this.scaleModel.yChanged,this.canvasBoundsContainer.observeBoundsChanged(B.Y_AXIS).pipe(Ce(e=>e.height),le(e=>_o(e,this.prevYAxisHeight,1.5)),cr(e=>{this.yAxisLabelsGenerator.labelsCache.invalidate(),this.prevYAxisHeight=e}))).subscribe(()=>this.updateLabels()))}updateLabels(){this.labels=this.yAxisLabelsGenerator.generateNumericLabels(),Ln(this.animFrameId,()=>this.updateYAxisWidth())}}class Wh extends ee{constructor(e,t,r,s,i,a,o,l){super(),this.config=s,this.canvasBoundsContainer=i,this.canvasModel=a,this.chartModel=o,this.yAxisWidthContributors=[];const c=t.valueFormatter;this.yAxisLabelsGenerator=new Ai(null,o,l,c,()=>this.config.components.yAxis.type,()=>this.chartModel.getBaseLine()),this.yAxisBaseLabelsModel=new zh(l,this.yAxisLabelsGenerator,this.canvasBoundsContainer,()=>this.updateYAxisWidth()),this.addChildEntity(this.yAxisBaseLabelsModel),this.yAxisLabelsModel=new Uh(r,this.chartModel,this.canvasBoundsContainer,this.config,a,()=>this.updateYAxisWidth()),this.addChildEntity(this.yAxisLabelsModel),this.registerYAxisWidthContributor({getLargestLabel:()=>{var u;return((u=this.yAxisLabelsGenerator.labelsCache.getLastCachedValue())!=null?u:[]).map(g=>g.text).concat(this.yAxisLabelsModel.orderedLabels.flatMap(g=>g.labels).map(g=>g.labelText)).reduce((g,b)=>b.length>g.length?b:g,"")}}),this.registerYAxisWidthContributor({getLargestLabel:()=>Object.values(e.paneComponents).map(u=>{var g;return(g=u.yAxisLabelsGenerator.labelsCache.getLastCachedValue())!=null?g:[]}).flat().reduce((u,g)=>g.text.length>u.length?g.text:u,"")})}doActivate(){super.doActivate(),this.addRxSubscription(Ee(this.chartModel.candlesSetSubject).subscribe(()=>{this.yAxisLabelsGenerator.labelsCache.invalidate(),this.yAxisLabelsModel.updateLabels(),this.yAxisBaseLabelsModel.updateLabels(),this.canvasModel.fireDraw()}))}getTextWidth(e){const t=Pt(this.config.components.yAxis);return Ke(e,this.canvasModel.ctx,t)}registerYAxisWidthContributor(e){this.yAxisWidthContributors.push(e)}updateYAxisWidth(){var e,t,r,s;const a=Math.max(...this.yAxisWidthContributors.map(o=>this.getTextWidth(o.getLargestLabel())))+((t=(e=this.config.components.yAxis.labelBoxMargin)==null?void 0:e.start)!=null?t:0)+((s=(r=this.config.components.yAxis.labelBoxMargin)==null?void 0:r.end)!=null?s:0);this.canvasBoundsContainer.setYAxisWidth(a)}}const Pt=n=>`${n.fontSize}px ${n.fontFamily}`,ct=4;function Xh(n,e,t,r,s,i,a){var o,l,c,u,g,b,P;const I=i.align,Y=(o=s.textFont)!=null?o:Pt(i),k=s.bgColor,U=(l=s.textColor)!=null?l:Yn(k,a.labelTextColor,a.labelInvertedTextColor),W=(c=s.paddingTop)!=null?c:ct,q=(u=s.paddingBottom)!=null?u:ct,K=(g=s.paddingEnd)!=null?g:ct,Z=Mt(at(Y,n)/2),$=r-Z-W,ne=r+Z+q-$;if(r<e.y+ne/2||r>e.y+e.height-ne/2)return;n.save(),n.fillStyle=k,n.strokeStyle=k;const oe=Mt(e.width/6),ce=I==="right"?e.x:e.x+e.width,de=I==="right"?ce+oe:ce-oe,fe=i.labelBoxMargin.end,he=fe-K,Fe=e.width-oe-he;Bc(n,de,$,ce,$+Mt(ne/2),de,$+ne,Fe,(P=(b=i.typeConfig.badge)==null?void 0:b.rounded)!=null?P:!1,I),n.fillStyle=U,n.font=Y;const me=I==="right"?e.x+e.width-Ke(t,n,Y)-fe:e.x+fe;n.fillText(t,me,r+Z-1),n.restore()}function Oi(n,e,t,r,s,i,a,o){var l,c,u,g,b,P,I,Y,k,U,W;const q=i.align,K=(l=s.textFont)!=null?l:Pt(i),Z=(c=s.textColor)!=null?c:"#FF00FF",$=s.bgColor,ae=(u=i.typeConfig.rectangle)==null?void 0:u.paddings,ne=(b=(g=s.paddingTop)!=null?g:ae==null?void 0:ae.top)!=null?b:ct,oe=(I=(P=s.paddingBottom)!=null?P:ae==null?void 0:ae.bottom)!=null?I:ct,ce=(k=(Y=s.paddingEnd)!=null?Y:ae==null?void 0:ae.end)!=null?k:ct,de=s.paddingStart,fe=at(K,n),he=r-fe/2-ne,me=r+fe/2+oe-he,et=(W=s.rounded)!=null?W:(U=i.typeConfig.rectangle)==null?void 0:U.rounded;if(r<e.y+me/2||r>e.y+e.height-me/2)return;n.save(),n.fillStyle=o!=null?o:$,n.strokeStyle=o!=null?o:$;const Ne=i.labelBoxMargin.end;n.font=K;const tt=Ke(t,n,K),Xe=Ne-ce,dt=de!==void 0?tt+de+ce:e.width-Xe,Ut=q==="right"?e.x+e.width-Xe-dt:e.x+Xe,yr=q==="right"?e.x+e.width-tt-Ne:Ne;et?tr(n,Ut,he,dt,me,4,!0):n.fillRect(Ut,he,dt,me),n.fillStyle=Z,n.fillText(t,yr,r+fe/2-1),n.restore()}function Vh(n,e,t,r,s,i,a){Oi(n,e,t,r,s,i,a,"transparent")}function jh(n,e,t=ct){return at(n,e)/2+t}const Gh="badge",Bi=4,Ri={badge:Xh,rectangle:Oi,plain:Vh};function Fi(n,e,t,r,s,i){var a,o,l,c,u;const g=t.y,b=t.labelText,P=(a=t.mode)!=null?a:"label",I=(o=t.labelType)!=null?o:Gh,Y=t.description,k=(l=t.textFont)!=null?l:Pt(s),U=t.bgColor,W=(c=t.lineColor)!=null?c:U,q=Ke(Y!=null?Y:"",n,k)+8,K=we(t.y),Z=at(k,n),$=g-Z/2,ne=g+Z/2-$;n.save(),n.fillStyle=U,n.strokeStyle=W;const oe=r.getBounds(B.PANE_UUID(re)),ce=Ri[I],de=s.labels.descriptions,fe=Zh(e,K,ne),he=()=>de&&$h(n,e,t,s.align,s,i);let Fe,me;const et=2;s.align==="right"?(Fe=oe.x,me=de?oe.x+oe.width-q:oe.x+oe.width+et):(Fe=de?oe.x+q:oe.x-et,me=oe.x+oe.width);const Ne=(u=t.lineY)!=null?u:t.y,tt=()=>fe&&mt(n,()=>Rc(n,Fe,Ne,me,Ne,1)),Xe=()=>ce(n,e,b,g,t,s,i,s.align);switch(P){case"line":tt(),he();break;case"line-label":tt(),he(),Xe();break;case"label":he(),Xe();break;case"none":break}n.restore()}const Zh=(n,e,t)=>e>n.y+t/2&&e<n.y+n.height-t/2;function $h(n,e,t,r="right",s,i){var a,o,l,c;const u=t.description;if(!u||u.length===0)return;const g=t.y,b=Pt(s),P=Ke(u,n,b),I=at(b,n),Y=(a=t.paddingTop)!=null?a:Bi,k=(o=t.paddingBottom)!=null?o:Bi,U=g-I/2-Y,q=g+I/2+k-U;if(g<e.y+q/2||g>e.y+e.height-q/2)return;n.save(),n.fillStyle=(l=i==null?void 0:i.labelDescriptionFillColor)!=null?l:"rgba(20, 20, 19, 0.8)",n.strokeStyle="rgba(20, 20, 19, 0.8)";const K=P+5,Z=4,$=P+Z*2,ae=r==="right"?e.x-$:e.x+e.width;tr(n,ae,U,K,q,0,!0),n.fillStyle=(c=t.descColor)!=null?c:t.bgColor,n.font=b;const ne=r==="right"?e.x-P-Z*2:e.x+e.width+Z*2;n.fillText(u,ne,g+I/2-1),n.restore()}class Kh{constructor(e,t,r,s,i=()=>!0){this.config=e,this.canvasBoundsContainer=t,this.chartModel=r,this.paneManager=s,this.crossDrawPredicate=i}draw(e,t){this.crossDrawPredicate()&&(mt(e,()=>this.drawCrossTool(e,t)),this.drawXLabel(e,t),this.drawYLabel(e,t))}drawCrossTool(e,t){var r,s,i,a;const o=this.canvasBoundsContainer.getBounds(B.ALL_PANES),l=this.canvasBoundsContainer.getBoundsHitTest(B.ALL_PANES,{extensionY:1e-4}),c=(r=this.config.components.xAxis.padding.top)!=null?r:0,u=(i=this.config.components.yAxis.typeConfig[(s=this.config.components.crossTool.yLabel.type)!=null?s:"badge"])==null?void 0:i.paddings,g=(a=u==null?void 0:u.start)!=null?a:0;if(l(t.x,o.y)){const b={start:[o.x,t.y],end:[o.x+o.width+g,t.y]},P={start:[t.x,o.y],end:[t.x,o.y+o.height+c]};e.strokeStyle=this.config.colors.crossTool.lineColor,e.setLineDash(this.config.components.crossTool.lineDash),e.beginPath(),l(t.x,t.y)&&(e.moveTo(...b.start),e.lineTo(...b.end)),e.moveTo(...P.start),e.lineTo(...P.end),e.stroke()}}drawXLabel(e,t){var r,s,i,a,o;const l=this.config.components.crossTool.xLabel.padding,c=this.config.components.crossTool.xLabel.margin,u=this.config.colors.crossTool;if(this.config.components.xAxis.visible){e.font=this.config.components.xAxis.fontSize+"px "+this.config.components.xAxis.fontFamily;const g=t.x,b=t.time,P=e.measureText(b).width,I=this.config.components.xAxis.fontSize,Y=this.canvasBoundsContainer.getBounds(B.X_AXIS);e.save(),e.fillStyle=u.labelBoxColor;const k=(r=l==null?void 0:l.left)!=null?r:0,U=(s=l==null?void 0:l.right)!=null?s:0,W=(i=l==null?void 0:l.top)!=null?i:0,q=(a=l==null?void 0:l.bottom)!=null?a:0,K=(o=c==null?void 0:c.top)!=null?o:0,Z=P+k+U,$=I+W+q,ae=Math.max(g-Z/2,0),ne=Y.y+K;tr(e,ae,ne,Z,$),e.fillStyle=u.labelTextColor;const oe=Math.max(g-P/2,k),ce=Y.y+K+I+W-1;e.fillText(b,oe,ce),e.restore()}}drawYLabel(e,t){const r=this.config.components.crossTool.yLabel.padding,s=this.config.colors.crossTool;if(this.config.components.yAxis.visible){const i=this.getPaneIfHit(t),a=t.y;let o="",l=Un;if(i){const u=i.regularValueFromY(a);o=i.valueFormatter(u),l=this.canvasBoundsContainer.getBounds(B.PANE_UUID_Y_AXIS(i.uuid))}else o=this.chartModel.pane.valueFormatter(this.chartModel.priceFromY(a)),l=this.canvasBoundsContainer.getBounds(B.PANE_UUID_Y_AXIS(re));const c=Ri[this.config.components.crossTool.yLabel.type];c(e,l,o,a,{textColor:s.labelTextColor,bgColor:s.labelBoxColor,paddingBottom:r==null?void 0:r.bottom,paddingEnd:r==null?void 0:r.end,paddingTop:r==null?void 0:r.top},this.config.components.yAxis,this.config.colors.yAxis)}}getPaneIfHit(e){return Object.values(this.paneManager.paneComponents).find(r=>this.canvasBoundsContainer.getBoundsHitTest(B.PANE_UUID(r.uuid))(e.x,e.y))}}class qh{draw(){}}class Jh extends ee{constructor(e,t,r,s,i,a,o,l,c,u){super(),this.eventBus=e,this.config=t,this.chartModel=r,this.crossToolCanvasModel=s,this.canvasBoundsContainer=i,this.drawingManager=o,this.paneManager=u,this.crossToolTypeDrawers={},this.model=new Eh(e,t.components.crossTool,this.crossToolCanvasModel,a,r,c,l),this.addChildEntity(this.model);const g=new xt(this.crossToolCanvasModel);this.registerDefaultDrawerTypes();const b=new _h(this.model,this.crossToolCanvasModel,this.crossToolTypeDrawers),P=new ar;P.addDrawer(g,"CLEAR_CANVAS"),P.addDrawer(b,"CROSS_TOOL_DRAWER"),this.drawingManager.addDrawer(P,te.CROSS_TOOL)}registerDefaultDrawerTypes(){this.registerCrossToolTypeDrawer("cross-and-labels",new Kh(this.config,this.canvasBoundsContainer,this.chartModel,this.paneManager,()=>!0)),this.registerCrossToolTypeDrawer("none",new qh)}setVisible(e){this.config.components.crossTool.type=e?"cross-and-labels":"none",this.eventBus.fireDraw([this.crossToolCanvasModel.canvasId])}setType(e){this.model.setType(e)}setMagnetTarget(e){this.config.components.crossTool.magnetTarget=e}registerCrossToolTypeDrawer(e,t){this.crossToolTypeDrawers[e]=t}}const Qh={"rhombus-small":4,rhombus:6,"rhombus-large":8},Yt=(n,e)=>`${n}_${e}`;class eu{constructor(e,t,r,s,i,a,o){this.backgroundCanvas=e,this.canvasModel=t,this.chartModel=r,this.config=s,this.canvasBoundsContainer=i,this.model=a,this.formatterProvider=o,this.customIcons={};const l=this.config.components.events.icons;l&&(this.createCustomIcon("earnings",l.earnings),this.createCustomIcon("dividends",l.dividends),this.createCustomIcon("splits",l.splits),this.createCustomIcon("conference-calls",l.conferenceCalls))}createCustomIcon(e,t){if(t){const r=this.createIconImage(t.normal),s=this.createIconImage(t.hover);this.customIcons[Yt(e,"normal")]=r,this.customIcons[Yt(e,"hover")]=s}}createIconImage(e){var t;const s=new DOMParser().parseFromString(e,"text/html").querySelector("svg");let i=0;s&&(i=parseInt((t=s.getAttribute("height"))!=null?t:"",10));const l="data:image/svg+xml;base64,"+btoa(e),c=new Image;return c.src=l,{img:c,svgHeight:i}}draw(){if(!this.config.components.events.visible)return;const e=this.canvasBoundsContainer.getBounds(B.EVENTS),t=this.canvasBoundsContainer.getBounds(B.ALL_PANES),r=this.canvasModel.ctx;r.save(),this.model.events.filter(s=>this.config.components.events.eventsVisibility[s.type]).forEach(s=>{const i=this.chartModel.candleFromTimestamp(s.timestamp).xCenter(this.chartModel.scaleModel);if(i>t.x&&i<t.x+t.width){const a=this.config.colors.events[s.type].color;r.strokeStyle=a,this.customIcons[Yt(s.type,"hover")]!==void 0?this.drawCustomSvgEvent(r,i,e,s):this.drawDefaultEvent(r,i,e,s,a),this.model.hoveredEvent.getValue()===s&&(r.beginPath(),r.moveTo(i,t.y),r.lineTo(i,e.y+e.height/2),r.stroke(),r.closePath(),this.config.components.xAxis.visible&&this.drawLabel(i,s))}}),r.restore()}drawCustomSvgEvent(e,t,r,s){const i=r.y+r.height/2,a=this.customIcons[Yt(s.type,"normal")],o=this.customIcons[Yt(s.type,"hover")];this.model.hoveredEvent.getValue()===s?e.drawImage(o.img,t-o.svgHeight/2,i-o.svgHeight/2):e.drawImage(a.img,t-a.svgHeight/2,i-a.svgHeight/2)}drawDefaultEvent(e,t,r,s,i){const a=r.y+r.height/2;e.fillStyle=i,e.lineWidth=1.5;const o=hr(s);e.beginPath(),e.moveTo(t-o,a),e.lineTo(t,a-o),e.lineTo(t+o,a),e.lineTo(t,a+o),e.closePath(),this.model.hoveredEvent.getValue()===s?e.fill():e.stroke()}drawLabel(e,t){var r;const s=this.canvasModel.ctx,i=this.canvasBoundsContainer.getBounds(B.X_AXIS),a=this.config.components.xAxis.fontFamily,o=this.config.components.xAxis.fontSize,l=(r=this.config.components.xAxis.padding.top)!=null?r:0,c=i.y+o-1+l;s.font=`${o}px ${a}`;const u=this.formatterProvider()(t.timestamp),g=s.measureText(u).width;Os(this.backgroundCanvas.ctx,s,e-g/2,i.y+1,g,i.height-1),s.fillStyle=this.config.colors.events[t.type].color,s.fillText(u,e-g/2,c)}getCanvasIds(){return[this.canvasModel.canvasId]}}function hr(n){return Qh[n.style]}const dn=5;class tu{constructor(e,t,r,s,i){this.hitTestCanvasModel=e,this.chartModel=t,this.config=r,this.canvasBoundsContainer=s,this.model=i}draw(){const e=this.hitTestCanvasModel.ctx,t=this.canvasBoundsContainer.getBounds(B.EVENTS);e.save(),this.model.events.forEach((r,s)=>{const i=this.model.events[s-1],a=i&&this.chartModel.candleFromTimestamp(i.timestamp).xCenter(this.chartModel.scaleModel),o=this.chartModel.candleFromTimestamp(r.timestamp).xCenter(this.chartModel.scaleModel);if(o>t.x&&o<t.x+t.width){const l=this.config.colors.events[r.type].color;e.strokeStyle=l,e.fillStyle=l;const c=hr(r);e.fillStyle=this.hitTestCanvasModel.idToColor(r.id);const u=(c+dn)*2;if(a!==void 0){const g=hr(i);if(a+g>o-u/2){const P=c*2+dn;e.fillRect(a+g,t.y,P,t.height)}else e.fillRect(o-c-dn,t.y,u,t.height)}else e.fillRect(o-c-dn,t.y,u,t.height)}}),e.restore()}getCanvasIds(){return[this.hitTestCanvasModel.canvasId]}}var nu=function(n){N(e,n);function e(t,r){return n.call(this)||this}return e.prototype.schedule=function(t,r){return r===void 0&&(r=0),this},e}(pe),fn={setInterval:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var s=fn.delegate;return s!=null&&s.setInterval?s.setInterval.apply(s,v([n,e],_(t))):setInterval.apply(void 0,v([n,e],_(t)))},clearInterval:function(n){var e=fn.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0},ru=function(n){N(e,n);function e(t,r){var s=n.call(this,t,r)||this;return s.scheduler=t,s.work=r,s.pending=!1,s}return e.prototype.schedule=function(t,r){var s;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var i=this.id,a=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(a,i,r)),this.pending=!0,this.delay=r,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(a,this.id,r),this},e.prototype.requestAsyncId=function(t,r,s){return s===void 0&&(s=0),fn.setInterval(t.flush.bind(t,this),s)},e.prototype.recycleAsyncId=function(t,r,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return r;r!=null&&fn.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(t,r);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var s=!1,i;try{this.work(t)}catch(a){s=!0,i=a||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,s=t.scheduler,i=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,xe(i,this),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e}(nu),ur={now:function(){return(ur.delegate||Date).now()},delegate:void 0},Ni=function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=ur.now,n}(),su=function(n){N(e,n);function e(t,r){r===void 0&&(r=Ni.now);var s=n.call(this,t,r)||this;return s.actions=[],s._active=!1,s}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var s;this._active=!0;do if(s=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,s){for(;t=r.shift();)t.unsubscribe();throw s}},e}(Ni),Yi=new su(ru),iu=Yi,Hi={leading:!0,trailing:!1};function au(n,e){return e===void 0&&(e=Hi),x(function(t,r){var s=e.leading,i=e.trailing,a=!1,o=null,l=null,c=!1,u=function(){l==null||l.unsubscribe(),l=null,i&&(P(),c&&r.complete())},g=function(){l=null,c&&r.complete()},b=function(I){return l=je(n(I)).subscribe(Re(r,u,g))},P=function(){if(a){a=!1;var I=o;o=null,r.next(I),!c&&b(I)}};t.subscribe(Re(r,function(I){a=!0,o=I,!(l&&!l.closed)&&(s?P():b(I))},function(){c=!0,!(i&&a&&l&&!l.closed)&&r.complete()}))})}function ou(n){return n instanceof Date&&!isNaN(n)}function lu(n,e,t){n===void 0&&(n=0),t===void 0&&(t=iu);var r=-1;return e!=null&&(Yr(e)?t=e:r=e),new ye(function(s){var i=ou(n)?+n-t.now():n;i<0&&(i=0);var a=0;return t.schedule(function(){s.closed||(s.next(a++),0<=r?this.schedule(void 0,r):s.complete())},i)})}function dr(n,e,t){e===void 0&&(e=Yi),t===void 0&&(t=Hi);var r=lu(n,e);return au(function(){return r},t)}var cu=Object.defineProperty,ki=Object.getOwnPropertySymbols,hu=Object.prototype.hasOwnProperty,uu=Object.prototype.propertyIsEnumerable,Ui=(n,e,t)=>e in n?cu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,du=(n,e)=>{for(var t in e||(e={}))hu.call(e,t)&&Ui(n,t,e[t]);if(ki)for(var t of ki(e))uu.call(e,t)&&Ui(n,t,e[t]);return n};const zi=317,fr={DRAWINGS:[0,199],NEWS:[200,299],DATA_SERIES:[300,2999],EVENTS:[3e3,4e3]};class fu extends pi{constructor(e,t,r,s,i,a,o,l){super(e,t,i,o,l,{willReadFrequently:!0,desynchronized:!0}),this.canvasInputListener=r,this.canvasBoundsContainer=s,this.hitTestSubscribers=[],this.eventsSubscriptions=[],this.hoverSubject=new G,this.touchStartSubject=new G,this.dblClickSubject=new G,this.rightClickSubject=new G,mi(this,a),t.style.visibility="hidden",this.enableUserControls()}enableUserControls(){if(this.eventsSubscriptions.length===0){const e=this.canvasBoundsContainer.getBoundsHitTest(B.ALL_PANES),t=this.canvasInputListener.observeMouseMove().pipe(dr(30)).subscribe(l=>this.eventHandler(l,"hover")),r=this.canvasInputListener.observeTouchStart().pipe(Ce(()=>this.canvasInputListener.currentPoint)).subscribe(l=>this.eventHandler(l,"touchstart")),s=Ee(this.canvasInputListener.observeMouseDown(e),this.canvasInputListener.observeTouchStart().pipe(Ce(()=>this.canvasInputListener.currentPoint))).subscribe(l=>this.eventHandler(l,"mousedown")),i=this.canvasInputListener.observeDbClick(e).subscribe(l=>this.eventHandler(l,"dblclick")),a=this.canvasInputListener.observeContextMenu(e).pipe(Ce(()=>du({},this.canvasInputListener.currentPoint))).subscribe(l=>{this.eventHandler(l,"contextmenu")}),o=this.canvasInputListener.observeWheel(e).subscribe(l=>setTimeout(()=>this.eventHandler(l,"zoom"),0));this.eventsSubscriptions.push(t,s,i,a,o,r)}}disableUserControls(){this.eventsSubscriptions.forEach(e=>e.unsubscribe()),this.eventsSubscriptions=[]}addSubscriber(e){this.hitTestSubscribers.push(e)}removeSubscriber(e){this.hitTestSubscribers=this.hitTestSubscribers.filter(t=>t===e)}idToColor(e){const t=(e*zi).toString(16);return"#000000".substr(0,7-t.length)+t}colorToId(e){return e/zi}observeHoverOnElement(){return this.hoverSubject.asObservable()}observeTouchStartOnElement(){return this.touchStartSubject.asObservable()}observeDblClickOnElement(){return this.dblClickSubject.asObservable()}observeRightClickOnElement(){return this.rightClickSubject.asObservable()}getPixel(e,t){const r=window.devicePixelRatio;return this.ctx.getImageData(e*r,t*r,1,1).data}resolveCursor(e){var t;const r=this.getPixel(e.x,e.y),s=this.colorToId(r[0]*65536+r[1]*256+r[2]),i=Number(s),[a]=Wi(this.hitTestSubscribers,i),o=a==null?void 0:a.lookup(s);return(t=a==null?void 0:a.resolveCursor)==null?void 0:t.call(a,e,o)}eventHandler(e,t){var r,s,i,a,o,l;const c=this.getPixel(e.x,e.y),u=this.colorToId(c[0]*65536+c[1]*256+c[2]),g=Number(u),[b,P]=Wi(this.hitTestSubscribers,g),I=b==null?void 0:b.lookup(u),Y={point:e,model:I};switch(t){case"mousedown":I&&((r=b==null?void 0:b.onMouseDown)==null||r.call(b,I,e)),P.forEach(k=>k.onMouseDown&&k.onMouseDown(null,e));break;case"hover":I&&((s=b==null?void 0:b.onHover)==null||s.call(b,I,e)),P.forEach(k=>k.onHover&&k.onHover(null,e)),this.hoverSubject.next(Y);break;case"touchstart":I&&((i=b==null?void 0:b.onTouchStart)==null||i.call(b,I,e)),P.forEach(k=>k.onTouchStart&&k.onTouchStart(null,e)),this.touchStartSubject.next(Y);break;case"dblclick":I&&((a=b==null?void 0:b.onDblClick)==null||a.call(b,I,e)),this.dblClickSubject.next(Y);break;case"contextmenu":I&&((o=b==null?void 0:b.onRightClick)==null||o.call(b,I,e)),this.rightClickSubject.next(Y);break;case"zoom":I&&((l=b==null?void 0:b.onZoom)==null||l.call(b,I,e)),P.forEach(k=>k.onZoom&&k.onZoom(null,e));break;default:break}}}const Wi=(n,e)=>{let t;const r=[];return n.forEach(s=>{const[i,a]=s.getIdRange();e>=i&&e<=a?t=s:r.push(s)}),[t,r]};var vu=Object.defineProperty,gu=Object.defineProperties,pu=Object.getOwnPropertyDescriptors,Xi=Object.getOwnPropertySymbols,mu=Object.prototype.hasOwnProperty,bu=Object.prototype.propertyIsEnumerable,Vi=(n,e,t)=>e in n?vu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wu=(n,e)=>{for(var t in e||(e={}))mu.call(e,t)&&Vi(n,t,e[t]);if(Xi)for(var t of Xi(e))bu.call(e,t)&&Vi(n,t,e[t]);return n},Cu=(n,e)=>gu(n,pu(e));class yu extends ee{constructor(e){super(),this.canvasModel=e,this.events=[],this.hoveredEvent=new On(null)}setEvents(e){this.events=this.indexEvents(e)}indexEvents(e){const t=this.getIdRange()[0];return e.map((r,s)=>Cu(wu({},r),{id:s+t})).sort((r,s)=>r.timestamp-s.timestamp)}getIdRange(){return fr.EVENTS}lookup(e){return this.events.filter(t=>t.id===e)[0]}onHover(e,t){this.hoveredEvent.getValue()!==e&&(e&&(e.point=t),this.hoveredEvent.next(e||null),this.canvasModel.fireDraw())}onTouchStart(e,t){this.onHover(e,t)}}class Su extends ee{constructor(e,t,r,s,i,a,o,l,c){super(),this.config=e,this.canvasModel=t,this.canvasBoundsContainer=i,this.drawingManager=a,this.formatterFactory=o,this.eventsXAxisLabelFormatterProvider=()=>Ti(this.config.components.events.xAxisLabelFormat,s.getPeriod(),this.formatterFactory);const u=new yu(t);this.eventsModel=u,this.addChildEntity(u),r.addSubscriber(u);const g=new eu(c,t,s,e,i,u,this.eventsXAxisLabelFormatterProvider);this.drawingManager.addDrawer(g,te.EVENTS);const b=new tu(r,s,e,i,u);this.drawingManager.addDrawerBefore(b,te.HIT_TEST_EVENTS,te.HIT_TEST_DRAWINGS),l.addCursorForCanvasEl(B.EVENTS,e.components.events.cursor)}setEvents(e){this.eventsModel.setEvents(e),this.canvasModel.fireDraw()}setVisible(e){this.config.components.events.visible=e,this.canvasBoundsContainer.recalculateBounds(),this.canvasModel.fireDraw()}setEventTypeVisible(e){He(this.config.components.events.eventsVisibility,e,{overrideExisting:!0,addIfMissing:!1}),this.canvasModel.fireDraw()}observeEventHovered(){return this.eventsModel.hoveredEvent.asObservable()}}class Mu{constructor(e,t,r,s,i,a,o,l=()=>!0,c){this.canvasModel=e,this.viewportModel=t,this.config=r,this.xBoundsProvider=s,this.yBoundsProvider=i,this.xLabelsProvider=a,this.yLabelsProvider=o,this.drawPredicate=l,this.getBaseLine=c}draw(){if(this.drawPredicate()){const e=this.canvasModel.ctx;mt(e,()=>this.drawVertical(e)),mt(e,()=>this.drawHorizontal(e)),mt(e,()=>this.drawZeroLine(e))}}drawZeroLine(e){if(this.getBaseLine&&this.config.components.yAxis.type==="percent"&&this.config.components.yAxis.zeroPercentLine){const t=this.xBoundsProvider(),r=this.getBaseLine();e.beginPath(),e.strokeStyle=this.config.colors.yAxis.zeroPercentLine,e.setLineDash([]),e.moveTo(t.x,r),e.lineTo(t.x+t.width,r),e.stroke(),e.closePath()}}drawVertical(e){const t=this.xLabelsProvider();if(t.length&&this.config.components.grid.vertical){e.lineWidth=this.config.components.grid.width,e.strokeStyle=this.config.colors.chartAreaTheme.gridColor,e.setLineDash(this.config.components.grid.dash||[]);const r=this.xBoundsProvider(),s=r.x+r.width;for(const i of t){const a=this.viewportModel.toX(i.value);a>r.x&&a<s&&(e.beginPath(),e.moveTo(a,r.y),e.lineTo(a,r.y+r.height),e.stroke())}}}drawHorizontal(e){const t=this.yLabelsProvider();if(t.length&&this.config.components.grid.horizontal){e.lineWidth=this.config.components.grid.width,e.strokeStyle=this.config.colors.chartAreaTheme.gridColor,e.setLineDash(this.config.components.grid.dash||[]);const r=this.yBoundsProvider();for(const s of t){const i=this.viewportModel.toY(s.value),a=jh(s.text,e,ct);i>r.y+a&&i<r.y+r.height-a&&(e.beginPath(),e.moveTo(r.x,i),e.lineTo(r.x+r.width,i),e.stroke())}}}getCanvasIds(){return[this.canvasModel.canvasId]}}class ji extends ee{constructor(e,t,r,s,i,a,o,l,c,u,g){super(),this.drawerName=s,this.drawingManager=i,this.drawer=new Mu(e,t,r,a,o,l,c,g,u)}doDeactivate(){super.doDeactivate(),this.drawingManager.removeDrawer(this.drawer)}doActivate(){super.doActivate(),this.drawingManager.addDrawer(this.drawer,this.drawerName)}}class _u{constructor(e,t,r,s){this.canvasModel=e,this.chartModel=t,this.config=r,this.canvasBoundsContainer=s}draw(){if(this.config.components.highLow.visible&&this.chartModel.isReady()){const{high:e,low:t,highIdx:r,lowIdx:s}=this.chartModel.mainCandleSeries.zippedHighLow,i=this.chartModel.mainCandleSeries.dataIdxStart,a=i+r,o=i+s,l=this.canvasModel.ctx;l.save(),l.font=this.config.components.highLow.font,this.drawMarkerLabel(l,a,e,"high"),this.drawMarkerLabel(l,o,t,"low"),l.restore()}}drawMarkerLabel(e,t,r,s){const i=this.getMarkerY(e,r,s==="low");if(!this.checkMarkerInBounds(i))return;const a=this.getMarkerText(r,s),o=this.getMarkerX(e,t,a);e.fillStyle=s==="high"?this.config.colors.highLowTheme.highColor:this.config.colors.highLowTheme.lowColor,e.fillText(a,o,i)}getMarkerText(e,t){const r=this.chartModel.pane.regularFormatter(e);return`${t==="high"?"H:":"L:"} ${r}`}getMarkerY(e,t,r=!1){const s=this.chartModel.toY(t);if(r){const i=Rn(e);return s+i}return s}checkMarkerInBounds(e){const t=this.canvasBoundsContainer.getBounds(B.CHART);return e>t.y&&e<t.y+t.height}getMarkerX(e,t,r){let s=this.chartModel.toX(t);const i=this.canvasBoundsContainer.getBounds(B.CHART),a=4,o=e.measureText(r).width;return s+a+o>i.width&&(s=s-(a+o)),s+a}getCanvasIds(){return[this.canvasModel.canvasId]}}class xu extends ee{constructor(e,t,r,s,i){super();const a=new _u(t,r,e,s);i.addDrawer(a,te.HIGH_LOW)}}const Pu=["AFTER_MARKET","PRE_MARKET","NO_TRADING","REGULAR"],Tu=24*60*60*1e3;class Au extends ee{constructor(e){super(),this.chartModel=e,this.highlights=[],this.visualHighlights={},this.highlightsUpdatedSubject=new G}activate(){this.addRxSubscription(this.chartModel.scaleModel.xChanged.subscribe(()=>this.highlights.length&&this.recalculateVisualHighlights()))}getHighlights(){return this.highlights}getVisualHighlights(){return this.visualHighlights}recalculateVisualHighlights(){this.visualHighlights={};const e=this.chartModel.getFirstTimestamp(),t=this.chartModel.getLastTimestamp()+Tu;go(this.highlights,e,t,Eu).forEach(s=>{var i;this.visualHighlights[s.type]||(this.visualHighlights[s.type]=[]),(i=this.visualHighlights[s.type])==null||i.push(s)})}setHighlights(e){this.highlights=e,this.highlights.sort((t,r)=>t.to-r.to),this.highlightsUpdatedSubject.next(this.highlights),this.highlights.length?this.recalculateVisualHighlights():this.visualHighlights={}}observeHighlightsUpdated(){return this.highlightsUpdatedSubject.asObservable()}}const Eu=n=>n.to,ht=[20,10];class Du{constructor(e,t,r,s,i){this.highlightsModel=e,this.chartModel=t,this.canvasModel=r,this.canvasBoundsContainer=s,this.config=i}draw(){var e,t,r,s;if(this.config.components.highlights.visible){const i=this.chartModel.getCandles(),a=this.canvasModel.ctx,o=this.highlightsModel.getVisualHighlights();if(this.highlightsModel.getHighlights().length&&i.length!==0&&this.chartModel.scaleModel.isScaleReady()){const c=this.canvasBoundsContainer.getBounds(B.ALL_PANES);a.save(),gt(a,c);const u=(e=this.config.components.highlights.border.width)!=null?e:1,g=(t=this.config.components.highlights.border.dash)!=null?t:[0,0],b=(r=this.config.components.highlights.fontSize)!=null?r:11,P=(s=this.config.components.highlights.fontFamily)!=null?s:"monospace",I=`${b}px ${P}, monospace`;a.font=I,a.lineWidth=u,a.setLineDash(g),Pu.forEach(Y=>{var k,U;const W=o[Y];if(W){const q=this.config.colors.highlights[Y],K=(k=q==null?void 0:q.border)!=null?k:"#ffffff",Z=(U=q==null?void 0:q.background)!=null?U:"#ffffff";a.save(),a.beginPath(),a.fillStyle=Z,a.strokeStyle=K,W.forEach($=>{var ae,ne,oe;const ce=this.chartModel.candleFromTimestamp($.from),de=Me(ce.width,this.chartModel.scaleModel.zoomX),fe=ce.xStart(this.chartModel.scaleModel),he=this.chartModel.candleFromTimestamp($.to),Fe=Me(he.width,this.chartModel.scaleModel.zoomX),me=he.xStart(this.chartModel.scaleModel)+Fe;if($.border&&this.drawBorders($.border,a,fe+de,me-Fe,c),a.fillRect(fe,c.y,me-fe,c.y+c.height),$.label){const et=(ae=$.label.text)!=null?ae:"",Ne=this.config.colors.highlights[$.type];a.save(),a.fillStyle=(ne=Ne==null?void 0:Ne.label)!=null?ne:"#ffffff";const tt=Ke(et,a,I),[Xe,dt]=this.resolveHighlightLabelPosition((oe=$.label.placement)!=null?oe:"left-left",c,[fe,me],tt);a.fillText(et,Xe,dt),a.restore()}}),a.closePath(),a.restore()}}),a.restore()}}}resolveHighlightLabelPosition(e,t,r,s){const[i,a]=r;switch(e){case"right-left":return[a-ht[1]-s,t.y+ht[0]];case"left-left":return[i-ht[1]-s,t.y+ht[0]];case"right-right":return[a+ht[1],t.y+ht[0]];case"left-right":default:return[i+ht[1],t.y+ht[0]]}}drawBorders(e,t,r,s,i){const a=e.left,o=e.right;a&&(t.beginPath(),t.moveTo(r,i.y),t.lineTo(r,i.y+i.height),t.stroke(),t.closePath()),o&&(t.beginPath(),t.moveTo(s,i.y),t.lineTo(s,i.y+i.height),t.stroke(),t.closePath())}getCanvasIds(){return[this.canvasModel.canvasId]}}const Lu="HIGHLIGHTS_PLUGIN";class Iu extends ee{constructor(e,t,r,s,i,a){super(),this.eventBus=e,this.config=t,this.highlightsModel=new Au(r),this.addChildEntity(this.highlightsModel),this.highLightsDrawer=new Du(this.highlightsModel,r,s,i,t),a.addDrawer(this.highLightsDrawer,Lu)}getHighlights(){return this.highlightsModel.getHighlights()}setHighlights(e){this.highlightsModel.setHighlights(e)}setHighlightsVisible(e=!0){this.config.components.highlights.visible=e,this.eventBus.fireDraw(this.highLightsDrawer.getCanvasIds())}observeHighlightsUpdated(){return this.highlightsModel.observeHighlightsUpdated()}}function Ou(){return x(function(n,e){var t,r=!1;n.subscribe(Re(e,function(s){var i=t;t=s,r&&e.next([i,s]),r=!0}))})}var Bu=Object.defineProperty,Ru=Object.defineProperties,Fu=Object.getOwnPropertyDescriptors,Gi=Object.getOwnPropertySymbols,Nu=Object.prototype.hasOwnProperty,Yu=Object.prototype.propertyIsEnumerable,Zi=(n,e,t)=>e in n?Bu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$i=(n,e)=>{for(var t in e||(e={}))Nu.call(e,t)&&Zi(n,t,e[t]);if(Gi)for(var t of Gi(e))Yu.call(e,t)&&Zi(n,t,e[t]);return n},Ki=(n,e)=>Ru(n,Fu(e));const Je=4;class Hu{constructor(e,t,r,s,i,a){this.config=e,this.chartModel=t,this.canvasModel=r,this.canvasBoundsContainer=s,this.formatterFactory=i,this.visualCandlesProvider=a}draw(){if(this.config.components.navigationMap.visible){const e=this.visualCandlesProvider();if(e.length){const t=this.canvasBoundsContainer.getBounds(B.N_MAP),r=this.canvasBoundsContainer.getBounds(B.N_MAP_BTN_L),s=this.canvasBoundsContainer.getBounds(B.N_MAP_BTN_R),i=this.canvasBoundsContainer.getBounds(B.N_MAP_KNOT_L),a=this.canvasBoundsContainer.getBounds(B.N_MAP_KNOT_R),o=this.canvasBoundsContainer.getBounds(B.N_MAP_SLIDER_WINDOW),l=this.canvasBoundsContainer.getBounds(B.N_MAP_CHART),c=this.canvasModel.ctx;c.fillStyle=this.config.colors.navigationMap.backgroundColor,c.fillRect(t.x,t.y,t.width,t.height),c.strokeStyle=this.config.colors.paneResizer.lineColor,c.lineWidth=1,c.beginPath(),c.moveTo(t.x,t.y),c.lineTo(t.x+t.width,t.y),c.closePath(),c.stroke(),r.width!==0&&this.drawLeftArrowButton(c,r,this.config),s.width!==0&&this.drawRightArrowButton(c,s,this.config),c.fillStyle=this.config.colors.navigationMap.mapFillColor,c.beginPath(),c.moveTo(l.x,l.y+l.height);for(const u of e)c.lineTo(u[0],u[1]);if(c.lineTo(l.x+l.width,l.y+l.height),c.lineTo(l.x,l.y+l.height),c.closePath(),this.config.colors.navigationMap.mapGradientTopColor&&this.config.colors.navigationMap.mapGradientBottomColor){const u=c.createLinearGradient(l.x,l.y,l.x,l.y+l.height);u.addColorStop(0,this.config.colors.navigationMap.mapGradientTopColor),u.addColorStop(1,this.config.colors.navigationMap.mapGradientBottomColor),c.fillStyle=u}c.fill(),this.config.colors.navigationMap.mapColor&&(c.strokeStyle=this.config.colors.navigationMap.mapColor,c.stroke()),this.drawSlider(c,i,a,r,o),this.drawTimeLabels(c)}}}blockDrawSliderOnLeftArrow(e,t,r,s){e.x<=r.x+r.width&&(e.x=r.x+r.width,s.x=e.x+e.width,t.x=s.x+s.width)}drawSlider(e,t,r,s,i){this.blockDrawSliderOnLeftArrow(t,r,s,i),this.drawKnotButton(e,t,this.config,!0),this.drawKnotButton(e,r,this.config,!1),e.fillStyle=this.config.colors.navigationMap.sliderColor,e.fillRect(i.x,i.y,i.width,i.height)}drawLeftArrowButton(e,t,r){e.fillStyle=r.colors.navigationMap.buttonColor,e.fillRect(t.x,t.y,t.width,t.height),e.beginPath();const s=Math.round(t.x+t.width/2-Je/2),i=Math.round(t.y+t.height/2);e.moveTo(s,i),e.lineTo(s+Je,i+Je),e.lineTo(s+Je,i-Je),e.fillStyle=r.colors.navigationMap.buttonArrowColor,e.fill()}drawRightArrowButton(e,t,r){e.fillStyle=r.colors.navigationMap.buttonColor,e.fillRect(t.x,t.y,t.width,t.height),e.beginPath();const s=Math.round(t.x+t.width/2-Je/2),i=Math.round(t.y+t.height/2);e.moveTo(s,i-Je),e.lineTo(s,i+Je),e.lineTo(s+Je,i),e.fillStyle=r.colors.navigationMap.buttonArrowColor,e.fill()}drawKnotButton(e,t,r,s){const i=r.components.navigationMap.knots.border;e.fillStyle=r.colors.navigationMap.knotColor;const a=s?t.x-i:t.x+i;e.fillRect(a,t.y,t.width,t.height),e.lineWidth=r.components.navigationMap.knots.lineWidth,i>0&&(e.beginPath(),e.moveTo(a,t.y),e.lineTo(a,t.y+t.height),e.lineTo(a+t.width,t.y+t.height),e.lineTo(a+t.width,t.y),e.lineTo(a,t.y),e.lineWidth=i,e.strokeStyle=r.colors.navigationMap.knotBorderColor,e.stroke()),e.beginPath(),e.moveTo(a+t.width/2,t.y+t.height/4),e.lineTo(a+t.width/2,t.y+3*t.height/4),e.strokeStyle=r.colors.navigationMap.knotLineColor,e.stroke()}drawTimeLabels(e){const t=this.chartModel.mainCandleSeries.getSeriesInViewport().flat(),r=this.config.components.navigationMap.timeLabels,s=r.visible;if(t.length&&s){const i=t[0].candle.timestamp,a=t[t.length-1].candle.timestamp,o=this.canvasBoundsContainer.getBounds(B.N_MAP_LABEL_L),l=this.canvasBoundsContainer.getBounds(B.N_MAP_LABEL_R),u={textFill:this.config.colors.navigationMap.timeLabelsTextColor,textFontFamily:r.fontFamily,textSize:`${r.fontSize}px`},g={dateFormat:r.dateFormat,padding:r.padding,textProperties:Ki($i({},u),{textAlign:"left"})},b={dateFormat:r.dateFormat,padding:r.padding,textProperties:Ki($i({},u),{textAlign:"right"})};this.drawTimeLabel(e,o,i,g),this.drawTimeLabel(e,l,a,b)}}drawTimeLabel(e,t,r,s){const i=s.padding,a=os(r,s.dateFormat,this.formatterFactory);ss(e,s.textProperties);const o=Rn(e),l=as(a);Fo(e,l,t.x+i.x,t.y+o+i.y,s.textProperties)}getCanvasIds(){return[this.canvasModel.canvasId]}}class Ht extends ui{constructor(e,t,r,s,i=hi){super(e,t,r,s,i)}doActivate(){super.doActivate(),this.addRxSubscription(this.canvasInputListener.observeXDragStart(this.hitTest).subscribe(this.onDragStart)),this.addRxSubscription(this.canvasInputListener.observeXDrag().subscribe(this.onDragTick)),this.addRxSubscription(this.canvasInputListener.observeXDragEnd().subscribe(this.onDragEnd))}doDeactivate(){super.doDeactivate()}}const qi=4;class ku extends ee{constructor(e,t,r,s,i,a){super(),this.bus=e,this.chartModel=t,this.scaleModel=r,this.canvasInputListeners=s,this.canvasBoundsContainer=i,this.chartPanComponent=a,this.leftKnotDragStartXRelative=0,this.rightKnotDragStartXRelative=0,this.lastMousePosition=0,this.leftKnotDragStart=P=>{const I=this.canvasBoundsContainer.getBounds(B.N_MAP_CHART);this.leftKnotDragStartXRelative=P.x-I.x-qi},this.leftKnotDragTick=P=>{const{delta:I}=P,k=this.canvasBoundsContainer.getBounds(B.N_MAP_CHART).width,U=(this.leftKnotDragStartXRelative+I)/k;this.canvasBoundsContainer.leftRatio=U,this.scaleModel.setXScale(Math.round(this.chartModel.mainCandleSeries.dataPoints.length*this.canvasBoundsContainer.leftRatio),this.scaleModel.xEnd)},this.rightKnotDragStart=P=>{const I=this.canvasBoundsContainer.getBounds(B.N_MAP_CHART);this.rightKnotDragStartXRelative=P.x-I.x+qi},this.rightKnotDragTick=P=>{const{delta:I}=P,k=this.canvasBoundsContainer.getBounds(B.N_MAP_CHART).width,U=(this.rightKnotDragStartXRelative+I)/k;this.canvasBoundsContainer.rightRatio=U,this.scaleModel.setXScale(this.scaleModel.xStart,Math.round(this.chartModel.mainCandleSeries.dataPoints.length*this.canvasBoundsContainer.rightRatio))},this.sliderDragStart=()=>{this.lastMousePosition=0},this.sliderDragTick=P=>{const{delta:I}=P,Y=this.canvasBoundsContainer.getBounds(B.N_MAP_CHART),k=this.chartModel.mainCandleSeries.meanCandleWidth/(Y.width/this.chartModel.mainCandleSeries.dataPoints.length),U=(this.lastMousePosition-I)*k;this.scaleModel.moveXStart(this.scaleModel.xStart-U),this.lastMousePosition=I};const o=this.canvasBoundsContainer.getBoundsHitTest(B.N_MAP_KNOT_L),l=this.canvasBoundsContainer.getBoundsHitTest(B.N_MAP_KNOT_R),c=new Ht(o,{onDragStart:this.leftKnotDragStart,onDragTick:this.leftKnotDragTick},this.canvasInputListeners,this.chartPanComponent),u=new Ht(l,{onDragStart:this.rightKnotDragStart,onDragTick:this.rightKnotDragTick},this.canvasInputListeners,this.chartPanComponent);this.addChildEntity(c),this.addChildEntity(u);const g=this.canvasBoundsContainer.getBoundsHitTest(B.N_MAP_SLIDER_WINDOW),b=new Ht(g,{onDragStart:this.sliderDragStart,onDragTick:this.sliderDragTick},this.canvasInputListeners,this.chartPanComponent);this.addChildEntity(b)}doActivate(){super.doActivate();const e=this.canvasBoundsContainer.getBoundsHitTest(B.N_MAP_BTN_L);this.addRxSubscription(this.canvasInputListeners.observeClick(e).subscribe(()=>{this.scaleModel.moveXStart(this.scaleModel.xStart-1)})),this.addRxSubscription(this.canvasInputListeners.observeTouchStart(e).subscribe(()=>{this.scaleModel.moveXStart(this.scaleModel.xStart-1)}));const t=this.canvasBoundsContainer.getBoundsHitTest(B.N_MAP_BTN_R);this.addRxSubscription(this.canvasInputListeners.observeClick(t).subscribe(()=>{this.scaleModel.moveXStart(this.scaleModel.xStart+1)})),this.addRxSubscription(this.canvasInputListeners.observeTouchStart(t).subscribe(()=>{this.scaleModel.moveXStart(this.scaleModel.xStart+1)})),this.addRxSubscription(this.scaleModel.xChanged.subscribe(()=>{const r=this.chartModel.mainCandleSeries;this.canvasBoundsContainer.leftRatio=r.dataIdxStart/(r.dataPoints.length-1),this.canvasBoundsContainer.rightRatio=r.dataIdxEnd/(r.dataPoints.length-1),this.canvasBoundsContainer.recalculateNavigationMapElementBounds(),this.bus.fireDraw()}))}}class Uu extends ee{constructor(e,t,r,s,i,a,o,l,c,u){super(),this.eventBus=e,this.chartModel=t,this.canvasModel=r,this.config=s,this.canvasInputListeners=i,this.canvasBoundsContainer=a,this.chartPanComponent=c,this.visualCandles=[];const g=new Hu(s,t,r,a,l,()=>this.visualCandles);o.addDrawer(g,B.N_MAP_CHART),this.navigationMapMoveHandler=new ku(this.eventBus,this.chartModel,this.chartModel.scaleModel,this.canvasInputListeners,this.canvasBoundsContainer,this.chartPanComponent),u.addCursorForCanvasEl(B.N_MAP_CHART,s.components.navigationMap.cursors.chart),u.addCursorForCanvasEl(B.N_MAP_BTN_L,s.components.navigationMap.cursors.buttonLeft),u.addCursorForCanvasEl(B.N_MAP_BTN_R,s.components.navigationMap.cursors.buttonRight),u.addCursorForCanvasEl(B.N_MAP_KNOT_L,s.components.navigationMap.cursors.leftResizer),u.addCursorForCanvasEl(B.N_MAP_KNOT_R,s.components.navigationMap.cursors.rightResizer),u.addCursorForCanvasEl(B.N_MAP_SLIDER_WINDOW,s.components.navigationMap.cursors.slider)}doActivate(){super.doActivate(),this.addRxSubscription(Ee(this.chartModel.observeCandlesChanged(),this.canvasBoundsContainer.observeBoundsChanged(B.N_MAP),this.chartModel.scaleModel.xChanged.pipe(Ou(),le(([e,t])=>{const s=e.start<0||e.end>0,i=t.start<0||t.end>0;return s&&!i||i}))).subscribe(()=>{this.config.components.navigationMap.visible&&(this.visualCandles=this.makeVisualCandles(),this.canvasModel.fireDraw())}))}makeVisualCandles(){var e;const t=this.chartModel.getCandles();if(!t.length)return[];const r=this.chartModel.mainCandleSeries.dataIdxStart,s=this.chartModel.mainCandleSeries.dataIdxEnd,i=Math.round(Math.max(-r,0)),a=Math.max(this.chartModel.getCandlesCountWithRightOffset(),s)+i;let o=Number.NEGATIVE_INFINITY,l=Number.POSITIVE_INFINITY;const c=this.canvasBoundsContainer.getBounds(B.N_MAP_CHART),u=c.width,g=[];let b=0,P,I;for(P=0;P<u;P++)I=we(P*a/u)-i,I in t?(g[P]=t[I].close,b=(e=g[P])!=null?e:0,o=Math.max(o,b),l=Math.min(l,b)):g[P]=0;return o-=l,g.map((Y,k)=>[k+c.x,(o+l-Y)*c.height/o+c.y])}setVisible(e=!0){var t;(t=this.config.components)!=null&&t.navigationMap&&(this.config.components.navigationMap.visible=e,this.eventBus.fire(Xt),this.canvasModel.fireDraw())}}class zu extends ee{constructor(e,t,r){super(),this.scaleModel=e,this.canvasInputListeners=t,this.mainCanvasParent=r,this.touchedCandleIndexes=[0,0]}doActivate(){this.addRxSubscription(this.canvasInputListeners.observeTouchStart().subscribe(e=>this.handleTouchStartEvent(e))),this.addRxSubscription(this.canvasInputListeners.observeTouchMove().subscribe(e=>this.handleTouchMoveEvent(e)))}handleTouchStartEvent(e){e.touches.length===2&&(this.touchedCandleIndexes=this.getXPositions(e).map(t=>this.scaleModel.fromX(t)))}handleTouchMoveEvent(e){e.touches.length===2&&this.pinchHandler(this.touchedCandleIndexes,this.getXPositions(e))}getXPositions(e){const t=this.mainCanvasParent.getBoundingClientRect(),r=[0,0],s=document.body.scrollLeft||document.documentElement.scrollLeft;for(let i=0,a=e.touches.length;i<a;i++){const o=e.touches[i];r[i]=o.pageX-t.left-s}return r}pinchHandler(e,t){const r=(t[0]*e[1]-t[1]*e[0])/(t[0]-t[1]),s=r+(e[0]-e[1])/(t[0]-t[1])*this.scaleModel.getBounds().width;this.scaleModel.setXScale(r,s)}}const Wu=/constructor/i.test(window.HTMLElement)||function(n){return n.toString()==="[object SafariRemoteNotification]"}(!window.safari||typeof safari!="undefined"&&window.safari.pushNotification),Xu=!!window.chrome,vr=typeof InstallTrigger!="undefined",Vu=navigator.platform.indexOf("Win")>-1,Ji=n=>{let e=!1;const{wheelDeltaY:t,wheelDeltaX:r}=n;if(t||r){let s;if(Wu)s=t===n.deltaY*-3||Math.abs(t+Math.sign(t))===Math.abs(Math.round(n.deltaY)*3)||Math.abs(t-Math.sign(t))===Math.abs(Math.round(n.deltaY)*3);else if(Xu){if(s=t+Math.sign(t)===n.deltaY*-3?t+Math.sign(t)===n.deltaY*-3:t===n.deltaY*-3,Vu){const i=Math.round(n.deltaY)===t||Math.abs(Math.round(n.deltaY)+Math.sign(n.deltaY))===Math.abs(t)||Math.abs(Math.round(n.deltaY)-Math.sign(n.deltaY))===Math.abs(t);s=Math.abs(t)===Math.abs(n.deltaY)||i}}else vr?Math.abs(n.deltaY)>Math.abs(n.deltaX)?s=!1:s=r===n.deltaX*-3:s=t===n.deltaY*-3;s&&(e=!0)}else n.deltaMode===0&&(e=!0);return vr&&n.deltaY>=16&&Math.abs(n.deltaY)%16===0&&(e=!1),n.ctrlKey&&(e=!0),e},ju=n=>n.components.yAxis.type==="percent"?n.scale.zoomSensitivity/5:n.scale.zoomSensitivity,Qi=()=>{const n=/Mac|iPod|iPhone|iPad/i.test(navigator.userAgent),t=[/Android/i,/webOS/i,/BlackBerry/i,/Windows Phone/i].some(r=>navigator.userAgent.match(r));return n?"apple":t?"mobile":"other"},eg=(n,e)=>n==="apple"||n==="mobile"?3:e;var gr=Math.pow;class Gu extends ee{constructor(e,t,r,s,i,a,o,l){super(),this.bus=e,this.config=t,this.scaleModel=r,this.mainCanvasParent=s,this.canvasInputListener=i,this.canvasBoundsContainer=a,this.canvasAnimation=o,this.chartPanComponent=l,this.currentPoint={x:0,y:0},this.xDraggedCandlesDelta=0,this.lastXStart=0,this.lastYStart=0,this.wheelTrottleTime=15,this.onXDragStart=()=>{this.canvasAnimation.forceStopAnimation(Gn),this.xDraggedCandlesDelta=0,this.lastXStart=this.scaleModel.xStart},this.onXDragTick=b=>{const{delta:P}=b;this.currentPoint.x=P;const I=ze(P,this.scaleModel.zoomX);this.scaleModel.moveXStart(this.lastXStart-I),this.bus.fireDraw()},this.touchHandler=new zu(this.scaleModel,this.canvasInputListener,this.mainCanvasParent);const c=this.canvasBoundsContainer.getBoundsHitTest(B.PANE_UUID(re)),u=this.canvasBoundsContainer.getBoundsHitTest(B.ALL_PANES);this.registerChartYPanHandler(this.scaleModel,c);const g=new Ht(u,{onDragStart:this.onXDragStart,onDragTick:this.onXDragTick},this.canvasInputListener,this.chartPanComponent,{disableChartPanning:!1});this.addChildEntity(g)}doActivate(){super.doActivate();const e=this.canvasBoundsContainer.getBoundsHitTest(B.ALL_PANES);this.addRxSubscription(Ee(this.canvasInputListener.observeWheel(e),this.canvasInputListener.observePinch(e)).pipe(dr(this.wheelTrottleTime)).subscribe(t=>{const r=Ji(t),s=t.deltaY<0,i=r?ju(this.config):this.config.scale.zoomSensitivity;if(this.config.scale.zoomToCursor){const o=this.canvasBoundsContainer.getBounds(B.CANVAS).width,c=t.offsetX/o;this.scaleModel.zoomXToPercent(c,s,!1,i)}else this.scaleModel.zoomXToEnd(s,i);this.bus.fireDraw()})),this.addRxSubscription(this.canvasInputListener.observeScrollGesture().pipe(dr(this.wheelTrottleTime)).subscribe(t=>{let r=-1;const s=Qi();(s==="apple"||s==="mobile")&&(r=1);let i=0,a=0;if(i+=t.deltaX*r,a+=t.deltaY*-r,i!==0){const o=ze(i,this.scaleModel.zoomX);this.scaleModel.moveXStart(this.scaleModel.xStart-o)}if(!vr&&a!==0)if(this.scaleModel.state.auto)ea({x:i,y:a},this.scaleModel.state.autoScaleDisableOnDrag)&&this.scaleModel.autoScale(!1);else{const o=ze(this.scaleModel.state.inverse?-a:a,this.scaleModel.zoomY);this.scaleModel.moveYStart(this.scaleModel.yStart+o)}this.bus.fireDraw()})),this.touchHandler.activate(),this.addSubscription(this.touchHandler.deactivate.bind(this.touchHandler))}registerChartYPanHandler(e,t){const r=()=>{this.canvasAnimation.forceStopAnimation(Gn),this.currentPoint={x:0,y:0},this.lastYStart=e.yStart},s=a=>{const{delta:o}=a;if(this.currentPoint.y=o,e.state.auto)ea(this.currentPoint,e.state.autoScaleDisableOnDrag)&&e.autoScale(!1);else{const l=ze(e.state.inverse?-o:o,e.zoomY);e.moveYStart(this.lastYStart+l)}},i=new on(t,{onDragTick:s,onDragStart:r},this.canvasInputListener,this.chartPanComponent,{disableChartPanning:!1});return this.addChildEntity(i),i}}const ea=(n,e)=>{if(!e.enabled)return!1;const t=Math.abs(n.y),r=gr(gr(Math.abs(n.x),2)+gr(t,2),.5),s=Math.abs(Math.acos(t/r));return t>e.yDiff&&s<e.edgeAngle};class Zu extends ee{constructor(e,t,r,s,i,a,o){super(),this.eventBus=e,this.mainScaleModel=t,this.canvasBoundsContainer=r,this.config=s,this.canvasAnimation=i,this.canvasInputListener=a,this.mainCanvasParent=o,this.chartPanComponents=[],this.chartAreaPanHandler=new Gu(this.eventBus,this.config,this.mainScaleModel,this.mainCanvasParent,this.canvasInputListener,this.canvasBoundsContainer,this.canvasAnimation,this),this.chartPanComponents.push(this.chartAreaPanHandler)}doActivate(){this.activateChartPanHandlers()}doDeactivate(){this.deactivatePanHandlers()}activateChartPanHandlers(){this.chartPanComponents.forEach(e=>e.activate())}deactivatePanHandlers(){this.chartPanComponents.forEach(e=>e.deactivate())}}function $u(){return Fr(1)}function ta(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return $u()(Wt(n,zt(n)))}function Ku(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=zt(n);return x(function(r,s){(t?ta(n,r,t):ta(n,r)).subscribe(s)})}function qu(n){return le(function(e,t){return n<=t})}class Ju{constructor(e,t,r,s,i,a){this.config=e,this.boundsProvider=t,this.canvasModel=r,this.canvasAnimation=s,this.animationId=i,this.canvasBoundsContainer=a}draw(){if(this.config.components.paneResizer.visible){const e=this.config.components.paneResizer.fixedMode,t=this.boundsProvider(),r=this.canvasModel.ctx,s=this.canvasAnimation.getColorAlphaAnimation(this.animationId),i=this.config.components.paneResizer.dragZone;let a=0;this.canvasBoundsContainer&&(a=this.canvasBoundsContainer.getBounds(B.Y_AXIS).width);const o=this.config.components.yAxis.align==="left"?a:0,l=this.config.components.yAxis.align==="left"?a:0;!e&&s&&(r.fillStyle=s.getColor(0),r.fillRect(t.x-o,t.y-i,t.width+l,t.height+2*i)),r.fillStyle=this.config.colors.paneResizer.lineColor,this.config.animation.paneResizer.bgMode?r.fillRect(t.x-o,t.y,t.width+l,t.height):r.fillRect(t.x-o,t.y-i,t.width+l,t.height+2*i)}}getCanvasIds(){return[this.canvasModel.canvasId]}}class Qu extends ee{constructor(e,t,r,s,i,a,o,l,c,u,g){super(),this.id=e,this.boundsProvider=t,this.hitTest=r,this.dragTickCb=s,this.chartPanComponent=i,this.canvasModel=a,this.drawingManager=o,this.canvasInputListener=l,this.canvasAnimation=c,this.config=u,this.canvasBoundsContainer=g,this.initialY=0,this.resizeEvent$=new G,this.onYDragStart=()=>{this.config.components.crossTool.type="none",this.initialY=this.boundsProvider().y},this.onYDragEnd=()=>{this.config.components.crossTool.type="cross-and-labels",this.initialY=this.boundsProvider().y,this.canvasBoundsContainer.graphsHeightRatioChangedSubject.next(this.canvasBoundsContainer.graphsHeightRatio)},this.onYDragTick=b=>{const{delta:P,draggedPixels:I}=b;Math.abs(this.initialY-this.boundsProvider().y+I)>=0&&(this.dragTickCb(P),this.resizeEvent$.next())},this.animationId=`${this.id}_RESIZER`}doActivate(){if(super.doActivate(),!this.config.components.paneResizer.fixedMode){const r=new on(this.hitTest,{onDragTick:this.onYDragTick,onDragStart:this.onYDragStart,onDragEnd:this.onYDragEnd},this.canvasInputListener,this.chartPanComponent);this.addChildEntity(r),this.config.animation.paneResizer.enabled&&this.addRxSubscription(this.canvasInputListener.observeMouseEnter(this.hitTest,!0).pipe(Ku(!1),ke(),qu(1)).subscribe(s=>{s?this.handleHoverAnimation("appearing"):this.handleHoverAnimation("fading")}))}const t=new Ju(this.config,this.boundsProvider,this.canvasModel,this.canvasAnimation,this.animationId,this.canvasBoundsContainer);this.drawingManager.addDrawer(t,$r.paneResizer(this.id)),this.addSubscription(()=>this.drawingManager.removeDrawerByName($r.paneResizer(this.id)))}doDeactivate(){super.doDeactivate(),this.resizeEvent$.complete()}handleHoverAnimation(e){let t;this.config.animation.paneResizer.bgMode?(t=this.canvasAnimation.getColorAlphaAnimation(this.animationId),(!t||!t.animationInProgress)&&this.canvasAnimation.startColorAlphaAnimation(this.animationId,[{color:this.config.colors.paneResizer.bgHoverColor,type:e}])):(t=this.canvasAnimation.getColorTransitionAnimation(this.animationId),(!t||!t.animationInProgress)&&this.canvasAnimation.startColorTransitionAnimation(this.animationId,[{startColor:this.config.colors.paneResizer.bgColor,endColor:this.config.colors.paneResizer.bgHoverColor,type:e}],this.config.animation.paneResizer.duration)),t&&t.animationInProgress&&t.revert()}}class na{constructor(e,t,r,s,i,a=()=>!0,o){this.fullConfig=e,this.yAxisState=t,this.canvasModel=r,this.labelsProvider=s,this.axisBounds=i,this.drawPredicate=a,this.toY=o}draw(){if(this.drawPredicate()){const e=this.labelsProvider(),t=this.axisBounds(),r=this.canvasModel.ctx;r.fillStyle=this.getBackgroundColor(),r.fillRect(t.x,t.y,t.width,t.height);const s=Pt(this.yAxisState),i=at(s,r),a=this.getLabelTextColor();r.save(),gt(r,t),this.drawLabels(r,e,t,i,s,a),r.restore()}}drawLabels(e,t,r,s,i,a){e.fillStyle=a,e.font=i;const o=e.measureText("00.0"),l=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent,c=r.y+l,u=r.y+r.height-l;t.forEach(g=>{const b=this.toY(g.value);b>c&&b<u&&ed(e,r,g.text,b,s,i,this.yAxisState.labelBoxMargin.end,this.yAxisState.align)})}getCanvasIds(){return[this.canvasModel.canvasId]}getBackgroundColor(){return this.fullConfig.colors.yAxis.backgroundColor}getLabelTextColor(){return this.fullConfig.colors.chartAreaTheme.axisColor}}const ed=(n,e,t,r,s,i,a,o)=>{const l=o==="right"?e.x+e.width-Ke(t,n,i)-a:e.x+a;n.fillText(t,l,r+s/2-1)},ra=10;class sa extends ee{constructor(e,t,r,s,i,a,o,l){if(super(),this.bus=e,this.viewportModel=s,this.canvasBoundsContainer=a,this.autoScaleCallback=l,this.yAxisDragEndSubject=new G,this.lastYStart=0,this.lastYEnd=0,this.lastYHeight=0,this.lastYPxHeight=0,this.onYDragStart=()=>{this.lastYStart=this.viewportModel.yStart,this.lastYEnd=this.viewportModel.yEnd,this.lastYHeight=this.viewportModel.yEnd-this.viewportModel.yStart,this.lastYPxHeight=this.canvasBoundsContainer.getBounds(B.Y_AXIS).height},this.onYDragTick=c=>{const{delta:u}=c;let g;u<0?g=1/(1+-u/this.lastYPxHeight*(ra-1)):g=1+u/this.lastYPxHeight*(ra-1);const P=(this.lastYHeight*g-this.lastYHeight)/2,I=this.lastYStart-P,Y=this.lastYEnd+P;this.autoScaleCallback(!1),this.viewportModel.setYScale(I,Y),this.bus.fireDraw()},this.onYDragEnd=()=>{this.yAxisDragEndSubject.next()},t.customScale){const c=()=>t.type!=="percent",u=new on(o,{onDragTick:pr(this.onYDragTick,c),onDragStart:pr(this.onYDragStart,c),onDragEnd:pr(this.onYDragEnd,c)},i,r,{disableChartPanning:!1});this.addChildEntity(u),t.customScaleDblClick&&i.observeDbClick(o).subscribe(()=>{l(!0),this.bus.fireDraw()})}}}const pr=(n,e)=>(...t)=>e()&&n(...t),ut=class{static bondFractions(n){if(n>.5)return ut.EMPTY_BOND_FRACTIONS;const e=ge.roundDecimal(1/n);return ut.NDDP_MAP.has(e)?e:ut.EMPTY_BOND_FRACTIONS}static formatBondPrice(n,e,t="'"){const s=ut.bondFractions(e);if(s===ut.EMPTY_BOND_FRACTIONS)return"";const i=ut.NDDP_MAP.get(s);return i===void 0?"":ut.formatBondPriceInner(n,32,i,t)}static formatBondPriceInner(n,e,t,r){if(!isFinite(n))return"";let s="";const i=Math.abs(n);n<0&&(s+="-");const a=Math.trunc(i);s+=a,s+=r;const o=s.length,l=(i-a)*e;l<10&&(s+="0");const c=ge.roundDecimal(l).toString();for(let g=0;g<c.length;g++){const b=c.charAt(g);b>="0"&&b<="9"&&(s+=c.charAt(g))}const u=s.length-o;for(let g=u;g<t;g++)s+="0";for(let g=t;g<u;g++)s=s.slice(0,-1);return s}};let mr=ut;mr.EMPTY_BOND_FRACTIONS=0,mr.NDDP_MAP=new Map([[32,2],[64,3],[128,3],[256,3]]);const td=n=>e=>{let t;typeof e=="number"?t=e:typeof e=="string"?t=Number(e):t=0;const[r]=n.dataSeries;if(r!==void 0){if(r instanceof lt){const i=r.instrument;if(i.bondFraction){const a=rd(i,t);if(a)return a}}const s=Ie.getPricePrecision(t,r.pricePrecisions);return t.toFixed(s)}return`${t}`},nd=n=>(e,t)=>{const[r]=n.dataSeries;let s=e;const i=t!=null?t:r;i!==void 0&&(s=xs(e,i.getBaseLine()));const a=s.toFixed(Ie.DEFAULT_PRECISION).replace("-","\u2212")+" %";return a==="\u22120.00 %"?"0.00 %":a},rd=(n,e)=>{const t=Ie.getPriceIncrement(e,n);if(t){const r=mr.formatBondPrice(e,t,"'");if(r)return r}},sd=n=>({percent:nd(n),regular:td(n)});class ia extends ee{constructor(e,t,r,s,i,a,o,l,c,u=[],g=new Set,b={regular:er}){super(),this.config=e,this.eventBus=t,this.canvasBoundsContainer=r,this.uuid=s,this.scaleModel=i,this.yAxisLabelsGenerator=a,this.yAxisDrawer=o,this.yAxisScaleHandler=l,this.hitTestController=c,this.subs=u,this.dataSeries=g,this.formatters=b,this._paneOrder=0,this.getYAxisBounds=()=>this.canvasBoundsContainer.getBounds(B.PANE_UUID_Y_AXIS(this.uuid)),this.valueFormatter=(P,I)=>{var Y;return((Y=this.formatters[this.getAxisType()])!=null?Y:this.formatters.regular)(P,I)},this.ht=this.canvasBoundsContainer.getBoundsHitTest(B.PANE_UUID(s),{extensionY:-this.config.components.paneResizer.dragZone}),this.setPaneValueFormatters(sd(this))}doActivate(){super.doActivate(),this.addRxSubscription(this.canvasBoundsContainer.observeBoundsChanged(B.PANE_UUID(this.uuid)).pipe(ke(bs)).subscribe(()=>this.scaleModel.recalculateZoomY()))}setDataPoints(e,t){this.dataSeries.has(e)&&(e.dataPoints=t,this.updateView())}updateView(){this.scaleModel.doAutoScale(),this.eventBus.fireDraw()}getBounds(){return this.scaleModel.getBounds()}hide(){this._paneOrder=this.canvasBoundsContainer.panesOrder.indexOf(this.uuid),this.canvasBoundsContainer.removedPaneBounds(this.uuid),this.eventBus.fireDraw()}show(){this.canvasBoundsContainer.addPaneBounds(this.uuid,this._paneOrder),this.eventBus.fireDraw()}createDataSeries(){return new js(this,this.hitTestController.getNewDataSeriesHitTestId())}addDataSeries(e){this.dataSeries.add(e),this.dataSeries.size===1&&(this.mainDataSeries=e),this.updateView()}removeDataSeries(e){this.dataSeries.delete(e),this.updateView()}getAxisType(){return"regular"}moveUp(){this.canvasBoundsContainer.movePaneUp(this.uuid)}moveDown(){this.canvasBoundsContainer.movePaneDown(this.uuid)}canMoveUp(){const e=Ot(this.canvasBoundsContainer.panesOrder);return this.uuid!==e}canMoveDown(){const e=Ue(this.canvasBoundsContainer.panesOrder);return this.uuid!==e}get regularFormatter(){return this.formatters.regular}setPaneValueFormatters(e){this.formatters=e}regularValueFromY(e){var t,r;return(r=(t=this.mainDataSeries)==null?void 0:t.view.priceFromY(e))!=null?r:this.scaleModel.fromY(e)}}const aa=n=>({isHighLowActive:()=>!0,calculateHighLow:e=>{const t=Array.from(n.dataSeries).filter(r=>r.highLowProvider.isHighLowActive()).map(r=>r.highLowProvider.calculateHighLow(e));return Gs(t)}});class id{constructor(e,t){this.paneComponents=e,this.canvasModel=t,this.dataSeriesIdCounter=fr.DATA_SERIES[0],this.getNewDataSeriesHitTestId=()=>this.dataSeriesIdCounter++}getIdRange(){return fr.DATA_SERIES}get allDataSeries(){return Object.values(this.paneComponents).flatMap(e=>Array.from(e.dataSeries))}lookup(e){return this.allDataSeries.find(r=>r.id===e)}onHover(e){this.allDataSeries.forEach(t=>t.hovered=t.id===(e==null?void 0:e.id)),this.canvasModel.fireDraw()}}class ad extends ee{constructor(e,t,r,s,i,a,o,l,c,u,g,b,P){super(),this.userInputListenerComponents=e,this.eventBus=t,this.mainScaleModel=r,this.canvasBoundsContainer=s,this.config=i,this.canvasAnimation=a,this.canvasInputListener=o,this.drawingManager=l,this.dataSeriesCanvasModel=c,this.cursorHandler=u,this.crossEventProducer=g,this.chartPanComponent=b,this.mainCanvasModel=P,this.paneComponents={},this.panesChangedSubject=new G,this.hitTestContoller=new id(this.paneComponents,this.dataSeriesCanvasModel),this.paneComponents[re]=new ia(i,t,this.canvasBoundsContainer,re,r,void 0,void 0,void 0,this.hitTestContoller.getNewDataSeriesHitTestId),r.autoScaleModel.setHighLowProvider("series",aa(this.paneComponents[re]));const I=wl(()=>this.mainScaleModel.getOffsets());r.autoScaleModel.setHighLowPostProcessor("offsets",I),this.canvasBoundsContainer.addPaneBounds(re),this.addResizer(re).activate(),this.addCursors(re),this.addRxSubscription(this.crossEventProducer.subscribeMouseOver(re,[B.PANE_UUID(re)],{extensionY:-this.config.components.paneResizer.dragZone})),this.panesChangedSubject.next(this.paneComponents)}addResizer(e){const t=this.canvasBoundsContainer.getBoundsHitTest(B.PANE_UUID_RESIZER(e),{extensionY:this.config.components.paneResizer.dragZone}),r=()=>{this.canvasBoundsContainer.resizePaneVertically(e,this.canvasInputListener.getCurrentPoint().y),this.eventBus.fireDraw([this.dataSeriesCanvasModel.canvasId,"overDataSeriesCanvas"])},s=B.PANE_UUID_RESIZER(e),i=new Qu(s,()=>this.canvasBoundsContainer.getBounds(s),t,r,this.chartPanComponent,this.dataSeriesCanvasModel,this.drawingManager,this.canvasInputListener,this.canvasAnimation,this.config,this.canvasBoundsContainer);return this.userInputListenerComponents.push(i),i}createPane(e=$e(),t){var r,s,i;if(this.paneComponents[e]!==void 0)return this.paneComponents[e];const a=[],o=()=>this.canvasBoundsContainer.getBounds(B.PANE_UUID(e)),l=(r=t==null?void 0:t.scaleModel)!=null?r:new Lc(this.mainScaleModel,this.config,o,this.canvasAnimation);this.canvasBoundsContainer.addPaneBounds(e,t==null?void 0:t.order),a.push(()=>this.canvasBoundsContainer.removedPaneBounds(e));const c=(s=t==null?void 0:t.paneFormatters)!=null?s:{regular:er},[u,g,b]=this.createYAxisComponent(e,l,c.regular,a,(t==null?void 0:t.increment)||null),P=this.createGridComponent(e,l,u);this.createYPanHandler(e,l,a);const I=new ia(this.config,this.eventBus,this.canvasBoundsContainer,e,l,u,g,b,this.hitTestContoller,a);I.addChildEntity(l),I.setPaneValueFormatters(c),I.addChildEntity(b),I.addChildEntity(P),this.config.components.paneResizer.visible&&I.addChildEntity(this.addResizer(e)),((i=t==null?void 0:t.useDefaultHighLow)!=null?i:!0)&&l.autoScaleModel.setHighLowProvider("default",Ms(()=>({top:10,bottom:10,left:0,right:0,visible:!0}),aa(I))),this.addCursors(e),a.push(()=>this.removeCursors(e));const k=this.crossEventProducer.subscribeMouseOverHT(e,I.ht);return a.push(()=>k.unsubscribe()),this.paneComponents[e]=I,I.activate(),this.recalculateState(),l.autoScale(!0),this.panesChangedSubject.next(this.paneComponents),I}removePane(e){const t=this.paneComponents[e];t!==void 0&&(t.subs.forEach(r=>r()),t.disable(),t.dataSeries.forEach(r=>r.deactivate()),delete this.paneComponents[e],this.recalculateState(),this.panesChangedSubject.next(this.paneComponents))}createYAxisComponent(e,t,r,s,i){const a=new Ai(i,void 0,t,r,()=>"regular",()=>1),o=new na(this.config,this.config.components.yAxis,this.dataSeriesCanvasModel,()=>a.generateNumericLabels(),()=>this.canvasBoundsContainer.getBounds(B.PANE_UUID_Y_AXIS(e)),()=>this.config.components.yAxis.visible,t.toY.bind(t));this.drawingManager.addDrawerAfter(o,B.PANE_UUID_Y_AXIS(e),te.Y_AXIS),s.push(()=>this.drawingManager.removeDrawerByName(B.PANE_UUID_Y_AXIS(e)));const l=sn(this.config.components.yAxis);l.type="regular";const c=new sa(this.eventBus,l,this.chartPanComponent,t,this.canvasInputListener,this.canvasBoundsContainer,this.canvasBoundsContainer.getBoundsHitTest(B.PANE_UUID_Y_AXIS(e)),u=>t.autoScale(u));return this.userInputListenerComponents.push(c),[a,o,c]}createYPanHandler(e,t,r){const s=this.chartPanComponent.chartAreaPanHandler.registerChartYPanHandler(t,this.canvasBoundsContainer.getBoundsHitTest(B.PANE_UUID(e)));r.push(()=>{this.chartPanComponent.chartAreaPanHandler.removeChildEntity(s),s.disable()})}createGridComponent(e,t,r){return new ji(this.mainCanvasModel,t,this.config,`PANE_${e}_grid_drawer`,this.drawingManager,()=>this.canvasBoundsContainer.getBounds(B.PANE_UUID(e)),()=>this.canvasBoundsContainer.getBounds(B.PANE_UUID(e)),()=>[],()=>r.generateNumericLabels())}addCursors(e,t=this.config.components.chart.cursor){const r=B.PANE_UUID(e),s=B.PANE_UUID_Y_AXIS(e),i=B.PANE_UUID_RESIZER(e);this.cursorHandler.addCursorForCanvasEl(r,t),this.config.components.paneResizer.visible&&this.cursorHandler.addCursorForCanvasEl(i,this.config.components.paneResizer.cursor,this.config.components.paneResizer.dragZone),this.cursorHandler.addCursorForCanvasEl(s,this.config.components.yAxis.cursor)}removeCursors(e){const t=B.PANE_UUID(e),r=B.PANE_UUID_Y_AXIS(e),s=B.PANE_UUID_RESIZER(e);this.cursorHandler.removeCursorForCanvasEl(t),this.cursorHandler.removeCursorForCanvasEl(s),this.cursorHandler.removeCursorForCanvasEl(r)}recalculateState(){Object.values(this.paneComponents).forEach(e=>e.scaleModel.recalculateZoomY()),this.eventBus.fireDraw([this.dataSeriesCanvasModel.canvasId,"overDataSeriesCanvas"])}}class od extends ee{constructor(e,t){super(),this.elements=e,this.canvasModel=t}doActivate(){super.doActivate()}createSnapshot(e){const t=this.canvasModel.canvas,r=this.canvasModel.ctx;if(r){r.clearRect(0,0,t.width,t.height);const s=t.width/window.devicePixelRatio,i=t.height/window.devicePixelRatio;return r.drawImage(this.elements.backgroundCanvas,0,0,s,i),r.drawImage(this.elements.mainCanvas,0,0,s,i),r.drawImage(this.elements.staticDrawingCanvas,0,0,s,i),r.drawImage(this.elements.dataSeriesCanvas,0,0,s,i),r.drawImage(this.elements.dynamicDrawingCanvas,0,0,s,i),r.drawImage(this.elements.crossToolCanvas,0,0,s,i),e&&e(r),new Promise((a,o)=>this.elements.snapshotCanvas.toBlob(l=>l?a(l):o("Blob is null")))}else return console.error("Snapshot isn't supported"),Promise.reject()}}const ld=po(n=>n.candle.volume);class cd extends ee{constructor(e,t){super(),this.chartComponent=e,this.scaleModel=t,this.volumeMax=new On(0),this.highLowProvider={calculateHighLow:()=>({high:this.volumeMax.getValue(),low:0}),isHighLowActive:()=>!0}}doActivate(){super.doActivate(),this.addRxSubscription(Ee(this.chartComponent.chartModel.observeCandlesChanged(),this.scaleModel.xChanged).subscribe(()=>this.updateVolumeMax())),this.addRxSubscription(this.chartComponent.chartModel.mainCandleSeries.observeLastVisualCandleChanged().subscribe(()=>this.recalculateLastVisualVolume()))}recalculateLastVisualVolume(){}updateVolumeMax(){var e;this.volumeMax.next((e=Ot(ld(this.chartComponent.chartModel.mainCandleSeries.getSeriesInViewport().flat())))!=null?e:0)}}class hd extends ee{constructor(e,t,r,s,i,a,o){super(),this.canvasModel=e,this.canvasBoundsContainer=s,this.config=a,this.volumesColorByChartTypeMap={};const l=new cd(t,r);this.addChildEntity(l),this.separateVolumes=new tn(e,t,i,a,l,this.volumesColorByChartTypeMap,o),this.addChildEntity(this.separateVolumes);const c=new Ds(e,a,l,t.chartModel,r,this.volumesColorByChartTypeMap,()=>!a.components.volumes.showSeparately);i.addDrawer(c,te.VOLUMES),this.registerDefaultVolumeColorResolvers()}registerDefaultVolumeColorResolvers(){this.registerVolumeColorResolver("candle",Es),this.registerVolumeColorResolver("line",Pl),this.registerVolumeColorResolver("bar",xl)}setShowVolumesSeparatly(e){this.config.components.volumes.showSeparately!==e&&(this.config.components.volumes.showSeparately=e,e?this.separateVolumes.activateSeparateVolumes():this.separateVolumes.deactiveSeparateVolumes())}doDeactivate(){super.doDeactivate(),this.setVisible(!1)}registerVolumeColorResolver(e,t){this.volumesColorByChartTypeMap[e]=t}setVisible(e=!0){this.config.components.volumes.visible=e,this.config.components.volumes.showSeparately===!0&&(e?this.separateVolumes.activateSeparateVolumes():this.separateVolumes.deactiveSeparateVolumes()),this.canvasBoundsContainer.recalculatePanesHeightRatios(),this.canvasModel.fireDraw()}}class ud{constructor(e,t,r,s,i){this.config=e,this.canvasBoundsContainer=t,this.canvasModel=r,this.waterMarkConfigProvider=s,this.watermarkDataProvider=i,this.getConfig=(a=0,o,l,c,u,g)=>{const b=this.canvasModel.ctx,P=this.canvasBoundsContainer.getBounds(B.CHART),{position:I,offsetY:Y,offsetX:k}=this.config.components.waterMark;let U;switch(g?U=g:(b.font=vn(this.config,l),U=b.measureText(o).width,P.width-10<U&&(b.font=dd(this.config,this.canvasBoundsContainer,l,U),U=b.measureText(o).width)),I){case"left-top":return{x:k,y:Y+a,font:b.font,text:o,color:c};case"left-bottom":return{x:k,y:P.height-u-Y+a,font:b.font,text:o,color:c};case"center":return{x:P.width/2-U/2,y:(P.height-u)/2+a,font:b.font,text:o,color:c}}}}draw(){var e,t,r,s,i,a,o;if((e=this.config.components.waterMark)!=null&&e.visible&&this.config.colors){const{firstRow:l,secondRow:c,thirdRow:u}=this.watermarkDataProvider(),g=this.waterMarkConfigProvider(),b=this.config.colors.waterMarkTheme,P=this.canvasModel.ctx;let I=0,Y=0,k=0,U=0,W=0;if(P.save(),g.firstRowFontSize&&l){P.font=vn(this.config,g.firstRowFontSize);const $=P.measureText(l);I=$.actualBoundingBoxAscent+$.actualBoundingBoxDescent}if(g.secondRowFontSize&&c){P.font=vn(this.config,g.secondRowFontSize);const $=P.measureText(c);Y=$.actualBoundingBoxAscent+$.actualBoundingBoxDescent,k=(t=g.firstRowBottomPadding)!=null?t:0}if(g.thirdRowFontSize&&u){P.font=vn(this.config,g.thirdRowFontSize);const $=P.measureText(u);U=$.actualBoundingBoxAscent+$.actualBoundingBoxDescent,W=(r=g.secondRowBottomPadding)!=null?r:0}const q=(s=g.thirdRowBottomPadding)!=null?s:0,K=(i=g.logoHeight)!=null?i:0,Z=I+Y+k+U+W+q+K;if(l&&this.drawWaterMark(this.getConfig(I,l,g.firstRowFontSize,b.firstRowColor,Z)),c&&this.drawWaterMark(this.getConfig(I+k+Y,c,g.secondRowFontSize,b.secondRowColor,Z)),u&&this.drawWaterMark(this.getConfig(I+k+Y+W+U,u,g.thirdRowFontSize,b.thirdRowColor,Z)),this.logoImage){const $=this.getConfig(I+k+Y+W+U+q,"",g.thirdRowFontSize,b.thirdRowColor,Z,g.logoWidth);this.canvasModel.ctx.drawImage(this.logoImage,$.x,$.y,(a=g.logoWidth)!=null?a:0,(o=g.logoHeight)!=null?o:0)}P.restore()}}getCanvasIds(){return[this.canvasModel.canvasId]}setLogoImage(e){this.logoImage=e}drawWaterMark(e){const t=e.text;if(!t||!t.length)return;const r=this.canvasModel.ctx;r.font=e.font,r.fillStyle=e.color;const s=e.x,i=e.y;r.fillText(t,s,i)}reset(){}}const dd=(n,e,t,r)=>{const i=((o,l)=>e.getBounds(B.CHART).width/l*o)(t,r);let a;return n.components&&n.components.waterMark&&(a=n.components.waterMark.fontFamily),i+"px "+a},vn=(n,e)=>{let t;return n.components&&n.components.waterMark&&(t=n.components.waterMark.fontFamily),e+"px "+t};var fd=Object.defineProperty,oa=Object.getOwnPropertySymbols,vd=Object.prototype.hasOwnProperty,gd=Object.prototype.propertyIsEnumerable,la=(n,e,t)=>e in n?fd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ca=(n,e)=>{for(var t in e||(e={}))vd.call(e,t)&&la(n,t,e[t]);if(oa)for(var t of oa(e))gd.call(e,t)&&la(n,t,e[t]);return n};class pd extends ee{constructor(e,t,r,s,i,a,o){super(),this.paneManager=e,this.chartModel=t,this.eventBus=r,this.config=s,this.canvasModel=a,this.waterMarkConfig=this.config.components.waterMark,this.waterMarkData=this.getWaterMarkData(),this.waterMarkDrawer=new ud(this.config,i,a,()=>this.waterMarkConfig,()=>this.waterMarkData),this.addRxSubscription(He(i.observeBoundsChanged(B.PANE_UUID(re)),this.paneManager.panesChangedSubject).subscribe(l=>{this.waterMarkConfig=this.recalculateTextSize(l.width,l.height)})),this.addRxSubscription(this.chartModel.candlesSetSubject.subscribe(()=>{this.waterMarkData=this.getWaterMarkData()})),o.addDrawerAfter(this.waterMarkDrawer,te.WATERMARK,te.DRAWINGS)}setWaterMarkVisible(e){this.config.components&&this.config.components.waterMark&&(this.config.components.waterMark.visible=e,this.canvasModel.fireDraw())}setWaterMarkData(e){this.waterMarkData=e,this.canvasModel.fireDraw()}getWaterMarkData(){return this.waterMarkData||{}}setWaterMarkConfig(e){if(!(!e||!this.config.components)){if(!this.config.components.waterMark)this.config.components.waterMark=JSON.parse(JSON.stringify(e));else{const t={};He(t,e),He(t,this.config.components.waterMark),this.config.components.waterMark=t}this.canvasModel.fireDraw()}}setLogoImage(e){this.waterMarkDrawer.setLogoImage(e)}recalculateTextSize(e,t){const i=g=>.15*Math.log(g)/Math.log(1.5)+1,a=i(e/1920),o=i(t/1080),l=Math.min(a,o),c=l>=0?l:0,u={firstRowFontSize:Math.round(this.config.components.waterMark.firstRowFontSize*c),secondRowFontSize:Math.round(this.config.components.waterMark.secondRowFontSize*c),thirdRowFontSize:Math.round(this.config.components.waterMark.thirdRowFontSize*c)};return ca(ca({},this.config.components.waterMark),u)}}const ha={x:4,y:4};function md(n,e,t,r,s){var i,a;const o=(i=s.alignType)!=null?i:"middle",{fontSize:l,fontFamily:c,padding:u}=r.components.xAxis,g=(a=u.top)!=null?a:0,b=t.getBounds(B.X_AXIS);e.save(),e.font=`bold ${l}px ${c}`;const I=e.measureText(s.text).width+ha.x*2;let Y=0;const k=s.x;switch(o){case"start":Y=k-I;break;case"end":Y=k;break;case"middle":default:Y=k-I/2;break}Os(n,e,Y,b.y,I,b.height-1),o!=="middle"&&(e.strokeStyle=s.color,e.beginPath(),e.moveTo(k,b.y),e.lineTo(k,b.y+b.height),e.stroke()),e.fillStyle=s.color;const U=Y+ha.x,W=b.y+g+l;e.fillText(s.text,U,W),e.restore()}class bd{constructor(e,t,r,s,i){this.backgroundCanvasModel=e,this.config=t,this.canvasModel=r,this.canvasBoundsContainer=s,this.xAxisLabelsModel=i}draw(){const e=this.canvasModel.ctx;this.drawHighlightedBackgroundBetweenLabels(),this.xAxisLabelsModel.labels.forEach(t=>{md(this.backgroundCanvasModel.ctx,e,this.canvasBoundsContainer,this.config,t)})}drawHighlightedBackgroundBetweenLabels(){const e=this.canvasModel.ctx,t={},r=this.xAxisLabelsModel.labels.reduce((s,i)=>{if(i.subGroupId!==void 0){let a=s[i.subGroupId];a||(a=[],s[i.subGroupId]=a),a.push(i)}return s},t);Object.keys(r).forEach(s=>{const i=r[s];if(i.length===2){const a=this.canvasBoundsContainer.getBounds(B.X_AXIS);e.fillStyle=vt.rgb(i[0].color).alpha(.1).toString(),ni(e,{x:i[0].x,y:a.y},{x:i[1].x,y:a.y+a.height})}})}getCanvasIds(){return[this.canvasModel.canvasId]}}function De(n,e){if(e.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+e.length+" present")}function gn(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?gn=function(t){return typeof t}:gn=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gn(n)}function Le(n){De(1,arguments);var e=Object.prototype.toString.call(n);return n instanceof Date||gn(n)==="object"&&e==="[object Date]"?new Date(n.getTime()):typeof n=="number"||e==="[object Number]"?new Date(n):((typeof n=="string"||e==="[object String]")&&typeof console!="undefined"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function wd(n){return De(1,arguments),Le(n).getDay()===1}function Cd(n){return De(1,arguments),Le(n).getDay()===2}function yd(n){return De(1,arguments),Le(n).getDay()===3}function Sd(n){return De(1,arguments),Le(n).getDay()===4}function Md(n){return De(1,arguments),Le(n).getDay()===5}function _d(n){return De(1,arguments),Le(n).getDay()===6}function xd(n){return De(1,arguments),Le(n).getDay()===0}function Pd(n,e){var t;De(1,arguments);var r=n||{},s=Le(r.start),i=Le(r.end),a=i.getTime();if(!(s.getTime()<=a))throw new RangeError("Invalid interval");var o=[],l=s;l.setHours(0,0,0,0);var c=Number((t=e==null?void 0:e.step)!==null&&t!==void 0?t:1);if(c<1||isNaN(c))throw new RangeError("`options.step` must be a number greater than 1");for(;l.getTime()<=a;)o.push(Le(l)),l.setDate(l.getDate()+c),l.setHours(0,0,0,0);return o}function Td(n){De(1,arguments);var e=Le(n);return e.setDate(1),e.setHours(0,0,0,0),e}function Ad(n){De(1,arguments);var e=Le(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function ua(n){De(1,arguments);var e=Le(n);return e.setHours(0,0,0,0),e}function da(n,e){De(2,arguments);var t=ua(n),r=ua(e);return t.getTime()===r.getTime()}const Ed=n=>{switch(n.key){case"lessThanSecond":return Id(n);case"month":return Od(n);case"second":case"minute":case"hour":case"day":case"year":return Bd(n);case"week-weekday":return Rd(n);default:return()=>!1}},Tt=(n,e)=>{switch(e){case"lessThanSecond":return n.getMilliseconds();case"month":return n.getMonth();case"second":return n.getSeconds();case"minute":return n.getMinutes();case"hour":return n.getHours();case"day":return n.getDate();case"year":return n.getFullYear();case"week-weekday":return n.getDate()}},pn=n=>(e,t)=>{const r=Tt(e,n),s=Tt(t,n);return r!==s},Dd={1:wd,2:Cd,3:yd,4:Sd,5:Md,6:_d,7:xd},Ld=(n,e,t)=>{var r;const s=Pd({start:Td(n),end:Ad(n)}),i=(r=Dd[t])!=null?r:()=>!1;if(e==="$"){for(const a of s.reverse())if(i(a))return da(n,a)}else{let a=1;for(const o of s)if(i(o)){if(a===e)return da(n,o);a++}}return!1},fa=(n,e)=>e===1?n===1:n/e===1,va=(n,e)=>e===1?!0:n%e===0,Id=n=>(e,t)=>pn(n.key)(e,t),Od=n=>(e,t)=>{const r=pn(n.key)(e,t),s=n.exact?fa(Tt(e,n.key)+1,n.value):va(Tt(e,n.key)+1,n.value);return r&&s},Bd=n=>(e,t)=>{const r=pn(n.key)(e,t),s=n.exact?fa(Tt(e,n.key),n.value):va(Tt(e,n.key),n.value);return r&&s},Rd=n=>(e,t)=>{const r=pn(n.key)(e,t),s=Ld(e,n.week,n.weekday);return r&&s},tg="week-weekday",Fd=["second","minute","hour","day","month","year"],Nd=["lessThanSecond"],Yd=n=>Fd.some(e=>e===n),Hd=n=>n==="week-weekday",kd=n=>Nd.some(e=>e===n),ga=n=>{const e={"!":!1,$:!1};return n.includes("!")&&(e["!"]=!0),n.includes("$")&&(e.$=!0),e},br=n=>parseInt(n,10),pa=n=>{const[e,...t]=n.split("_");if(Yd(e)){const[r]=t,s=ga(r),i=br(r);return{key:e,value:i,exact:s["!"]}}else if(Hd(e)){const[r,s]=t,i=ga(r),a=br(r),o=br(s);return{key:e,week:i.$?"$":a,weekday:o}}else return kd(e)?{key:e}:(console.warn(`${n} is not fit, check the documentation to see available formats https://webdev.prosp.devexperts.com:8095/docs/chart/x-axis`),null)},Ud=n=>{switch(n.key){case"second":case"minute":return zd(n.value);case"hour":return Wd(n.value);case"day":return Xd(n.value);case"month":return Gd(n.value);case"year":return Zd(n.value);case"week-weekday":const e=jd(n.week),t=Vd(n.weekday);return e&&t;case"lessThanSecond":return!0;default:return!1}},zd=n=>n>0&&n<=60,Wd=n=>n>0&&n<=24,Xd=n=>n>0&&n<=31,Vd=n=>ma(n)?n>=1&&n<=7:!1,jd=n=>n==="$"?!0:ma(n)?n>=1&&n<=6:!1,Gd=n=>n>0&&n<=12,Zd=n=>n>0,ma=n=>!isNaN(n)&&isFinite(n);var $d=Object.defineProperty,ba=Object.getOwnPropertySymbols,Kd=Object.prototype.hasOwnProperty,qd=Object.prototype.propertyIsEnumerable,wa=(n,e,t)=>e in n?$d(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ca=(n,e)=>{for(var t in e||(e={}))Kd.call(e,t)&&wa(n,t,e[t]);if(ba)for(var t of ba(e))qd.call(e,t)&&wa(n,t,e[t]);return n};const wr={lessThanSecond:0,second:100,minute:200,hour:300,day:400,"week-weekday":500,month:600,year:1e4},ya=n=>{switch(n.key){case"second":case"minute":case"hour":case"day":case"month":case"year":return wr[n.key]+n.value;case"lessThanSecond":return wr[n.key];case"week-weekday":return wr[n.key]+(n.week==="$"?9:n.week)+n.weekday*10}},Jd=n=>{const e={};return n.forEach(t=>{const r=e[t.weight];r===void 0?e[t.weight]=[Ca({},t)]:e[t.weight]=[...r,Ca({},t)]}),e},Qd=(n,e)=>{const t=Object.keys(n).map(s=>parseInt(s,10)).sort((s,i)=>i-s);let r=[];for(const s of t){const i=n[s];if(!i)continue;const a=[...r];r=[];const o=a.length,l=i.length;let c=0,u=1/0,g=-1/0;for(let b=0;b<l;b++){const P=i[b],I=P.idx;for(;c<o;){const Y=a[c],k=Y.idx;if(I>k)c++,r.push(Y),g=k,u=1/0;else{u=k;break}}u-I>=e&&I-g>=e&&(r.push(P),g=I)}for(;c<o;)r.push(a[c]),c++}return r},ef=(n,e,t,r)=>{const s=Object.entries(t).sort(([i],[a])=>parseInt(a,10)-parseInt(i,10));for(const[i,a]of s)if(a&&a(r(n.getTime()),r(e.getTime())))return parseInt(i,10);return null};function tf(n,e,t){const r=[];if(n.length===0)return r;let s=new Date(0);for(const i of n){const a=new Date(i.candle.timestamp),o={weight:null};o.weight=ef(a,s,e,t),r.push(o),s=a}return r}const Sa=n=>{const e={},t={};return Qn(n).forEach(([r,s])=>{const i=pa(r),a=i===null?!1:Ud(i);if(i&&a){const o=ya(i);e[o]=s,t[o]=Ed(i)}}),{weightToTimeFormatsDict:e,weightToTimeFormatMatcherDict:t}};class Ma{constructor(e,t,r,s,i){this.eventBus=e,this.config=t,this.chartModel=r,this.scaleModel=s,this.timeZoneModel=i,this.labelsGroupedByWeight={},this.levelsCache={},this.weightToTimeFormatMatcherDict={},this.weightToTimeFormatsDict={},this.extendedLabelsFilterConfig={minute_1:l=>l>=2},this.formatsByWeightMap=t.components.xAxis.formatsForLabelsConfig;const{weightToTimeFormatsDict:a,weightToTimeFormatMatcherDict:o}=Sa(this.formatsByWeightMap);this.weightToTimeFormatMatcherDict=o,this.weightToTimeFormatsDict=a}get labels(){var e,t;return(t=(e=this.weightedCache)==null?void 0:e.labels)!=null?t:[]}getAllCandlesWithFake(){const e=this.chartModel.mainCandleSeries.visualPoints;if(e.length===0)return[];const r=Array.from({length:750}).map((s,i)=>wi(this.chartModel.mainCandleSeries,e.length+i,this.chartModel.getPeriod()));return[...e,...r]}mapWeightedPointsToLabels(e,t){return e.reduce((r,s,i)=>{var a,o;if(s.weight===null)return r;const l=t[i],c=this.weightToTimeFormatsDict[s.weight],u=c!==void 0?this.timeZoneModel.getFormatterFactory()(c)(l.candle.timestamp):"";return r.concat({weight:s.weight,idx:(a=l.candle.idx)!=null?a:0,value:l.centerUnit,time:(o=l.candle.timestamp)!=null?o:0,text:u})},[])}setFormatsForLabelsConfig(e){const{weightToTimeFormatsDict:t,weightToTimeFormatMatcherDict:r}=Sa(e);this.formatsByWeightMap=e,this.weightToTimeFormatMatcherDict=r,this.weightToTimeFormatsDict=t,this.generateWeightedLabels(),this.eventBus.fireDraw()}generateWeightedLabels(){const e=this.getAllCandlesWithFake(),t=tf(e,this.weightToTimeFormatMatcherDict,this.timeZoneModel.tzOffset(this.config.timezone)),r=this.mapWeightedPointsToLabels(t,e);this.labelsGroupedByWeight=Jd(r),this.weightedCache=void 0,this.levelsCache={},this.recalculateCachedLabels()}getLabelsFromCache(e){if(this.levelsCache[e])return this.levelsCache[e]}generateLabels(){this.generateWeightedLabels()}recalculateLabels(){this.recalculateCachedLabels()}recalculateCachedLabels(){if(Object.getOwnPropertyNames(this.labelsGroupedByWeight).length===0)return;const e=this.config.components.xAxis.fontSize,t=Object.values(this.formatsByWeightMap).reduce((a,o)=>Math.max(o.length,a),1),r=e*t,s=Me(this.chartModel.mainCandleSeries.meanCandleWidth,this.scaleModel.zoomX),i=Math.round(r/s);if(!(i<0)&&(this.weightedCache===void 0||i!==this.weightedCache.coverUpLevel)){const a=this.getLabelsFromCache(i);if(a){this.weightedCache={labels:a,coverUpLevel:i};return}const o=Qd(this.filterLabelsByExtendedRules(this.labelsGroupedByWeight,i),i);this.levelsCache[i]=o,this.weightedCache={labels:o,coverUpLevel:i}}}filterLabelsByExtendedRules(e,t){const r=Qn(this.extendedLabelsFilterConfig).reduce((s,i)=>{if(!i)return s;const[a,o]=i;if(o){const l=pa(a);if(l){const c=ya(l);s[c]=o}}return s},{});return Qn(e).reduce((s,[i,a])=>(r[i]&&r[i](t)||(s[i]=a),s),{})}}class nf extends ee{constructor(e,t){super(),this.eventBus=e,this.labelProviders=t,this.labels=[],this.initModel(),this.addSubscription(this.eventBus.on(Ze.EVENT_DRAW,()=>this.recalculateLabels()))}initModel(){this.recalculateLabels()}recalculateLabels(){this.labels=[];for(const e of this.labelProviders)this.labels.push(...e.getUnorderedLabels())}}class rf extends ee{constructor(e,t,r,s,i){super(),this.scaleModel=e,this.canvasInputListener=t,this.canvasBoundsContainer=r,this.chartPanComponent=s,this.chartModel=i,this.lastXStart=0,this.lastXWidth=0,this.lastXPxWidth=0,this.onXDragStart=()=>{this.lastXStart=this.scaleModel.xStart,this.lastXWidth=this.scaleModel.xEnd-this.scaleModel.xStart;const o=this.canvasBoundsContainer.getBounds(B.X_AXIS);this.lastXPxWidth=o.width-this.canvasInputListener.currentPoint.x},this.onXDragTick=o=>{const{delta:l}=o,c=this.lastXPxWidth-l;if(c<0)return;const u=this.lastXPxWidth/c,g=this.lastXWidth*u,b=this.lastXStart+(this.lastXWidth-g);this.scaleModel.setXScale(b,this.scaleModel.xEnd)};const a=new Ht(this.canvasBoundsContainer.getBoundsHitTest(B.X_AXIS),{onDragStart:this.onXDragStart,onDragTick:this.onXDragTick},this.canvasInputListener,this.chartPanComponent,{disableChartPanning:!1});this.addChildEntity(a)}doActivate(){super.doActivate(),this.addRxSubscription(this.canvasInputListener.observeDbClick(this.canvasBoundsContainer.getBoundsHitTest(B.X_AXIS)).subscribe(()=>this.chartModel.doBasicScale())),this.addRxSubscription(this.chartModel.candlesPrependSubject.subscribe(e=>this.lastXStart+=e))}}class Cr{constructor(e,t,r,s,i,a=()=>!0){this.config=e,this.canvasModel=t,this.viewportModel=r,this.canvasBoundsContainer=s,this.labelsProvider=i,this.drawPredicate=a}draw(){var e;if(this.drawPredicate()){const t=this.canvasModel.ctx,r=this.config.colors.xAxis,s=this.config.components.xAxis.fontFamily,i=Cr.getFontFromConfig(this.config),a=this.config.components.xAxis.fontSize,o=(e=this.config.components.xAxis.padding.top)!=null?e:0;t.save(),t.font=i,t.fillStyle=r.backgroundColor;const l=this.canvasBoundsContainer.getBounds(B.X_AXIS);t.fillRect(l.x,l.y,l.width,l.height);const c=this.config.colors.chartAreaTheme.axisColor,u=this.labelsProvider();this.drawLabels(t,u,l,c,a,s,o),t.restore()}}drawLabels(e,t,r,s,i,a,o){const l=`${i}px ${a}`;e.fillStyle=s;for(const c of t){const u=this.viewportModel.toX(c.value)-Ke(c.text,e,l)/2;if(u<0||u>r.width)continue;const g=r.y+i-1+o,b=c.text;e.font=l,e.fillText(b,u,g)}}static getFontFromConfig(e){return`${e.components.xAxis.fontStyle}  ${e.components.xAxis.fontSize}px ${e.components.xAxis.fontFamily}`}getCanvasIds(){return[this.canvasModel.canvasId]}}class sf extends ee{constructor(e,t,r,s,i,a,o,l,c,u,g,b,P){super(),this.eventBus=e,this.config=t,this.canvasModel=r,this.chartComponent=s,this.scaleModel=i,this.chartResizeHandler=l,this.timeZoneModel=u;const I=new Ma(e,t,s.chartModel,i,u);this.xAxisLabelsGenerator=I,this.xAxisLabelsModel=new nf(e,[]);const Y=new ar;c.addDrawer(Y,te.X_AXIS),this.xAxisDrawer=new Cr(t,r,i,a,()=>this.xAxisLabelsGenerator.labels,()=>t.components.xAxis.visible),Y.addDrawer(this.xAxisDrawer),this.xAxisLabelsDrawer=new bd(P,t,r,a,this.xAxisLabelsModel),Y.addDrawer(this.xAxisLabelsDrawer),this.xAxisScaleHandler=new rf(i,o,a,g,this.chartComponent.chartModel),this.addChildEntity(this.xAxisScaleHandler),b.addCursorForCanvasEl(B.X_AXIS,t.components.xAxis.cursor)}doActivate(){super.doActivate(),this.addRxSubscription(Ee(this.chartComponent.chartModel.candlesSetSubject,this.chartComponent.chartModel.candlesUpdatedSubject.pipe(Ce(()=>{var e,t;return(t=(e=this.chartComponent.chartModel.mainCandleSeries.visualPoints[0])==null?void 0:e.candle)==null?void 0:t.timestamp}),ke()),this.timeZoneModel.observeTimeZoneChanged()).subscribe(()=>this.xAxisLabelsGenerator.generateLabels())),this.addRxSubscription(Ee(this.scaleModel.xChanged,this.chartResizeHandler.canvasResized).subscribe(()=>this.xAxisLabelsGenerator.recalculateLabels()))}getDrawer(){return this.xAxisDrawer}registerXAxisLabelsProvider(e){this.xAxisLabelsModel.labelProviders.push(e)}setVisible(e){var t;(t=this.config.components)!=null&&t.xAxis&&(this.config.components.xAxis.visible=e,this.eventBus.fireDraw())}setFormatsForLabelsConfig(e){this.xAxisLabelsGenerator instanceof Ma?this.xAxisLabelsGenerator.setFormatsForLabelsConfig(e):console.error("Format config for x-axis is not available")}isVisible(){var e,t;return(t=(e=this.config.components)==null?void 0:e.xAxis.visible)!=null?t:!1}}const Qe="#FF00FF",af=(n,e)=>n==="down"?e.lastPrice.textNegative:n==="up"?e.lastPrice.textPositive:e.lastPrice.textSelected,of=(n,e)=>{const t=e.barTheme[`${n}Color`];return t!=null?t:Qe},lf=(n,e)=>{const t=e.lineTheme[`${n}Color`];return t!=null?t:Qe},cf=(n,e)=>{const t=e.candleTheme[`${n}Color`];return t!=null?t:Qe},hf=(n,e)=>{const t=e.areaTheme.lineColor;return t!=null?t:Qe},uf=(n,e)=>{const t=e.scatterPlot.mainColor;return t!=null?t:Qe},df=(n,e)=>{const t=e.histogram[`${n}Cap`];return t!=null?t:Qe},ff=(n,e)=>{const t=n==="up"?e.baseLineTheme.upperSectionStrokeColor:e.baseLineTheme.lowerSectionStrokeColor;return t!=null?t:Qe},_a=(n,e)=>{const t=e.candleTheme[`${n}WickColor`];return t!=null?t:Qe},vf=()=>(console.warn("Fallback for label default color"),Qe);var gf=Object.defineProperty,xa=Object.getOwnPropertySymbols,pf=Object.prototype.hasOwnProperty,mf=Object.prototype.propertyIsEnumerable,Pa=(n,e,t)=>e in n?gf(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,mn=(n,e)=>{for(var t in e||(e={}))pf.call(e,t)&&Pa(n,t,e[t]);if(xa)for(var t of xa(e))mf.call(e,t)&&Pa(n,t,e[t]);return n};class bf{constructor(e,t,r,s){this.chartModel=e,this.config=t,this.lastCandleLabelsByChartType=r,this.resolveLabelColorFn=s}getUnorderedLabels(){const e=[];if(this.config.components.yAxis.labels.settings.lastPrice.mode!=="none"){const r=this.getYAxisVisualLabel(this.chartModel.mainCandleSeries),s=r&&mn(mn({},r),this.getLabelDrawConfig(this.chartModel.mainCandleSeries,!0));if(s){const i={labels:[s]},a=this.lastCandleLabelsByChartType[this.config.components.chart.type];a==null||a(i,this.chartModel.mainCandleSeries),e.push(i)}this.chartModel.candleSeries.forEach((i,a)=>{if(a===0)return;const o=this.getYAxisVisualLabel(i),l=o&&mn(mn({},o),this.getLabelDrawConfig(i,!1));if(l){const c={labels:[l]},u=this.lastCandleLabelsByChartType[i.config.type];u==null||u(c,this.chartModel.mainCandleSeries),e.push(c)}})}return e}getYAxisVisualLabel(e){const t=Ue(e.dataPoints);if(t){const r=t.close,s=this.config.components.yAxis.labels.settings.lastPrice.mode,i=this.config.components.yAxis.labels.settings.lastPrice.type;return{y:e.view.toY(r),labelWeight:0,labelText:this.chartModel.pane.valueFormatter(r,e),mode:s,labelType:i,description:e.instrument.symbol}}return null}getLabelDrawConfig(e,t){const r=e.colors.labels,s=this.resolveLabelColorFn(e.config.type),{rectLabelTextColor:i,rectLabelInvertedTextColor:a}=this.chartModel.config.colors.yAxis;let o="#FFFFFF",l="#FFFFFF";return r&&(o=s(e.lastPriceMovement,e.colors),l=t?af(e.lastPriceMovement,r):i),{bgColor:o,textColor:Yn(o,l,a),rounded:!0}}}class wf{constructor(e,t,r,s,i,a){this.labelsProvider=e,this.yAxisLabelsCanvasModel=t,this.yAxisState=r,this.canvasBoundsContainer=s,this.yAxisColors=i,this.customLabels=a}draw(){const e=this.yAxisLabelsCanvasModel.ctx,t=this.canvasBoundsContainer.getBounds(B.PANE_UUID_Y_AXIS(re));this.drawHighlightedBackgroundBetweenLabels(t),this.labelsProvider().forEach(s=>{var i;const a=(i=s.bounds)!=null?i:t;s.labels.forEach(o=>Fi(e,a,o,this.canvasBoundsContainer,this.yAxisState,this.yAxisColors))}),Object.values(this.customLabels).forEach(s=>Fi(e,t,s,this.canvasBoundsContainer,this.yAxisState,this.yAxisColors))}drawHighlightedBackgroundBetweenLabels(e){const t=this.yAxisLabelsCanvasModel.ctx,r=[],i=this.labelsProvider().reduce((l,c)=>l.concat(c.labels),r),a={},o=i.reduce((l,c)=>{if(c.subGroupId){let u=l[c.subGroupId];u||(u=[],l[c.subGroupId]=u),u.push(c)}return l},a);Object.keys(o).forEach(l=>{var c;const u=o[l];if(u.length===2){const g=this.canvasBoundsContainer.getBounds(B.Y_AXIS);t.save(),t.fillStyle=(c=u[0].highlightColor)!=null?c:u[0].bgColor;const[b,P]=u[0].y>u[1].y?[u[1].y,u[0].y]:[u[0].y,u[1].y];ni(t,{x:g.x,y:ms(b,e)},{x:g.x+g.width-6,y:ms(P,e)}),t.restore()}})}getCanvasIds(){return[this.yAxisLabelsCanvasModel.canvasId]}}class Cf extends ee{constructor(e,t,r,s,i,a,o,l,c,u,g,b){super(),this.eventBus=e,this.config=t,this.canvasModel=r,this.yAxisLabelsCanvasModel=s,this.chartModel=i,this.scaleModel=a,this.canvasBoundsContainer=l,this.axisTypeSetSubject=new G,this.labelsColorByChartTypeMap={},this.state=t.components.yAxis;const P=new ar,I=new xt(this.yAxisLabelsCanvasModel);P.addDrawer(I,te.YAXIS_CLEAR),this.registerDefaultLabelColorResolver(),c.addDrawer(P,te.Y_AXIS),this.yAxisScaleHandler=new sa(e,this.state,u,a,o,l,l.getBoundsHitTest(B.PANE_UUID_Y_AXIS(re)),W=>a.autoScale(W)),this.addChildEntity(this.yAxisScaleHandler),this.yAxisModel=new Wh(g,g.paneComponents[re],e,this.config,l,r,i,a),this.addChildEntity(this.yAxisModel),g.paneComponents[re].yAxisLabelsGenerator=this.yAxisModel.yAxisLabelsGenerator;const Y=new na(t,this.state,r,()=>this.yAxisModel.yAxisBaseLabelsModel.labels,()=>l.getBounds(B.Y_AXIS),()=>this.state.visible,i.pane.scaleModel.toY.bind(i.pane.scaleModel));P.addDrawer(Y);const k=new wf(()=>this.yAxisModel.yAxisLabelsModel.orderedLabels,this.yAxisLabelsCanvasModel,this.state,this.canvasBoundsContainer,this.config.colors.yAxis,this.yAxisModel.yAxisLabelsModel.customLabels);P.addDrawer(k);const U=new bf(this.chartModel,this.config,this.chartModel.lastCandleLabelsByChartType,this.getLabelsColorResolver.bind(this));this.registerYAxisLabelsProvider(U,lr.MAIN),g.paneComponents[re].getAxisType=()=>this.state.type,b.addCursorForCanvasEl(B.PANE_UUID_Y_AXIS(re),t.components.yAxis.cursor)}updateOrderedLabels(e=!1){this.yAxisModel.yAxisLabelsModel.updateLabels(e)}doActivate(){super.doActivate()}registerDefaultLabelColorResolver(){this.registerLabelColorResolver("candle",cf),this.registerLabelColorResolver("bar",of),this.registerLabelColorResolver("line",lf),this.registerLabelColorResolver("area",hf),this.registerLabelColorResolver("scatterPlot",uf),this.registerLabelColorResolver("histogram",df),this.registerLabelColorResolver("baseline",ff),this.registerLabelColorResolver("trend",_a),this.registerLabelColorResolver("hollow",_a)}registerYAxisLabelsProvider(e,t=lr.MAIN,r=$e()){return this.yAxisModel.yAxisLabelsModel.registerYAxisLabelsProvider(t,e,r),r}addSimpleYAxisLabel(e,t){this.yAxisModel.yAxisLabelsModel.customLabels[e]=t,this.canvasModel.fireDraw()}deleteSimpleYAxisLabel(e){delete this.yAxisModel.yAxisLabelsModel.customLabels[e],this.canvasModel.fireDraw()}unregisterYAxisLabelsProvider(e=lr.MAIN,t){return this.yAxisModel.yAxisLabelsModel.unregisterYAxisLabelsProvider(e,t),t}registerYAxisWidthContributor(e){this.yAxisModel.registerYAxisWidthContributor(e)}setAxisType(e){e!==this.state.type&&(this.state.type=e,this.axisTypeSetSubject.next(e),this.scaleModel.autoScale(!0),this.yAxisModel.yAxisLabelsModel.updateLabels(!0))}setYAxisAlign(e){this.state.align=e,this.canvasBoundsContainer.recalculateBounds(),this.eventBus.fireDraw()}setVisible(e){this.state.visible=e,this.eventBus.fireDraw()}isVisible(){return this.state.visible}setLockPriceToBarRatio(e=!1){this.scaleModel.setLockPriceToBarRatio(e)}changeLabelMode(e,t){this.state.labels.settings[e].mode=t,this.yAxisModel.yAxisLabelsModel.updateLabels()}togglePriceScaleInverse(e){this.scaleModel.state.inverse=e,this.scaleModel.inverseY=e,this.scaleModel.scaleInversedSubject.next(e)}changeLabelsDescriptionVisibility(e){this.state.labels.descriptions=e,this.canvasModel.fireDraw()}registerLabelColorResolver(e,t){this.labelsColorByChartTypeMap[e]=t}getLabelsColorResolver(e){var t;return(t=this.labelsColorByChartTypeMap[e])!=null?t:vf}}class yf extends ee{constructor(e,t,r,s){super(),r.observeTouchStart().pipe(Ce(i=>s.components.chart.highlightActiveCandle?i:void 0),ke()).subscribe(i=>{i&&this.setCandleAsActive(i,e,t)})}setCandleAsActive(e,t,r){if(e.touches.length===1){const s=e.touches.item(0);if(s!==null){const i=this.getTouchXPosition(s,t),a=r.candleFromX(i);a&&r.mainCandleSeries.setActiveCandle(a)}}}getTouchXPosition(e,t){const r=t.getBoundingClientRect(),s=document.body.scrollLeft||document.documentElement.scrollLeft;return e.pageX-r.left-s}}class Sf{constructor(e,t,r,s,i){this.frameElement=e,this.resizerElement=t,this.bus=r,this.canvasModels=s,this.config=i,this.previousBCR=void 0,this.animFrameId=`resize_${$e()}`,this.canvasResized=new G,this.elementResizeDetector=new ResizeObserver(()=>this.handleResize())}subscribeResize(){this.elementResizeDetector.observe(this.resizerElement)}handleResize(){Ln(this.animFrameId,()=>this.fireUpdates())}fireUpdates(){const e=this.resizerElement.getBoundingClientRect(),t={x:e.x,y:e.y,width:e.width,height:e.height};this.config||(this.frameElement.style.height=this.resizerElement.clientHeight+"px"),(this.previousBCR===void 0||this.isBCRDimensionsDiffer(this.previousBCR,t))&&(this.previousBCR=t,this.canvasModels.forEach(r=>this.previousBCR&&r.updateDPR(this.previousBCR)),this.canvasResized.next(t),this.bus.fire(Xt,t),this.bus.fire(It))}isBCRDimensionsDiffer(e,t){return e.height!==t.height||e.width!==t.width}unsubscribeAnimationUpdate(){if(this.resizerElement)try{this.elementResizeDetector.unobserve(this.resizerElement)}catch(e){console.warn("ChartResizeHandler.ts, unsubscribeAnimationUpdate failed")}}wasResized(){return this.previousBCR!==void 0}}var Mf=Array.isArray,_f=Object.getPrototypeOf,xf=Object.prototype,Pf=Object.keys;function Tf(n){if(n.length===1){var e=n[0];if(Mf(e))return{args:e,keys:null};if(Af(e)){var t=Pf(e);return{args:t.map(function(r){return e[r]}),keys:t}}}return{args:n,keys:null}}function Af(n){return n&&typeof n=="object"&&_f(n)===xf}var Ef=Array.isArray;function Df(n,e){return Ef(e)?n.apply(void 0,v([],_(e))):n(e)}function Lf(n){return Ce(function(e){return Df(n,e)})}function If(n,e){return n.reduce(function(t,r,s){return t[r]=e[s],t},{})}function Of(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=zt(n),r=Ja(n),s=Tf(n),i=s.args,a=s.keys;if(i.length===0)return Wt([],t);var o=new ye(Bf(i,t,a?function(l){return If(a,l)}:St));return r?o.pipe(Lf(r)):o}function Bf(n,e,t){return t===void 0&&(t=St),function(r){Ta(e,function(){for(var s=n.length,i=new Array(s),a=s,o=s,l=function(u){Ta(e,function(){var g=Wt(n[u],e),b=!1;g.subscribe(Re(r,function(P){i[u]=P,b||(b=!0,o--),o||r.next(t(i.slice()))},function(){--a||r.complete()}))},r)},c=0;c<s;c++)l(c)},r)}}function Ta(n,e,t){n?Ge(t,n,e):e()}class Rf extends ee{constructor(e,t,r){super(),this.eventBus=e,this.canvasInputListener=t,this.canvasBoundsContainer=r,this.panesSubscriptions={},this.cross=new G}doActivate(){super.doActivate()}unsubscribeMouseOver(e){var t;(t=this.panesSubscriptions[e])==null||t.unsubscribe()}subscribeMouseOver(e,t,r){const s=t.map(a=>this.canvasBoundsContainer.getBoundsHitTest(a,r)),i=(a,o)=>s.some(l=>l(a,o));return this.subscribeMouseOverHT(e,i)}subscribeMouseOverHT(e,t){const r=this.canvasInputListener.observeMouseMoveDocument(),s=this.canvasInputListener.observeMouseEnter(t);let i=!1;const a=Of([r,s]).pipe(le(([,o])=>!i||i&&o)).subscribe(([o,l])=>{if(l){const c=[o.x,o.y,e];this.eventBus.fire(lo,c),this.cross.next(c),i=!1}else this.eventBus.fire(An),this.cross.next(null),i=!0});return this.panesSubscriptions[e]=a,a}}class Ff{constructor(e,t,r,s){this.visualCandle=e,this.price=t,this.priceFormatter=r,this.toY=s}get high(){return this.visualCandle.high}get low(){return this.visualCandle.low}get open(){return this.visualCandle.open}get close(){return this.visualCandle.close}get volume(){return this.visualCandle.candle.volume}get openY(){return this.toY(this.open)}get closeY(){return this.toY(this.close)}get highY(){return this.toY(this.high)}get lowY(){return this.toY(this.low)}get openFormatted(){return this.priceFormatter(this.open)}get closeFormatted(){return this.priceFormatter(this.close)}get highFormatted(){return this.priceFormatter(this.high)}get lowFormatted(){return this.priceFormatter(this.low)}get closestOHLCY(){return this.toY([this.close,this.open,this.high,this.low].sort((e,t)=>Math.abs(e-this.price)-Math.abs(t-this.price))[0])}}class Nf{constructor(e){this.chartModel=e}getData(e){const{x:t,y:r}=e,i=this.chartModel.candleFromX(t).idx||0,a=this.chartModel.getVisualCandle(i),o=this.chartModel.priceFromY(r);return a&&new Ff(a,o,this.chartModel.pane.regularFormatter,this.chartModel.toY)}}class Yf{constructor(e){this.chartModel=e}getData(e){const{x:t}=e,s=this.chartModel.candleFromX(t).idx||0;return this.chartModel.candleSeries.map(a=>{const o=a.dataPoints[s],l=this.chartModel.pane.regularFormatter(o==null?void 0:o.close);return{instrument:a.instrument.symbol,price:l,id:a.id}})}}var Hf=Object.defineProperty,kf=Object.defineProperties,Uf=Object.getOwnPropertyDescriptors,Aa=Object.getOwnPropertySymbols,zf=Object.prototype.hasOwnProperty,Wf=Object.prototype.propertyIsEnumerable,Ea=(n,e,t)=>e in n?Hf(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,bn=(n,e)=>{for(var t in e||(e={}))zf.call(e,t)&&Ea(n,t,e[t]);if(Aa)for(var t of Aa(e))Wf.call(e,t)&&Ea(n,t,e[t]);return n},Da=(n,e)=>kf(n,Uf(e));class Xf extends ee{constructor(e,t,r,s,i,a,o,l,c){super(),this.crossEventProducer=e,this.bus=t,this.scaleModel=r,this.config=s,this.chartModel=i,this.canvasInputListener=a,this.timeFormatterProvider=o,this.canvasBoundsContainer=l,this.paneManager=c,this.longTouchActivated=!1;const u=new Nf(this.chartModel),g=new Yf(this.chartModel);this.hoverProducerParts={candleHover:u,compareSeriesHover:g}}doActivate(){super.doActivate(),this.addRxSubscription(this.chartModel.candlesSetSubject.subscribe(()=>{const t=this.chartModel.getLastVisualCandle();t&&this.createAndFireHoverFromCandle(t,!1)})),this.addRxSubscription(this.chartModel.candlesUpdatedSubject.subscribe(()=>{const t=this.chartModel.getLastVisualCandle();this.lastHover!==void 0&&t!==void 0&&t.candle.timestamp===this.lastHover.timestamp&&this.createAndFireHoverFromCandle(t,!1)})),this.addRxSubscription(this.crossEventProducer.cross.subscribe(t=>{t===null?(this.lastCross=void 0,this.lastHover=void 0,this.bus.fire(Ze.EVENT_CLOSE_HOVER)):(this.createAndFireHover(t),this.lastCross=t)})),this.addRxSubscription(this.scaleModel.xChanged.subscribe(()=>this.fireLastCross())),this.addRxSubscription(this.canvasInputListener.observeTouchStart().subscribe(t=>{const r=t.touches[0].clientX,s=t.touches[0].clientY-this.canvasBoundsContainer.canvasOnPageLocation.y;this.chartModel.candleFromX(r,!0)&&this.createAndFireHover([r,s,""])}));const e=this.canvasBoundsContainer.getBoundsHitTest(B.ALL_PANES);this.addRxSubscription(this.canvasInputListener.observeLongTouch(e).subscribe(t=>{this.paneManager.chartPanComponent.deactivatePanHandlers(),this.longTouchActivated=!0;const r=t.touches[0].clientX,s=t.touches[0].clientY-this.canvasBoundsContainer.canvasOnPageLocation.y;this.createAndFireHover([r,s,""])})),this.addRxSubscription(this.canvasInputListener.observeTouchEndDocument().subscribe(()=>{this.paneManager.chartPanComponent.activateChartPanHandlers(),this.longTouchActivated&&(this.longTouchActivated=!1,this.bus.fire(Ze.EVENT_CLOSE_HOVER))}))}createHoverFromCandle(e){const t=e.xCenter(this.chartModel.scaleModel),r=this.chartModel.scaleModel.toY(e.close);return this.createHover(t,r)}createHover(e,t){if(this.chartModel.getCandles().length===0)return;const s=this.chartModel.candleFromX(e).timestamp,i={x:e,y:t,timestamp:s,timeFormatted:this.timeFormatterProvider()(s)},a=Object.entries(this.hoverProducerParts).reduce((o,l)=>Da(bn({},o),{[l[0]]:l[1].getData(i)}),{});return bn(bn({},i),a)}createAndFireHoverFromCandle(e,t=!0){const r=this.createHoverFromCandle(e);this.fireHover(r,t)}createAndFireHover([e,t],r=!0){const s=this.createHover(e,t);this.fireHover(s,r)}fireHover(e,t=!0){var r;if(e){if(this.lastHover=e,Zt()&&this.config.components.crossTool.type!=="none"){const i=(r=e.candleHover)==null?void 0:r.visualCandle.candle;i&&this.chartModel.mainCandleSeries.setActiveCandle(i)}const s=Zt()?this.longTouchActivated:t;this.bus.fire(Tn,e,s)}else this.bus.fire(Ze.EVENT_CLOSE_HOVER)}fireLastCross(e=!0){this.lastCross&&this.createAndFireHover(this.lastCross,e)}registerHoverProducerPart(e,t){this.hoverProducerParts=Da(bn({},this.hoverProducerParts),{[e]:t})}unregisterHoverProducerPart(e){delete this.hoverProducerParts[e]}}var Vf=Object.defineProperty,La=Object.getOwnPropertySymbols,jf=Object.prototype.hasOwnProperty,Gf=Object.prototype.propertyIsEnumerable,Ia=(n,e,t)=>e in n?Vf(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Zf=(n,e)=>{for(var t in e||(e={}))jf.call(e,t)&&Ia(n,t,e[t]);if(La)for(var t of La(e))Gf.call(e,t)&&Ia(n,t,e[t]);return n},$f=(n=>(n[n.left=0]="left",n[n.middle=1]="middle",n[n.right=2]="right",n))($f||{});const wt=class extends ee{constructor(n,e){super(),this.eventBus=n,this.element=e,this.xDragStartSubject=new G,this.xDragSubject=new G,this.xDragTickSubject=new G,this.xDragEndSubject=new G,this.yDragStartSubject=new G,this.yDragSubject=new G,this.yDragTickSubject=new G,this.yDragEndSubject=new G,this.mouseMoveSubject=new G,this.mouseMoveDocumentSubject=new G,this.clickSubject=new G,this.clickDocumentSubject=new G,this.dbClickSubject=new G,this.mouseDownSubject=new G,this.mouseUpSubject=new G,this.mouseUpDocumentSubject=new G,this.wheelSubject=new G,this.touchStartSubject=new G,this.touchMoveSubject=new G,this.touchEndSubject=new G,this.touchCancelSubject=new G,this.contextMenuSubject=new G,this.longTouchSubject=new G,this.pinchSubject=new G,this.scrollGestureSubject=new G,this.mouseLeavesCanvasSubject=new G,this.dragStartPoint={x:0,y:0},this.prevDragPoint={x:0,y:0},this.currentPoint={x:0,y:0},this.currentPointDocument={x:0,y:0},this.dragging=!1,this.canvasBounds={x:0,y:0,pageX:0,pageY:0,width:0,height:0},this.documentDragListeners=[],this.dragProcessListener=()=>{this.xDragSubject.next(this.currentPoint.x-this.dragStartPoint.x),this.yDragSubject.next(this.currentPoint.y-this.dragStartPoint.y),this.xDragTickSubject.next(this.currentPoint.x-this.prevDragPoint.x),this.yDragTickSubject.next(this.currentPoint.y-this.prevDragPoint.y),this.prevDragPoint.x=this.currentPoint.x,this.prevDragPoint.y=this.currentPoint.y},this.dragStartListener=t=>{this.isDraggable(t)&&(this.updateCurrentPoints(t),this.dragging=!0,this.dragStartEvent=t,this.documentDragListeners.forEach(r=>r()),this.dragStartPoint=wt.copyPoint(this.currentPoint),this.xDragStartSubject.next(this.dragStartPoint),this.yDragStartSubject.next(this.dragStartPoint),this.prevDragPoint=Zf({},this.dragStartPoint),wt.DRAG_EVENTS.forEach(r=>{document.addEventListener(r,this.dragProcessListener,!0);const s=document.removeEventListener.bind(document,r,this.dragProcessListener,!0);this.documentDragListeners.push(s),this.addSubscription(s)}),this.dragProcessListener())},this.dragListener=()=>this.mouseMoveDocumentSubject.next(this.currentPoint),this.updateElementOffsetListener=()=>this.mouseMoveSubject.next(this.currentPoint),this.dragEndListener=()=>{this.dragging=!1,this.documentDragListeners.forEach(t=>t()),this.xDragEndSubject.next(),this.yDragEndSubject.next()},this.clickHandler=()=>this.clickSubject.next(this.currentPoint),this.updateCurrentPoints=t=>{this.updateCurrentDocumentPoint(t),this.updateCurrentMousePoint(t)}}isDraggable(n){return n instanceof MouseEvent?n.button===0:n instanceof TouchEvent}startDragging(n){this.updateCurrentPoints(n),this.dragStartListener(n)}movePointer(n){this.updateCurrentPoints(n),this.dragListener(),this.updateElementOffsetListener(),this.dragging&&this.dragProcessListener()}stopDragging(){this.dragEndListener()}fixTextSelection(){const n=e=>(e.preventDefault(),!1);this.element.addEventListener("selectstart",n,!1),this.addSubscription(this.element.removeEventListener.bind(this.element,"selectstart",n,!1))}doActivate(){this.fixTextSelection(),this.documentDragListeners=[],wt.DRAG_START_EVENTS.forEach(s=>{this.element.addEventListener(s,this.dragStartListener),this.addSubscription(()=>this.element.removeEventListener(s,this.dragStartListener))}),this.trackMousePosition(),wt.DRAG_EVENTS.forEach(s=>{document.addEventListener(s,this.dragListener),this.addSubscription(document.removeEventListener.bind(document,s,this.dragListener)),this.element.addEventListener(s,this.updateElementOffsetListener),this.addSubscription(this.element.removeEventListener.bind(this.element,s,this.updateElementOffsetListener))}),wt.DRAG_END_EVENTS.forEach(s=>{document.addEventListener(s,this.dragEndListener),this.addSubscription(document.removeEventListener.bind(document,s,this.dragEndListener))}),this.addSubscription(Se(this.element,this.clickHandler,"click"));const n=s=>{this.clickDocumentSubject.next(s)};this.addSubscription(Se(document,n,"click"));const e=Qi();if(e==="apple"||e==="mobile"){const i=(()=>{let a=null;return()=>{a?(this.dbClickSubject.next(this.currentPoint),clearTimeout(a),a=null):a=window.setTimeout(()=>{a=null},250)}})();this.addSubscription(Se(this.element,i,"touchend"))}const t=(s,i=500,a=2)=>{s.preventDefault();let o=null;const l={x:s.touches[0].clientX,y:s.touches[0].clientY};let c={x:0,y:0};const u=b=>{c={x:b.touches[0].clientX,y:b.touches[0].clientY},(Math.sqrt(Math.pow(c.x-l.x,2)+Math.pow(c.y-l.y,2))>a||b.touches.length>1)&&g()},g=()=>{o&&(clearTimeout(o),o=null),this.element.removeEventListener("touchend",g),this.element.removeEventListener("touchmove",u)};o=setTimeout(()=>this.longTouchSubject.next(s),i),this.element.addEventListener("touchmove",u,{passive:!0}),this.element.addEventListener("touchend",g)};this.addSubscription(Se(this.element,s=>t(s),"touchstart")),this.addSubscription(Se(this.element,()=>this.dbClickSubject.next(this.currentPoint),"dblclick")),this.addSubscription(Se(this.element,s=>this.touchStartSubject.next(s),"touchstart")),this.addSubscription(Se(this.element,s=>this.touchMoveSubject.next(s),"touchmove",!0)),this.addSubscription(Se(this.element,s=>this.touchEndSubject.next(s),"touchend")),this.addSubscription(Se(this.element,s=>this.touchCancelSubject.next(s),"touchcancel")),this.addSubscription(Se(this.element,s=>{s.ctrlKey?this.pinchSubject.next(s):Ji(s)?this.scrollGestureSubject.next(s):this.wheelSubject.next(s),s.preventDefault()},"wheel")),this.addSubscription(Se(this.element,s=>this.contextMenuSubject.next(s),"contextmenu")),this.addSubscription(Se(this.element,()=>this.mouseDownSubject.next(this.currentPoint),"mousedown")),this.addSubscription(Se(this.element,()=>this.mouseUpSubject.next(this.currentPoint),"mouseup")),this.addSubscription(Se(document,()=>this.mouseUpDocumentSubject.next(this.currentPoint),"mouseup")),this.addRxSubscription(this.eventBus.observe(Xt).subscribe(()=>{const s=this.element.getBoundingClientRect();this.canvasBounds.x=s.left,this.canvasBounds.y=s.top,this.canvasBounds.width=s.width,this.canvasBounds.height=s.height}));const r=()=>{this.mouseLeavesCanvasSubject.next(!0)};this.element.addEventListener("mouseleave",r,!1),this.addSubscription(this.element.removeEventListener.bind(this.element,"mouseleave",r,!1))}getCurrentMousePoint(){return this.currentPoint}trackMousePosition(){wt.DRAG_EVENTS.forEach(n=>{document.addEventListener(n,this.updateCurrentPoints,!0),this.addSubscription(()=>document.removeEventListener(n,this.updateCurrentPoints,!0))})}updateCurrentDocumentPoint(n){"pageX"in n?this.currentPointDocument.x=n.pageX:n.touches!==void 0&&(this.currentPointDocument.x=n.touches[0].pageX),"pageY"in n?this.currentPointDocument.y=n.pageY:n.touches!==void 0&&(this.currentPointDocument.y=n.touches[0].pageY)}updateCurrentMousePoint(n){const e=this.element.getBoundingClientRect();"clientX"in n?this.currentPoint.x=n.clientX-e.left:n.touches!==void 0&&(this.currentPoint.x=n.touches[0].clientX-e.left),"clientY"in n?this.currentPoint.y=n.clientY-e.top:n.touches!==void 0&&(this.currentPoint.y=n.touches[0].clientY-e.top)}static copyPoint(n){return{x:n.x,y:n.y}}observeMouseMove(n=()=>!0){return this.mouseMoveSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeMouseMoveNoDrag(){return this.mouseMoveSubject.asObservable().pipe(le(()=>!this.dragging))}observeMouseMoveDocument(n=()=>!0){return this.mouseMoveDocumentSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeMouseMoveDocumentAnyElement(n=()=>!0){return this.mouseMoveDocumentSubject.asObservable().pipe(le(()=>n(this.currentPointDocument.x,this.currentPointDocument.y)),Ce(()=>this.currentPointDocument))}observeClickOnDocument(){return this.clickDocumentSubject.asObservable()}observeXDragStart(n=()=>!0){return this.xDragStartSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeXDrag(n=()=>!0){return this.xDragSubject.pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeXDragEnd(n=()=>!0){return this.xDragEndSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeXDragTick(){return this.xDragTickSubject.asObservable()}observeYDragStart(n=()=>!0){return this.yDragStartSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeYDrag(n=()=>!0){return this.yDragSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeYDragEnd(n=()=>!0){return this.yDragEndSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeYDragTick(){return this.yDragTickSubject.asObservable()}observeMouseEnter(n=()=>!0,e=!1){const t=this.mouseMoveSubject.asObservable().pipe(le(()=>!(e&&this.dragging)),Ce(()=>n(this.currentPoint.x,this.currentPoint.y))),r=this.observeMouseLeavesCanvas().pipe(Ce(()=>!1));return Ee(t,r).pipe(ke())}observeMouseLeavesCanvas(){return this.mouseLeavesCanvasSubject.asObservable()}observeClick(n=()=>!0){return this.clickSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeDbClick(n=()=>!0){return this.dbClickSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeWheel(n=()=>!0){return this.wheelSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observePinch(n=()=>!0){return this.pinchSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeScrollGesture(){return this.scrollGestureSubject.asObservable()}observeTouchStart(n=()=>!0){return this.touchStartSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeTouchMove(n=()=>!0){return this.touchMoveSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeTouchEndDocument(){return this.touchEndSubject.asObservable()}observeTouchCancelDocument(){return this.touchCancelSubject.asObservable()}observeMouseDown(n=()=>!0){return this.mouseDownSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeMouseUp(n=()=>!0){return this.mouseUpSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeMouseUpDocument(n=()=>!0){return this.mouseUpDocumentSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)))}observeContextMenu(n=()=>!0){return this.contextMenuSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)),cr(e=>e.preventDefault()))}observeLongTouch(n=()=>!0){return this.longTouchSubject.asObservable().pipe(le(()=>n(this.currentPoint.x,this.currentPoint.y)),cr(e=>e.preventDefault()))}getCurrentPoint(){return this.currentPoint}};let wn=wt;wn.DRAG_START_EVENTS=["mousedown","touchstart"],wn.DRAG_EVENTS=["mousemove","touchmove"],wn.DRAG_END_EVENTS=["mouseup","touchend","touchcancel"];var Kf=function(n){N(e,n);function e(t,r,s){t===void 0&&(t=1/0),r===void 0&&(r=1/0),s===void 0&&(s=ur);var i=n.call(this)||this;return i._bufferSize=t,i._windowTime=r,i._timestampProvider=s,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,r),i}return e.prototype.next=function(t){var r=this,s=r.isStopped,i=r._buffer,a=r._infiniteTimeWindow,o=r._timestampProvider,l=r._windowTime;s||(i.push(t),!a&&i.push(o.now()+l)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),s=this,i=s._infiniteTimeWindow,a=s._buffer,o=a.slice(),l=0;l<o.length&&!t.closed;l+=i?1:2)t.next(o[l]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,s=t._timestampProvider,i=t._buffer,a=t._infiniteTimeWindow,o=(a?1:2)*r;if(r<1/0&&o<i.length&&i.splice(0,i.length-o),!a){for(var l=s.now(),c=0,u=1;u<i.length&&i[u]<=l;u+=2)c=u;c&&i.splice(0,c+1)}},e}(G),qf=_e(722);const Jf=Symbol("MEMOIZE_CLEAR_FUNCTION");function Qf(n){const e={},t=function(){const r=Array.prototype.slice.call(arguments),s=Oa(r);return typeof e[s]=="undefined"&&(e[s]=n.apply(this,r)),e[s]}.bind(this);return t[Jf]=function(){const r=Array.prototype.slice.call(arguments),s=Oa(r);delete e[s]},t}const ng=n=>e=>{let t=!1,r,s=[];const i=a=>{r=e(...a),t=!0,s=a};return(...a)=>{const o=a.length;if(t&&o===0)return r;if(!t||s.length!==o)return i(a),r;for(let l=0;l<o;l++)if(!n.equals(s[l],a[l]))return i(a),r;return r}};function Oa(n){if(!n.every(t=>typeof t=="number"||typeof t=="string"||typeof t=="boolean"))throw Error("Arguments to memoized function can only be strings or numbers");return JSON.stringify(n)}const Ba=Qf(qf.getTimezoneOffset);class ev{constructor(e){this.config=e,this.timeZoneChangedSubject=new Kf,this.currentTzOffset=0,this.dateTimeFormatterFactory=this.initFormatterFactory(this.config.dateFormatter)}setTimeZone(e){this.config.timezone=e,this.timeZoneChangedSubject.next(e),this.currentTzOffset=this.getOffset(e)}observeTimeZoneChanged(){return this.timeZoneChangedSubject.asObservable()}initFormatterFactory(e){let t;if(e&&typeof e=="function")t=e;else if(e&&e.createFormatterFunction&&typeof e.createFormatterFunction=="function"){const r=e.createFormatterFunction;t=s=>r(s).bind(e)}else t=Ph(this.config,this.tzOffset);return t}getFormatterFactory(){return this.dateTimeFormatterFactory}getOffset(e){return new Date().getTimezoneOffset()*60*1e3+Ba(e)}tzOffset(e){const t=-new Date().getTimezoneOffset()*60*1e3;let r;return e?r=Ba(e):r=t,s=>new Date(+s+r-t)}}class kt{constructor(e,t={}){this.components=[],this.chartComponents=[],this.userInputListenerComponents=[],this.canvasModels=[];var r,s;this.parentElement=e,this.events=new il(this);const i=t;Io(i),this.config=i;const a=Bl();e.innerHTML="",e.appendChild(a.content),this.id=(r=e.getAttribute("data-id"))!=null?r:"",i.fixedSize&&(e.style.width=i.fixedSize.width+"px",e.style.height=i.fixedSize.height+"px");const o=new ev(i);this.timeZoneModel=o;const l=this.timeZoneModel.getFormatterFactory(),c=Rl(e);this.elements=c;const u=new ws(i);this.bus=u;const g=new Sf(e,(s=c.chartResizer)!=null?s:e,u,this.canvasModels,i);this.chartResizeHandler=g,g.subscribeResize(),this.components.push(g.unsubscribeAnimationUpdate.bind(g));const b=new Po(u,g);this.drawingManager=b;const P=hh(u,c.mainCanvas,c.chartResizer,this.config.components.chart.type,this.config,b,this.canvasModels);this.mainCanvasModel=P;const I=bt(u,c.overDataSeriesCanvas,i,b,this.canvasModels,c.chartResizer);this.overSeriesCanvasModel=I;const Y=new xt(I);b.addDrawer(Y,te.OVER_SERIES_CLEAR),this.dataSeriesCanvasModel=bt(u,c.dataSeriesCanvas,i,b,this.canvasModels,c.chartResizer);const k=new xt(this.dataSeriesCanvasModel);b.addDrawer(k,te.SERIES_CLEAR);const U=bt(u,c.yAxisLabelsCanvas,i,b,this.canvasModels,c.chartResizer),W=new Xn(i,u,P,l,g);this.canvasBoundsContainer=W;const q=c.mainCanvas.parentElement;if(q===null)throw new Error("Couldn't get main canvas parent");const K=new wn(u,q);this.canvasInputListener=K,this.chartComponents.push(this.canvasInputListener);const Z=new fu(u,c.hitTestCanvas,K,W,b,i,this.canvasModels,c.chartResizer);this.hitTestCanvasModel=Z;const $=new xt(Z);b.addDrawer($,te.HIT_TEST_CLEAR);const ae=new bl(u);this.canvasAnimation=ae;const ne=new ti(i,()=>W.getBounds(B.CHART),ae);this.scaleModel=ne;const oe=bt(u,c.backgroundCanvas,i,b,this.canvasModels,c.chartResizer);this.cursorHandler=new Ll(c.canvasArea,K,W,i,Z),this.chartComponents.push(this.cursorHandler),this.crossEventProducer=new Rf(u,K,W),this.chartComponents.push(this.crossEventProducer);const ce=new Zu(u,ne,W,i,ae,K,q);this.chartPanComponent=ce,this.chartComponents.push(ce),this.userInputListenerComponents.push(ce.chartAreaPanHandler);const de=new ad(this.userInputListenerComponents,u,ne,W,i,ae,K,b,this.dataSeriesCanvasModel,this.cursorHandler,this.crossEventProducer,ce,P);this.paneManager=de,this.chartComponents.push(de),this.chartModel=new Mh(de,u,this.dataSeriesCanvasModel,i,ne,l,q,W,g);const fe=new lh(this.chartModel,this.dataSeriesCanvasModel,i,ne,W,b,Z,K,oe,ce,de,this.cursorHandler);this.chartComponents.push(fe),this.chartComponent=fe;const he=this.chartComponent.chartModel;this.chartModel=he,this.canvasBoundsContainer.setMainCandleSeries(this.chartModel.mainCandleSeries),Z.addSubscriber(de.hitTestContoller),this.xAxisComponent=new sf(u,i,P,fe,ne,W,K,g,this.drawingManager,o,ce,this.cursorHandler,oe),this.chartComponents.push(this.xAxisComponent),this.userInputListenerComponents.push(this.xAxisComponent);const Fe=new xt(P);b.addDrawer(Fe,te.MAIN_CLEAR);const me=new yf(q,he,K,i);this.chartComponents.push(me),this.watermarkComponent=new pd(de,he,u,i,W,I,b),this.chartComponents.push(this.watermarkComponent);const et=bt(u,c.crossToolCanvas,i,b,this.canvasModels,c.chartResizer);this.highlightsComponent=new Iu(u,i,he,P,W,b),this.chartComponents.push(this.highlightsComponent),i.useUTCTimeOverride&&i.dateFormatter&&!i.dateFormatter.utcTimeOverride&&(i.dateFormatter.utcTimeOverride=this.createUTCTimeOverrideConfig(he)),this.navigationMapComponent=new Uu(u,he,P,i,K,W,b,l,ce,this.cursorHandler),this.chartComponents.push(this.navigationMapComponent),this.userInputListenerComponents.push(this.navigationMapComponent.navigationMapMoveHandler);const Ne=new xu(i,this.dataSeriesCanvasModel,he,W,b);this.chartComponents.push(Ne),this.yAxisComponent=new Cf(u,i,P,U,he,ne,this.canvasInputListener,W,this.drawingManager,ce,de,this.cursorHandler),this.chartComponents.push(this.yAxisComponent),this.userInputListenerComponents.push(this.yAxisComponent.yAxisScaleHandler),this.volumesComponent=new hd(this.dataSeriesCanvasModel,fe,ne,W,b,i,de),this.chartComponents.push(this.volumesComponent);const tt=new ji(P,ne,i,te.GRID,b,()=>this.canvasBoundsContainer.getBounds(B.ALL_PANES),()=>this.canvasBoundsContainer.getBounds(B.PANE_UUID(re)),()=>this.xAxisComponent.xAxisLabelsGenerator.labels,()=>this.yAxisComponent.yAxisModel.yAxisBaseLabelsModel.labels,()=>this.chartModel.toY(this.chartModel.getBaseLine()),()=>i.components.grid.visible);this.chartComponents.push(tt),this.crossToolComponent=new Jh(u,i,he,et,W,K,b,l,o,de),this.chartComponents.push(this.crossToolComponent),this.hoverProducer=new Xf(this.crossEventProducer,u,ne,i,he,K,()=>this.crossToolComponent.model.xFormatter,this.canvasBoundsContainer,this.paneManager),this.chartComponents.push(this.hoverProducer);const Xe=bt(u,c.snapshotCanvas,i,b,this.canvasModels,c.chartResizer),dt=new od(this.elements,Xe);this.snapshotComponent=dt,this.chartComponents.push(dt);const Ut=new Su(i,I,Z,he,W,b,l,this.cursorHandler,oe);this.eventsComponent=Ut,this.chartComponents.push(Ut),this.chartComponents.forEach(yr=>yr.activate()),this.enableUserControls(),b.reorderDrawers(i.drawingOrder),this.clearer=ho(this.components)}createUTCTimeOverrideConfig(e){const t=new RegExp("HH|H|mm|m|s|ss|sss|SSS");return{pattern:"MM/dd/YY",test:r=>t.test(r)&&(e.getPeriod()||0)>=86400}}static mergeConfig(e,t){for(const r in t)r in e?typeof e[r]=="object"&&kt.mergeConfig(e[r],t[r]):e[r]=t[r];return e}getConfig(){return this.config}setRtl(e){this.config.rtl=e,this.bus.fire(It)}setChartType(e){this.chartComponent.setChartType(e)}disableUserControls(){this.userInputListenerComponents.forEach(e=>e.deactivate()),this.hitTestCanvasModel.disableUserControls()}enableUserControls(){this.userInputListenerComponents.forEach(e=>e.activate()),this.hitTestCanvasModel.enableUserControls()}setGridConfig(e){var t,r,s,i,a;const o=this.config.components.grid;o.visible=(t=e.visible)!=null?t:!1,o.dash=(r=e.dash)!=null?r:[0,0],o.width=(s=e.width)!=null?s:1,o.color=(i=e.color)!=null?i:"#FFFFFF",this.config.colors.chartAreaTheme.gridColor=(a=e.color)!=null?a:"#FFFFFF",this.redraw()}setGridVisible(e){this.config.components&&this.config.components.grid&&(this.config.components.grid.visible=e,this.redraw())}setGridVertical(e){this.config.components.grid.vertical=e,this.redraw()}setGridHorizontal(e){this.config.components.grid.horizontal=e,this.redraw()}deactivate(){this.clearer(),this.disableUserControls(),this.chartComponents.forEach(e=>e.deactivate())}redraw(){this.bus.fireDraw()}getOffsets(){return this.config.components&&this.config.components.offsets}showSeparateVolumes(e=!1){this.volumesComponent&&(this.volumesComponent.setShowVolumesSeparatly(e),this.cursorHandler.toggleVolumesMode(e),this.yAxisComponent.yAxisModel.updateYAxisWidth())}setAutoScale(e=!0){this.scaleModel.autoScale(e)}setShowCandleBorders(e=!0){this.config.components&&this.config.components.chart&&(this.config.components.chart.showCandlesBorder=e,this.redraw())}valueToY(e){return this.chartModel.toY(e)}setHighLowVisible(e=!0){this.config.components&&this.config.components.highLow&&(this.config.components.highLow.visible=e,this.redraw())}setCrossToolVisible(e="cross-and-labels"){this.config.components&&this.config.components.crossTool&&(this.config.components.crossTool.type=e,this.redraw())}setHighlightsVisible(e=!0){var t;(t=this.config.components)!=null&&t.highlights&&(this.config.components.highlights.visible=e,this.redraw())}setHighlightsData(e){this.highlightsComponent.setHighlights(e)}setColors(e){He(this.config.colors,e,{addIfMissing:!0,overrideExisting:!0}),this.redraw()}addMouseMoveOnChartElementHandler(e,t){const r=this.canvasBoundsContainer.getBoundsHitTest(e),s=this.canvasInputListener.observeMouseMove(r).subscribe(t);return()=>s.unsubscribe()}addMouseEnterOnChartElementHandler(e,t,r=!1){const s=this.canvasBoundsContainer.getBoundsHitTest(e),i=this.canvasInputListener.observeMouseEnter(s,r).subscribe(t);return()=>i.unsubscribe()}addClickOnChartElementHandler(e,t){const r=this.canvasBoundsContainer.getBoundsHitTest(e),s=this.canvasInputListener.observeClick(r).subscribe(t);return()=>s.unsubscribe()}addDragEventsListener(e,t){const r=this.canvasBoundsContainer.getBoundsHitTest(e),s=Ee(this.canvasInputListener.observeYDrag(r),this.canvasInputListener.observeXDrag(r)).subscribe(t);return()=>s.unsubscribe()}destroy(){this.bus.setMuted(!0),this.chartComponents.forEach(e=>e.disable()),this.parentElement.childNodes.forEach(e=>e.remove()),this.parentElement.style.width="",this.parentElement.style.height=""}registerComponent(e,t){const r=e(this);this.components.push(r),t&&t(r),r.activate()}registerPaneFormatters(e,t){var r;(r=this.paneManager.paneComponents[e])==null||r.setPaneValueFormatters(t)}}const Ra=(n,e={})=>new kt(n,e);var tv=Object.defineProperty,nv=Object.defineProperties,rv=Object.getOwnPropertyDescriptors,Fa=Object.getOwnPropertySymbols,sv=Object.prototype.hasOwnProperty,iv=Object.prototype.propertyIsEnumerable,Na=(n,e,t)=>e in n?tv(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,av=(n,e)=>{for(var t in e||(e={}))sv.call(e,t)&&Na(n,t,e[t]);if(Fa)for(var t of Fa(e))iv.call(e,t)&&Na(n,t,e[t]);return n},ov=(n,e)=>nv(n,rv(e));window.DXChart=ov(av({},window.DXChart),{ChartBootstrap:kt,createChart:Ra})})(),dxChart5=Cn})();
