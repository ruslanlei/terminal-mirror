/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import p from"./events";import{animationFrameThrottled as x}from"./utils/request-animation-frame-throttle.utils";export function isFunction2(t){return t&&{}.toString.call(t)==="[object Function]"}export const clearer=t=>(t.forEach(n=>{if(!n.call)throw"Non function in clearer!"}),function(){t.forEach(h),t.length=0,t=void 0});export function clearerSafe(t){return function(){t.forEach(e=>typeof e=="function"&&e()),t.length=0}}function h(t){return t.call(this)}export const floor=t=>~~t,ceil=t=>~~(t+1),round=t=>~~(t+.5),shiftRight=(t,n)=>t>>n;export function getElementsInRange(t,n,e,o=()=>0){const r=(i,f)=>{let u=0,s=i.length-1;for(;s>=u;){const l=Math.ceil((u+s)/2);o(i[l])<=f?u=l+1:s=l-1}return s},c=(i,f)=>{let u=0,s=i.length-1;for(;s>=u;){const l=Math.ceil((u+s)/2);o(i[l])>=f?s=l-1:u=l+1}return u};return t.slice(c(t,n),r(t,e)+1)}export function throttle(t,n,e){let o;const r=uuid();function c(){const i=o;o=void 0,i&&n(i)}return function(i){const f=o;o=i,t&&i.preventDefault(),!f&&!(typeof e=="function"&&e())&&x(r,c)}}export function subscribeListener(t,n,e,o){return t.addEventListener(e,n,o),function(){t.removeEventListener(e,n,o)}}export function removeElement(t){if(t&&t.parentNode)return t.parentNode.removeChild(t)}export function maxMin(t){function n(e,o){const r=t(o);return r==null||!isFinite(r)?e:[Math.max(e[0],r),Math.min(e[1],r)]}return function(e){const o=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];return e?e.reduce(n,o):o}}export function hiLoReduce(t,n){return t[0]=Math.max(t[0],n[0]),t[1]=Math.min(t[1],n[1]),t}export function flattenFn(t,n){return t.concat(n)}export function extend(t,n){for(const e in n)t[e]=n[e];return t}export function relativePosOfEvent(t,n){const e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0]||t,o=n.getBoundingClientRect(),r=document.body.scrollLeft||document.documentElement.scrollLeft,c=document.body.scrollTop||document.documentElement.scrollTop,i=e.pageX-o.left-r,f=e.pageY-o.top-c;return[i,f,o]}export function findHeightParent(t){let n=t;for(;n;){if(n.nodeType===1&&n.hasAttribute("data-chart-container"))return n;if(n.parentElement!==null)n=n.parentElement;else break}return n}export function getResizerElement(){return document.querySelector('div[data-element="chart-resizer"]')}export function tryFindYAxis(t){if(t)return t.getElementsByClassName("chart--axisWrapper-y")[0]}export function cachedDimension(t,n,e){let o=t[e];return{clear:n.onPrior(p.EVENT_RESIZED,function(){o=t[e]}),valueOf(){return o}}}export function makeAsync(t){return function(){return setTimeout(t,0)}}export function setupGetters(t,n){for(const e in n)Object.defineProperty(t,e,{get:n[e]});return t}export function registerForTest(t){if(typeof window!="undefined"){if(!window.jasmine)return;window.testEnv||(window.testEnv={}),window.testEnv[t.name]=t}}export function addClass(t,n){t.classList?t.classList.add(n):t.className.indexOf(n)===-1&&(t.className+=" "+n)}export function removeClass(t,n){t.classList?t.classList.remove(n):t.className=t.className.replace(n,"")}export function setClass(t,n,e){(e?addClass:removeClass)(t,n)}const m=/^(#)([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,E=/^\s*(rgba?)\s*[(]\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*[\d.]+\s*)?[)]\s*$/i;function g(t){const n=m.exec(t)||E.exec(t);let e=[];return n&&(e=n.slice(2,5),n[1]==="#")?e.map(function(o){return parseInt(o,16)}):e}const a={};export function toRGBA(t,n){let e=a[t+n];if(!e){const o=g(t);e=o&&"rgba("+o.join(",")+","+n+")",a[t+n]=e}return e}export function valueAxisCount(t,n){n=n||{};const e=n.max||10,o=n.size||25,r=n.dim||"height";return{valueOf(){return Math.min(e,Math.max(1,Math.ceil(t[r]/o)))}}}export function updateOptionsInStorage(t,n,e,o){t=t||localStorage,t.setItem(n+"/"+e,JSON.stringify(o))}typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(n){"use strict";if(n===null)throw new TypeError("Cannot convert undefined or null to object");const e=Object(n);for(let o=1;o<arguments.length;o++){const r=arguments[o];if(r!=null)for(const c in r)Object.prototype.hasOwnProperty.call(r,c)&&(e[c]=r[c])}return e},writable:!0,configurable:!0});export function removeElementsByProp(t,n,e){n.forEach(function(o){if(o[e]){let r;t.find((c,i)=>c[e]&&c[e]===o[e]?(r=i,!0):!1),r!==void 0&&t.splice(r,1)}})}export function uuid(){const t=()=>Math.random().toString(16).slice(-4);return`${t()+t()}-${t()}-${t()}-${t()}-${t()+t()+t()}`}export const isDiffersBy=(t,n,e)=>{const o=t/n;return o>=e||o<=1/e};export function clamp(t,n,e){return Math.max(n,Math.min(t,e))}
