/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import{CanvasElement as E}from"../../canvas/canvas-bounds-container";import{ChartBaseElement as h}from"../../model/chart-base-element";import{recalculateXFormatter as c}from"../../model/date-time.formatter";import{merge as f}from"../../utils/merge.utils";import{EventsHitTestDrawer as p}from"./events-hit-test.drawer";import{EventsDrawer as w}from"./events.drawer";import{EventsModel as b}from"./events.model";export class EventsComponent extends h{constructor(e,r,n,s,i,o,a,v,d){super(),this.config=e,this.canvasModel=r,this.canvasBoundsContainer=i,this.drawingManager=o,this.formatterFactory=a,this.eventsXAxisLabelFormatterProvider=()=>c(this.config.components.events.xAxisLabelFormat,s.getPeriod(),this.formatterFactory);const t=new b(r);this.eventsModel=t,this.addChildEntity(t),n.addSubscriber(t);const m=new w(d,r,s,e,i,t,this.eventsXAxisLabelFormatterProvider);this.drawingManager.addDrawer(m,"EVENTS");const l=new p(n,s,e,i,t);this.drawingManager.addDrawerBefore(l,"HIT_TEST_EVENTS","HIT_TEST_DRAWINGS"),v.addCursorForCanvasEl(E.EVENTS,e.components.events.cursor)}setEvents(e){this.eventsModel.setEvents(e),this.canvasModel.fireDraw()}setVisible(e){this.config.components.events.visible=e,this.canvasBoundsContainer.recalculateBounds(),this.canvasModel.fireDraw()}setEventTypeVisible(e){f(this.config.components.events.eventsVisibility,e,{overrideExisting:!0,addIfMissing:!1}),this.canvasModel.fireDraw()}observeEventHovered(){return this.eventsModel.hoveredEvent.asObservable()}}
