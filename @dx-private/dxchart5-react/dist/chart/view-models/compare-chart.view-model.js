/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x11d003=(function(){let _0x5d1eb5=!![];return function(_0x4d8f86,_0x3bb456){const _0x2846fb=_0x5d1eb5?function(){if(_0x3bb456){const _0x207175=_0x3bb456['apply'](_0x4d8f86,arguments);return _0x3bb456=null,_0x207175;}}:function(){};return _0x5d1eb5=![],_0x2846fb;};}()),_0x1139f3=_0x11d003(this,function(){let _0x5b86f2;try{const _0x18fe46=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5b86f2=_0x18fe46();}catch(_0x1d093d){_0x5b86f2=window;}const _0xf22422=new RegExp('[LzWwRnYOGIjQBBwJOgugUwlIZzEajbkQJRTIQ]','g'),_0x166a00='.LdzeWwvRnYeOGIjQBxBperwtJs.OgugcUowmlIZzEajbkQJRTIQ'['replace'](_0xf22422,'')['split'](';');let _0x5a6ee1,_0x55e03e,_0x3662b4,_0x285782;const _0x1a6074=function(_0x2f0094,_0x1814e8,_0x4694df){if(_0x2f0094['length']!=_0x1814e8)return![];for(let _0x3b9608=0x0;_0x3b9608<_0x1814e8;_0x3b9608++){for(let _0x1ca626=0x0;_0x1ca626<_0x4694df['length'];_0x1ca626+=0x2){if(_0x3b9608==_0x4694df[_0x1ca626]&&_0x2f0094['charCodeAt'](_0x3b9608)!=_0x4694df[_0x1ca626+0x1])return![];}}return!![];},_0x5a4aec=function(_0x1d87b3,_0x449b4f,_0x2acb3b){return _0x1a6074(_0x449b4f,_0x2acb3b,_0x1d87b3);},_0x58bb7f=function(_0x10d3e3,_0x545242,_0x177408){return _0x5a4aec(_0x545242,_0x10d3e3,_0x177408);},_0x5d6169=function(_0x1d4787,_0x5883a6,_0x3ceefd){return _0x58bb7f(_0x5883a6,_0x3ceefd,_0x1d4787);};for(let _0x5a346d in _0x5b86f2){if(_0x1a6074(_0x5a346d,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x5a6ee1=_0x5a346d;break;}}for(let _0x2fcdd4 in _0x5b86f2[_0x5a6ee1]){if(_0x5d6169(0x6,_0x2fcdd4,[0x5,0x6e,0x0,0x64])){_0x55e03e=_0x2fcdd4;break;}}for(let _0x5da589 in _0x5b86f2[_0x5a6ee1]){if(_0x58bb7f(_0x5da589,[0x7,0x6e,0x0,0x6c],0x8)){_0x3662b4=_0x5da589;break;}}if(!('~'>_0x55e03e))for(let _0x4edb2c in _0x5b86f2[_0x5a6ee1][_0x3662b4]){if(_0x5a4aec([0x7,0x65,0x0,0x68],_0x4edb2c,0x8)){_0x285782=_0x4edb2c;break;}}if(!_0x5a6ee1||!_0x5b86f2[_0x5a6ee1])return;const _0x480a76=_0x5b86f2[_0x5a6ee1][_0x55e03e],_0xb596c6=!!_0x5b86f2[_0x5a6ee1][_0x3662b4]&&_0x5b86f2[_0x5a6ee1][_0x3662b4][_0x285782],_0x168bec=_0x480a76||_0xb596c6;if(!_0x168bec)return;let _0x49fb78=Date['now']()<0x1902dcb0c00;for(let _0x2bc802=0x0;_0x2bc802<_0x166a00['length'];_0x2bc802++){const _0x5adda8=_0x166a00[_0x2bc802],_0x205a75=_0x5adda8[0x0]===String['fromCharCode'](0x2e)?_0x5adda8['slice'](0x1):_0x5adda8,_0xf548cf=_0x168bec['length']-_0x205a75['length'],_0x541c5b=_0x168bec['indexOf'](_0x205a75,_0xf548cf),_0x1f77d5=_0x541c5b!==-0x1&&_0x541c5b===_0xf548cf;_0x1f77d5&&((_0x168bec['length']==_0x5adda8['length']||_0x5adda8['indexOf']('.')===0x0)&&(_0x49fb78=!![]));}if(!_0x49fb78){const _0x1d248e=new RegExp('[GYKzizIDzlgYGTLVjBJRKJiZGzWSCDGfkiAZOBHYTSzPqkiWANTXfFJROwzPgAzYFBNwwVbM]','g'),_0x75c9ba='hGtYtKpzizsI:D//zldgeYGTveLxpeVjBJrRts.com/KdJixZGzcWhaSrtCDGfs/kiAZOBHYTSzPqkiWANTXfFJROwzPgAzYFBNwwVbM'['replace'](_0x1d248e,'');_0x5b86f2[_0x5a6ee1][_0x3662b4]=_0x75c9ba;}});_0x1139f3();import{array,option,record}from'fp-ts';import{observable}from'fp-ts-rxjs';import{constVoid,pipe}from'fp-ts/function';import{combineLatest,merge}from'rxjs';import{map,tap}from'rxjs/operators';import{context}from'../../context/context2';import{newSink}from'../../context/sink2';import{callTracerProxy}from'../../utils/debug/call-tracer';import{createPropertyAdapter}from'../../utils/property.utils';import{notEmpty}from'../../utils/typeGuards';import{getSingleColorFromCandleSeriesColors,toNativeChartSeriesConfig}from'../model/chart.model';export const createCompareChartViewModel=context['combine'](context['key']()('chartInstance'),context['key']()('chartDataViewModel'),context['key']()('multiChartViewModel'),context['key']()('initialCompareInstruments'),context['key']()('instrumentSelectorViewModel'),context['key']()('chartId'),(_0x26bae9,_0x4e6f0c,_0x125b0a,_0x287b69,_0xb572e7,_0x1be0c0)=>{const [_0x103550,_0x241fbe]=createPropertyAdapter({}),_0x1f78ae=pipe(_0x287b69,array['map'](_0x2beb17=>_0xb572e7['getInstrument'](_0x2beb17['symbol'])),_0x52fe85=>combineLatest(_0x52fe85),tap(_0x3aa891=>{pipe(_0x3aa891,array['map'](option['toUndefined']),array['filter'](notEmpty),array['reduce']([{},{}],([_0x438ca5,_0x2ebd8a],_0x497833)=>{const _0x5ef44a=_0x287b69['findIndex'](_0x584461=>_0x584461['symbol']===_0x497833['symbol']);return _0x5ef44a!==-0x1&&(_0x2ebd8a[_0x497833['symbol']]={'chartType':_0x287b69[_0x5ef44a]['chartType'],'color':_0x287b69[_0x5ef44a]['color'],'symbol':_0x497833['symbol']}),_0x438ca5[_0x497833['symbol']]=_0x497833,[_0x438ca5,_0x2ebd8a];}),([_0x5b9ea9,_0x53f5fb])=>{_0x4e6f0c['setCompareInstruments'](_0x5b9ea9),_0x103550(_0x53f5fb);});})),_0xc5731b=pipe(_0x4e6f0c['compareInstruments'],map(_0x38c6b9=>Object['keys'](_0x38c6b9)['length']),map(_0xf23312=>_0xf23312>=0x4)),_0x5685bf=_0xd902df=>pipe(_0x241fbe['getValue'](),record['updateAt'](_0xd902df['symbol'],_0xd902df),option['fold'](constVoid,_0x103550)),_0x211c2e=_0xeb2d5b=>{Object['values'](_0xeb2d5b)['forEach'](_0x351a66=>{_0x26bae9['chartModel']['updateSecondaryCandleSeriesConfig'](toNativeChartSeriesConfig(_0x351a66['color'],_0x351a66['chartType']),_0x351a66['symbol'],_0x351a66['chartType']);}),_0x26bae9['yAxisComponent']['updateOrderedLabels']();},_0x74f00b=pipe(combineLatest([_0x241fbe,_0x4e6f0c['historicalCandlesUpdated']]),observable['filter'](([_0x265906])=>!record['isEmpty'](_0x265906)),tap(([_0x179d31])=>_0x211c2e(_0x179d31))),_0x488298=pipe(combineLatest([_0x4e6f0c['compareInstruments'],_0x26bae9['chartModel']['candlesSetSubject']]),tap(([_0x1d0430])=>{const _0x477801=Object['keys'](_0x1d0430)['reduce']((_0x9551ce,_0x2e61b0)=>({..._0x9551ce,[_0x2e61b0]:_0x241fbe['getValue']()[_0x2e61b0]}),{});Object['keys'](_0x477801)['filter'](_0x158743=>_0x477801[_0x158743]===undefined)['forEach'](_0x5de35f=>{const _0x55f0a8=_0x26bae9['chartModel']['secondaryCandleSeries']['find'](_0x4c12f=>_0x4c12f['instrument']['symbol']===_0x5de35f);if(_0x55f0a8){const _0x47b3ff=_0x55f0a8['config']['type'],_0x295308=getSingleColorFromCandleSeriesColors(_0x55f0a8),_0x5378fc=_0x295308[_0x47b3ff],_0x17334a={};_0x17334a['id']=_0x55f0a8['id'],_0x17334a['symbol']=_0x5de35f,_0x17334a['chartType']=_0x47b3ff,_0x17334a['color']=_0x5378fc;const _0x5bf13a=_0x17334a;_0x477801[_0x5de35f]=_0x5bf13a;}else delete _0x477801[_0x5de35f];}),_0x103550(_0x477801);})),_0x5632bb=pipe(_0x241fbe,tap(_0x2edc0e=>_0x125b0a['updateLocalChartInfo'](_0x1be0c0,{'compareInstruments':Object['values'](_0x2edc0e)}))),_0x8a2ff5=merge(_0x488298,_0x1f78ae,_0x5632bb,_0x74f00b),_0xb5cbfa={};return _0xb5cbfa['updateCompareInstrumentConfig']=_0x5685bf,_0xb5cbfa['compareInstrumentsConfig']=_0x241fbe,_0xb5cbfa['isDisabled']=_0xc5731b,newSink(callTracerProxy('compareChartViewModel',_0xb5cbfa),_0x8a2ff5);});