/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import{registerForTest as l}from"./utils";import{arrayRemove as u,identity as d}from"./utils/utils-index";import n,{EVENT_DRAW as a}from"./events";import{Subject as E}from"rxjs";export default class o{constructor(h){this.UNKNOWN_ARR=[],this.handlers={},this.muted=!1,this.unsub=(t,s)=>{const i=this.handlers[t];i!==void 0&&u.call(i,s)},this.add=(t,s,i)=>(s in this.handlers?t.call(this.handlers[s],i):this.handlers[s]=[i],this.unsub.bind(this,s,i)),this.on=(t,s)=>this.add(this.UNKNOWN_ARR.push,t,s),this.observe=t=>{const s=new E,i=s.next.bind(s),e=s.unsubscribe.bind(s);return this.on(t,i),s.unsubscribe=()=>{this.unsub(t,i),e()},s.asObservable()},this.onPrior=(t,s)=>this.add(this.UNKNOWN_ARR.unshift,t,s),this.off=this.unsub,this.fire=(t,...s)=>{var i;if(this.log("chart event: "+t),!this.muted){const e=(i=this.handlers[t])!==null&&i!==void 0?i:[];let r;for(r=0,e.length;r<e.length;r++)e[r].apply(null,s)}},this.fireAsync=(t,s)=>{if(!this.muted)return window.setTimeout(this.fire.bind(this,t,s),0)},this.setMuted=t=>{this.muted=t},this.types={CROSS:n.EVENT_CROSS,HOVER:n.EVENT_HOVER,CLOSE_HOVER:n.EVENT_CLOSE_HOVER,RESIZED:n.EVENT_RESIZED,CHART_DOUBLE_CLICK:n.EVENT_CHART_DOUBLE_CLICK},this.clear=()=>{this.handlers={}},this.log=h.logEvents&&typeof console!="undefined"&&Function.prototype.bind.call(console.log,console)||d}fireDraw(h){this.fire(a,h)}}l(o);
