/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import{calculateSymbolHeight as x,calculateTextWidth as f}from"../../utils/canvas/canvas-font-measure-tool.utils";import{getFontFromConfig as u}from"./y-axis.model";import{clipToBounds as y}from"../../drawers/data-series.drawer";export class YAxisDrawer{constructor(e,o,t,s,i,l=()=>!0,r){this.fullConfig=e,this.yAxisState=o,this.canvasModel=t,this.labelsProvider=s,this.axisBounds=i,this.drawPredicate=l,this.toY=r}draw(){if(this.drawPredicate()){const e=this.labelsProvider(),o=this.axisBounds(),t=this.canvasModel.ctx;t.fillStyle=this.getBackgroundColor(),t.fillRect(o.x,o.y,o.width,o.height);const s=u(this.yAxisState),i=x(s,t),l=this.getLabelTextColor();t.save(),y(t,o),this.drawLabels(t,e,o,i,s,l),t.restore()}}drawLabels(e,o,t,s,i,l){e.fillStyle=l,e.font=i;const r=e.measureText("00.0"),a=r.actualBoundingBoxAscent+r.actualBoundingBoxDescent,d=t.y+a,g=t.y+t.height-a;o.forEach(h=>{const c=this.toY(h.value);c>d&&c<g&&m(e,t,h.text,c,s,i,this.yAxisState.labelBoxMargin.end,this.yAxisState.align)})}getCanvasIds(){return[this.canvasModel.canvasId]}getBackgroundColor(){return this.fullConfig.colors.yAxis.backgroundColor}getLabelTextColor(){return this.fullConfig.colors.yAxis.labelTextColor}}const m=(n,e,o,t,s,i,l,r)=>{const a=r==="right"?e.x+e.width-f(o,n,i)-l:e.x+l;n.fillText(o,a,t+s/2-1)};
