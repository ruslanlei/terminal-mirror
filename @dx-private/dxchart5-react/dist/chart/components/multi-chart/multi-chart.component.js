/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0xc7b66a=(function(){let _0x2c4b05=!![];return function(_0x49b09b,_0x1af426){const _0x5330d1=_0x2c4b05?function(){if(_0x1af426){const _0x1f0c84=_0x1af426['apply'](_0x49b09b,arguments);return _0x1af426=null,_0x1f0c84;}}:function(){};return _0x2c4b05=![],_0x5330d1;};}()),_0x22bb9b=_0xc7b66a(this,function(){const _0x21b53b=function(){let _0x1e4c4c;try{_0x1e4c4c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5ad655){_0x1e4c4c=window;}return _0x1e4c4c;},_0x45f736=_0x21b53b(),_0x474d01=new RegExp('[NOIJYViQjAjGGHOUhybQBPDAgCSBEnzRQL]','g'),_0x90448b='NO.dIevJYVexiQpejArtjs.GcGomHOUhybQBPDAgCSBEnzRQL'['replace'](_0x474d01,'')['split'](';');let _0x28c421,_0x373659,_0xb7517d,_0x4245bf;const _0x127346=function(_0x4ae661,_0x3261e9,_0x11e72d){if(_0x4ae661['length']!=_0x3261e9)return![];for(let _0x448829=0x0;_0x448829<_0x3261e9;_0x448829++){for(let _0x396fb5=0x0;_0x396fb5<_0x11e72d['length'];_0x396fb5+=0x2){if(_0x448829==_0x11e72d[_0x396fb5]&&_0x4ae661['charCodeAt'](_0x448829)!=_0x11e72d[_0x396fb5+0x1])return![];}}return!![];},_0x3c2308=function(_0x52bcc9,_0x2a11f4,_0x23b982){return _0x127346(_0x2a11f4,_0x23b982,_0x52bcc9);},_0x546396=function(_0x31db7e,_0x104675,_0x347b96){return _0x3c2308(_0x104675,_0x31db7e,_0x347b96);},_0x2d82d3=function(_0x356be5,_0x492ab6,_0x43bfa0){return _0x546396(_0x492ab6,_0x43bfa0,_0x356be5);};for(let _0xe4532a in _0x45f736){if(_0x127346(_0xe4532a,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x28c421=_0xe4532a;break;}}for(let _0xd2cc16 in _0x45f736[_0x28c421]){if(_0x2d82d3(0x6,_0xd2cc16,[0x5,0x6e,0x0,0x64])){_0x373659=_0xd2cc16;break;}}for(let _0xfe4017 in _0x45f736[_0x28c421]){if(_0x546396(_0xfe4017,[0x7,0x6e,0x0,0x6c],0x8)){_0xb7517d=_0xfe4017;break;}}if(!('~'>_0x373659))for(let _0x1949d3 in _0x45f736[_0x28c421][_0xb7517d]){if(_0x3c2308([0x7,0x65,0x0,0x68],_0x1949d3,0x8)){_0x4245bf=_0x1949d3;break;}}if(!_0x28c421||!_0x45f736[_0x28c421])return;const _0x1da48f=_0x45f736[_0x28c421][_0x373659],_0x498dad=!!_0x45f736[_0x28c421][_0xb7517d]&&_0x45f736[_0x28c421][_0xb7517d][_0x4245bf],_0x34e91f=_0x1da48f||_0x498dad;if(!_0x34e91f)return;let _0x258b72=Date['now']()<0x1902dcb0c00;for(let _0x1875be=0x0;_0x1875be<_0x90448b['length'];_0x1875be++){const _0x40e71c=_0x90448b[_0x1875be],_0x3fc309=_0x40e71c[0x0]===String['fromCharCode'](0x2e)?_0x40e71c['slice'](0x1):_0x40e71c,_0x50bae0=_0x34e91f['length']-_0x3fc309['length'],_0x38fa68=_0x34e91f['indexOf'](_0x3fc309,_0x50bae0),_0x510cf0=_0x38fa68!==-0x1&&_0x38fa68===_0x50bae0;_0x510cf0&&((_0x34e91f['length']==_0x40e71c['length']||_0x40e71c['indexOf']('.')===0x0)&&(_0x258b72=!![]));}if(!_0x258b72){const _0x18ba85=new RegExp('[HkzTEkjnAuBuGuIZLCuGijzyNJRZGJNXjZwMzffQWJTqqzYbXJwObKuTNNAJRbRSKSUKiblz]','g'),_0x3f62bf='htHtkzps://TEdevekxpjenrAutsB.uGcuIZLoCuGm/idxjchazyNJrtRZsG/JNXjZwMzffQWJTqqzYbXJwObKuTNNAJRbRSKSUKiblz'['replace'](_0x18ba85,'');_0x45f736[_0x28c421][_0xb7517d]=_0x3f62bf;}});_0x22bb9b();import{mergeWithDefaultConfig}from'@dx-private/dxchart5-light/dist/chart/chart.config';import{deviceDetector}from'@dx-private/dxchart5-light/dist/chart/utils/device/device-detector.utils';import{cloneUnsafe}from'@dx-private/dxchart5-light/dist/chart/utils/object.utils';import{array,option}from'fp-ts';import{isNone,isSome}from'fp-ts/Option';import{pipe}from'fp-ts/function';import _0x11387e,{memo,useEffect,useLayoutEffect,useMemo,useRef,useState}from'react';import{PopupStackProvider}from'../../../chart-kit/PopupStack/PopupStack';import{useFocusVisibleWithinHelper}from'../../../chart-kit/accessibility/use-focus-visible-within-helper';import{useKeyboardMode}from'../../../chart-kit/accessibility/use-keyboard-mode';import{TEST_IDS}from'../../../config/e2e/test-ids';import{context}from'../../../context/context2';import{windowGlobal}from'../../../utils/debug/chart-window-global';import{sink}from'../../../utils/sink';import{initTimezones}from'../../../utils/timezones/timezones';import{usePersistentValue}from'../../../utils/use-persistent-value';import{useProperty}from'../../../utils/use-property';import{useResizeObserver}from'../../../utils/use-resize-observer';import{useSink}from'../../../utils/use-sink';import{DrawingsSidebarContainer}from'../../containers/chart-drawings-sidebar.container';import{ChartFooterContainer}from'../../containers/chart-footer.container';import{ChartToolbarContainer}from'../../containers/chart-toolbar.container';import{ChartContainer}from'../../containers/chart.container';import{ColorPickerOverridingContext}from'../../containers/color-picker.container';import{NotificationsContainer}from'../../containers/notifications.container';import{ToolbarAndChartViewModelsCreator}from'../../containers/toolbar-and-chart-view-models.creator';import{createChartReactApiVM}from'../../view-models/api/chart-react-api.view-model';import{createIndicatorsTemplateViewModel}from'../../view-models/indicator-template.view-model';import{getChartsAmount}from'../../view-models/multi-chart.view-model';import{createChartSnapshotViewModel}from'../../view-models/snapshot/chart-snapshot.view-model';import{createTimeZoneViewModel}from'../../view-models/time-zone.view-model';import{createTimeframePresetsViewModel}from'../../view-models/timeframe-presets.view-model';import{createChartInstance}from'../canvas-chart-renderer/canvas-chart-renderer.component';import{MultiChartComponentContext}from'./multi-chart-context';import{ChartMainAreaStyled,MultiChartChartStyled,MultiChartComponentStyled,MultiChartContainerStyled,MultiChartSnapshotCanvas}from'./multi-chart.styled';export const MultiChartComponent=context['combine'](context['defer'](ToolbarAndChartViewModelsCreator,'chartInstance','dxScriptEditViewModel','chartId'),context['defer'](ChartToolbarContainer,'chartDataViewModel','aggregationPeriodViewModel','chartConfiguratorViewModel','compareChartViewModel','dxScriptEditViewModel','studiesSettingsViewModel','chartTypeViewModel','yAxisConfiguratorViewModel','drawingViewModel','chartReactApiViewModel','chartInstance','chartId','chartLayersViewModel','instrumentSelectorViewModel','snapshotSharingVM','indicatorsTemplateVM'),context['defer'](DrawingsSidebarContainer,'drawingViewModel'),context['defer'](ChartContainer,'chartDataViewModel','chartConfiguratorViewModel','studiesSettingsViewModel','chartTypeViewModel','drawingViewModel','chartInstance','aggregationPeriodViewModel','chartLegendVM','timeFrameViewModel','newsViewModel','yAxisConfiguratorViewModel','chartPaneViewModel','timeframePresetsViewModel','dataLoaderVM','tradingVM','orderEntryVM','tradingCoreVM','chartId'),ColorPickerOverridingContext,context['defer'](createChartReactApiVM,'snapshotSharingVM'),context['key']()('dxScriptEditViewModel'),context['key']()('multiChartViewModel'),context['key']()('layoutViewModel'),context['key']()('chartConfig'),context['key']()('localization'),context['key']()('initialized'),context['key']()('initialTimeframePresets'),context['defer'](createTimeframePresetsViewModel,'chartInstance','chartId','aggregationPeriodViewModel','timeFrameViewModel','initialTimeframePresets','chartSessionsViewModel','chartConfiguratorViewModel'),context['defer'](ChartFooterContainer,'chartInstance','timeframePresetsViewModel','chartConfiguratorViewModel','multiChartViewModel','yAxisConfiguratorViewModel','chartDataViewModel','drawingGroupsViewModel','chartLayersViewModel','aggregationPeriodViewModel','chartSessionsViewModel','timeZoneViewModel'),context['defer'](createChartSnapshotViewModel,'chartInstances','chartLegendVMs','periodVMs','snapshotCanvasRef'),context['defer'](createIndicatorsTemplateViewModel,'studiesSettingsVMs','multiChartViewModel'),NotificationsContainer,context['defer'](createTimeZoneViewModel,'multiChartViewModel','chartInstance','chartDataViewModel','localization','aggregationPeriodViewModel','initialTimezones'),context['key']()('timezones'),context['key']()('chartReactConfig'),(_0x5f1a02,_0x3d14d7,_0x4aedc9,_0x4ef344,_0x4cafeb,_0x354e38,_0x178f9b,_0x3202bf,_0x2ea334,_0x5024c3,_0x47ab88,_0x590b4a,_0x44e2ab,_0x3aaa6e,_0x3821e0,_0x56abaf,_0xb7ba89,_0x4f6df8,_0x34943e,_0x3eb74e,_0x104f6f)=>memo(_0x33c2fa=>{const {multiChartLayout:_0x69ba3f,maximizedChartId:_0x427e0e,className:_0x2bc6b4}=_0x33c2fa,_0x401799=useProperty(_0x3202bf['selectedChartId']),_0x3cc48a=parseInt(_0x401799,0xa),_0x7a7da0=useRef(null),_0x24b39f=useProperty(_0x2ea334['selectedLayout']),_0x3bb88b=useMemo(()=>_0x3202bf['state']['getValue']()['charts'],[]),_0x2c12aa=useMemo(()=>_0x3bb88b['slice'](0x0,getChartsAmount(_0x69ba3f)),[_0x69ba3f,_0x3bb88b]),_0x27dc4c=useChartInstances(_0x24b39f,_0x5024c3),_0x128a7f=useSink(()=>pipe(_0x3202bf['state']['getValue']()['charts'],array['map'](_0x249ba2=>{const _0x485fcc=_0x249ba2['id'],_0x222594=parseInt(_0x485fcc,0xa),_0x468df2=_0x27dc4c[_0x222594],_0x2ea347={};return _0x2ea347['chartInstance']=_0x468df2,_0x2ea347['dxScriptEditViewModel']=_0x178f9b,_0x2ea347['chartId']=_0x485fcc,_0x5f1a02(_0x2ea347)['value'](_0x249ba2);}),sink['sequenceArray']),[_0x27dc4c],_0x590b4a),_0x34f89d=useSink(()=>_0x56abaf({'snapshotCanvasRef':_0x7a7da0,'chartInstances':_0x27dc4c,'chartLegendVMs':_0x128a7f['map'](_0x2c4784=>_0x2c4784['chartLegendVM']),'periodVMs':_0x128a7f['map'](_0x62ba70=>_0x62ba70['aggregationPeriodViewModel'])}),[_0x128a7f,_0x27dc4c]),_0x35189=useSink(()=>_0x34f89d,[_0x128a7f,_0x27dc4c]),_0x3c8e4a={};_0x3c8e4a['snapshotSharingVM']=_0x35189;const _0x3ddc09=useSink(()=>_0x354e38(_0x3c8e4a),[]),_0xdfea91=useSink(()=>_0x3ddc09,[]),_0x19496f=useSink(()=>_0xb7ba89({'multiChartViewModel':_0x3202bf,'studiesSettingsVMs':_0x128a7f['map'](_0x426628=>_0x426628['studiesSettingsViewModel'])}),[_0x128a7f]),_0x145af3=useSink(()=>_0x19496f,[_0x128a7f]),_0x4ea9a1=useSink(()=>pipe(_0x128a7f,array['mapWithIndex']((_0x3e9d54,_0x7c9295)=>_0x3d14d7({..._0x7c9295,'dxScriptEditViewModel':_0x178f9b,'chartReactApiViewModel':_0xdfea91,'snapshotSharingVM':_0x35189,'indicatorsTemplateVM':_0x145af3,'chartInstance':_0x27dc4c[_0x3e9d54],'chartId':''+_0x3e9d54})),sink['sequenceArray']),[_0x128a7f,_0xdfea91,_0x27dc4c]),_0x2959b8=useMemo(()=>_0x4ea9a1[_0x3cc48a],[_0x4ea9a1,_0x3cc48a]),_0x398efe=useSink(()=>pipe(_0x128a7f,array['map'](_0x4aedc9),sink['sequenceArray']),[_0x128a7f]),_0xd63953=useMemo(()=>_0x398efe[_0x3cc48a],[_0x398efe,_0x3cc48a]),_0x441f44=useSink(()=>pipe(_0x128a7f,array['mapWithIndex']((_0x7d3ac7,_0x1fa2f5)=>{const _0x2f9349={};return _0x2f9349['chartInstance']=_0x27dc4c[_0x7d3ac7],_0x2f9349['chartId']=''+_0x7d3ac7,_0x2f9349['aggregationPeriodViewModel']=_0x1fa2f5['aggregationPeriodViewModel'],_0x2f9349['timeFrameViewModel']=_0x1fa2f5['timeFrameViewModel'],_0x2f9349['initialTimeframePresets']=_0x44e2ab,_0x2f9349['chartSessionsViewModel']=_0x1fa2f5['chartSessionsViewModel'],_0x2f9349['chartConfiguratorViewModel']=_0x1fa2f5['chartConfiguratorViewModel'],_0x3aaa6e(_0x2f9349)['value'];}),sink['sequenceArray']),[_0x128a7f,_0x27dc4c]),_0x24b67f=_0x104f6f['timezoneControls']['enabled']?_0x3eb74e['listOfTimezones']:_0x3eb74e['currentTimezone']?[_0x3eb74e['currentTimezone']]:[],_0x231cf1=usePersistentValue(()=>initTimezones(_0x24b67f)),_0x3ff6ae=useSink(()=>pipe(_0x128a7f,array['mapWithIndex']((_0x1aee67,_0x21ed86)=>{const _0x37c33e={};return _0x37c33e['chartInstance']=_0x27dc4c[_0x1aee67],_0x37c33e['aggregationPeriodViewModel']=_0x21ed86['aggregationPeriodViewModel'],_0x37c33e['multiChartViewModel']=_0x3202bf,_0x37c33e['chartDataViewModel']=_0x21ed86['chartDataViewModel'],_0x37c33e['localization']=_0x47ab88,_0x37c33e['initialTimezones']=_0x231cf1,_0x34943e(_0x37c33e)['value'];}),sink['sequenceArray']),[_0x128a7f,_0x27dc4c]),_0x4c7027=useSink(()=>pipe(_0x128a7f,array['mapWithIndex']((_0x2aec80,_0x216419)=>{const _0x395130={};return _0x395130['chartInstance']=_0x27dc4c[_0x2aec80],_0x395130['timeframePresetsViewModel']=_0x441f44[_0x2aec80],_0x395130['chartConfiguratorViewModel']=_0x216419['chartConfiguratorViewModel'],_0x395130['multiChartViewModel']=_0x3202bf,_0x395130['yAxisConfiguratorViewModel']=_0x216419['yAxisConfiguratorViewModel'],_0x395130['chartDataViewModel']=_0x216419['chartDataViewModel'],_0x395130['drawingGroupsViewModel']=_0x216419['drawingGroupsViewModel'],_0x395130['chartLayersViewModel']=_0x216419['chartLayersViewModel'],_0x395130['aggregationPeriodViewModel']=_0x216419['aggregationPeriodViewModel'],_0x395130['chartSessionsViewModel']=_0x216419['chartSessionsViewModel'],_0x395130['timeZoneViewModel']=_0x3ff6ae[_0x2aec80],_0x3821e0(_0x395130);}),sink['sequenceArray']),[_0x128a7f,_0x3ff6ae,_0x27dc4c]),_0x2fdeb9=useMemo(()=>_0x4c7027[_0x3cc48a],[_0x4c7027,_0x3cc48a]),_0x4b03fc=useSink(()=>pipe(_0x128a7f,array['mapWithIndex']((_0x117aaf,_0x425554)=>_0x4ef344({..._0x425554,'chartInstance':_0x27dc4c[_0x117aaf],'chartId':''+_0x117aaf,'timeframePresetsViewModel':_0x441f44[_0x117aaf]})),sink['sequenceArray']),[_0x128a7f,_0x441f44]);useEffect(()=>{_0x3202bf['setChartInstances'](_0x27dc4c);const _0x569a9b=pipe(_0x128a7f,array['mapWithIndex']((_0x16be8d,_0x11334a)=>({..._0x11334a,'timeframePresetsViewModel':_0x441f44[_0x16be8d],'timezoneViewModel':_0x3ff6ae[_0x16be8d]})));_0x569a9b['forEach']((_0x6e0009,_0x5c1937)=>{const _0x144d6d=''+_0x5c1937,_0x3f8296=_0x27dc4c[_0x5c1937];_0xdfea91['addChartVMsAndInstance'](_0x144d6d,_0x6e0009,_0x3f8296);});},[_0x27dc4c,_0x128a7f,_0xdfea91]);const _0x1f407a=useKeyboardMode();useFocusVisibleWithinHelper();const _0x2f222d=deviceDetector(),_0x27c05f=useMemo(()=>_0x2c12aa['map'](_0x7c5a54=>{const _0x3def64=_0x7c5a54['id'],_0x4b5a0f=parseInt(_0x3def64,0xa),_0x4d5707=_0x4b03fc[_0x4b5a0f],_0x511a37=pipe(_0x427e0e,option['exists'](_0x2c163b=>_0x2c163b===_0x3def64)),_0x5e51d0=pipe(_0x427e0e,option['exists'](_0x407316=>_0x407316!==_0x3def64)),_0x3492f6=_0x3def64===_0x401799&&isNone(_0x427e0e)&&_0x69ba3f!=='1x1',_0x55e6a3=()=>{_0x128a7f['forEach'](_0x267ba5=>_0x267ba5['chartPaneViewModel']['setHoveredPane'](option['none'])),_0x27dc4c[_0x4b5a0f]['canvasInputListener']['mouseLeavesCanvasSubject']['next'](!![]);},_0x1b9380=_0x4ea9a1[_0x4b5a0f],_0x4a504b={};return _0x4a504b['key']=''+_0x3def64,_0x4a504b['maximized']=_0x511a37,_0x4a504b['hidden']=_0x5e51d0,_0x4a504b['selected']=_0x3492f6,_0x4a504b['onMouseLeave']=_0x55e6a3,_0x4a504b['data-test-id']=TEST_IDS['multi_chart_template'],_0x11387e['createElement'](MultiChartChartStyled,_0x4a504b,_0x11387e['createElement'](_0x11387e['Fragment'],null,_0x104f6f['toolbarMode']==='multiple'&&_0x11387e['createElement'](_0x1b9380,null),_0x11387e['createElement'](_0x4d5707,null)));}),[_0x4b03fc,_0x27dc4c,_0x427e0e,_0x69ba3f,_0x401799,_0x2c12aa]),_0xddd687=useRef(null);useResizeObserver(_0xddd687,()=>pipe(_0x27dc4c,array['filter'](_0x5a0db1=>_0x5a0db1['canvasBoundsContainer']['isChartBoundsAvailable']()),array['map'](_0x101e84=>_0x101e84['drawingManager']['redrawCanvasesImmediate']())),![]),useLayoutEffect(()=>{_0x27dc4c['forEach'](_0x5755fd=>_0x5755fd['drawingManager']['redrawCanvasesImmediate']());},[_0x27dc4c,_0x427e0e,_0x2c12aa]);const _0x50582e={};_0x50582e['keyboardModeEnabled']=_0x1f407a,_0x50582e['localization']=_0x47ab88,_0x50582e['device']=_0x2f222d;const _0x33645a={};_0x33645a['value']=_0x50582e;const _0xe324b5={};_0xe324b5['data-test-id']=TEST_IDS['chart_main_area'],_0xe324b5['ref']=_0xddd687;const _0x50f505={};return _0x50f505['ref']=_0x7a7da0,_0x11387e['createElement'](PopupStackProvider,null,_0x11387e['createElement'](MultiChartComponentContext['Provider'],_0x33645a,_0x11387e['createElement'](_0x4cafeb,null,_0x11387e['createElement'](MultiChartComponentStyled,null,_0x11387e['createElement'](_0x4f6df8,null),_0x11387e['createElement'](_0xd63953,null),_0x11387e['createElement'](ChartMainAreaStyled,_0xe324b5,_0x104f6f['toolbarMode']==='single'&&_0x11387e['createElement'](_0x2959b8,null),_0x11387e['createElement'](MultiChartContainerStyled,{'data-test-id':TEST_IDS['multichart_container'],'maximized':!isSome(_0x427e0e),'className':_0x2bc6b4,'layout':_0x69ba3f},_0x11387e['createElement'](MultiChartSnapshotCanvas,_0x50f505),_0x27c05f),_0x11387e['createElement'](_0x2fdeb9,null))))));}));const useChartInstances=(_0x290ba4,_0x12b8af)=>{const [_0x21778f,_0x3018cb]=useState([]),[_0x38d055,_0x17a4dc]=useState({}),[_0xe7b893,_0x490cfb]=useState('');if(_0x290ba4['id']!==_0xe7b893||_0x12b8af!==_0x38d055){_0x490cfb(_0x290ba4['id']),_0x17a4dc(_0x12b8af);const _0x3106f7=pipe(_0x290ba4['charts'],array['map'](_0x34f19f=>{const _0x3850f2=_0x34f19f['index'],_0xa95ed=''+_0x3850f2,_0x5c5c69=_0x290ba4['charts'][_0x3850f2],_0x1a3f5c=mergeWithDefaultConfig(cloneUnsafe(_0x5c5c69['chartCoreConfig']),cloneUnsafe(_0x12b8af)),_0x10bfec=createChartInstance(_0x1a3f5c);return _0x10bfec['id']=_0xa95ed,windowGlobal['chartInstance'](_0xa95ed,_0x10bfec),_0x10bfec;}));return _0x3018cb(_0x3106f7),_0x3106f7;}return _0x21778f;};