{"version":3,"file":"NumberInput.vue2.js","sources":["../../../../../components/numberInput/NumberInput.vue"],"sourcesContent":["<template>\n  <label\n    :class=\"[\n      $style[size],\n      ...states,\n      isFocused && $style.focus,\n      !!error && $style.withError,\n    ]\"\n  >\n    <span\n      v-if=\"('label' in $slots) || label\"\n      :class=\"$style.label\"\n    >\n      <slot name=\"label\">\n        {{ label }}\n      </slot>\n    </span>\n    <div :class=\"[$style.field]\">\n      <input\n        ref=\"field\"\n        type=\"number\"\n        :value=\"localValue\"\n        :tabindex=\"computedTabIndex\"\n        :step=\"step\"\n        :disabled=\"isDisabled\"\n        @input=\"onInput\"\n        @focus=\"onFocus\"\n        @blur=\"onBlur\"\n        @keydown=\"onKeydown\"\n      >\n      <div\n        v-if=\"!hideArrows\"\n        :class=\"$style.arrows\"\n      >\n        <button\n          tabindex=\"-1\"\n          type=\"button\"\n          :class=\"[\n            $style.arrowButton,\n            localValue === max && $style.disabled,\n          ]\"\n          @click=\"onClickIncrement\"\n        >\n          <Icon\n            :size=\"6\"\n            icon=\"tinyArrowUp\"\n          />\n        </button>\n        <button\n          tabindex=\"-1\"\n          type=\"button\"\n          :class=\"[\n            $style.arrowButton,\n            localValue === min && $style.disabled,\n          ]\"\n          @click=\"onClickDecrement\"\n        >\n          <Icon\n            :size=\"6\"\n            icon=\"tinyArrowDown\"\n          />\n        </button>\n      </div>\n      <div\n        v-if=\"'append' in $slots\"\n        :class=\"$style.append\"\n        :style=\"{\n          ...(appendMinWidth ? {\n            minWidth: `${appendMinWidth}px`,\n          } : {})\n        }\"\n      >\n        <slot name=\"append\" />\n      </div>\n    </div>\n    <FieldError\n      :size=\"size\"\n      :text=\"error\"\n      :offset=\"4\"\n      :class=\"$style.errorMessage\"\n      :show-icon=\"showErrorIcon\"\n    />\n  </label>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, watch } from 'vue';\nimport { add, subtract, roundToDecimalPlaces } from '@terminal/common/utils/number';\nimport { useLocalValue } from '@/hooks/useLocalValue';\nimport FieldError from '@/components/fieldError/FieldError.vue';\nimport Icon from '@/components/icon/Icon.vue';\nimport { useComputedState } from '@/hooks/useComputedState';\nimport { NumberInputEmits, NumberInputNormalizer, NumberInputProps } from './index';\n\nconst props = withDefaults(\n  defineProps<NumberInputProps>(),\n  {\n    min: -Infinity,\n    max: Infinity,\n    tabIndex: 0,\n    step: 1,\n    saveOn: 'input',\n    normalizeOnKeydown: false,\n    roundToDecimalPlaces: true,\n    state: 'defaultColor',\n    size: 'sm',\n    hideArrows: false,\n    showErrorIcon: true,\n    appendMinWidth: 0,\n  },\n);\n\nconst emit = defineEmits<NumberInputEmits>();\n\nconst field = ref<HTMLInputElement>();\n\nconst computedTabIndex = computed(\n  () => (props.isDisabled ? -1 : props.tabIndex),\n);\n\nconst localValue = useLocalValue<number>(props, emit, 'modelValue');\n\nwatch(localValue, () => {\n  if (props.decimals && props.roundToDecimalPlaces) {\n    localValue.value = roundToDecimalPlaces(props.decimals, localValue.value);\n  }\n});\n\nconst normalizeValue = (\n  value: number,\n  normalizer?: NumberInputNormalizer,\n) => {\n  let isChanged = false;\n\n  if (normalizer) {\n    value = normalizer(value);\n    isChanged = true;\n  }\n\n  if (value < props.min) {\n    value = props.min;\n    isChanged = true;\n  }\n\n  if (value > props.max) {\n    value = props.max;\n    isChanged = true;\n  }\n\n  return {\n    value,\n    isChanged,\n  };\n};\n\nconst saveValue = (\n  value: number,\n  normalizer?: NumberInputNormalizer,\n) => {\n  const {\n    value: normalizedValue,\n    isChanged,\n  } = normalizeValue(value, normalizer);\n\n  if (isChanged && field.value) {\n    field.value.value = String(normalizedValue);\n  }\n\n  localValue.value = normalizedValue;\n};\n\nconst incrementValue = (value: number) => {\n  if (props.normalizer) {\n    return props?.normalizer(value, 'increment');\n  }\n\n  value = add(value, props.step);\n\n  return value;\n};\n\nconst decrementValue = (value: number) => {\n  if (props.normalizer) {\n    return props?.normalizer(value, 'decrement');\n  }\n\n  value = subtract(value, props.step);\n\n  return value;\n};\n\nconst onInput = (event: InputEvent) => {\n  if (props.saveOn === 'input' && field.value) {\n    saveValue(Number(field.value.value), props.normalizer);\n  }\n\n  emit('input', event);\n};\n\nconst isFocused = ref(false);\nconst onFocus = (event: InputEvent) => {\n  isFocused.value = true;\n  emit('focus', event);\n};\n\nconst onBlur = (event: InputEvent) => {\n  isFocused.value = false;\n\n  if (props.saveOn === 'blur' && field.value) {\n    saveValue(Number(field.value.value), props.normalizer);\n  }\n\n  emit('blur', event);\n};\n\nconst onKeydown = (event: KeyboardEvent) => {\n  if (event.key === 'ArrowUp') {\n    event.preventDefault();\n    const eventTarget = (event.target as HTMLInputElement);\n    saveValue(Number(eventTarget.value), incrementValue);\n  }\n\n  if (event.key === 'ArrowDown') {\n    event.preventDefault();\n    const eventTarget = (event.target as HTMLInputElement);\n    saveValue(Number(eventTarget.value), decrementValue);\n  }\n\n  emit('input', event);\n};\n\nconst onClickIncrement = () => {\n  saveValue(localValue.value, incrementValue);\n};\nconst onClickDecrement = () => {\n  saveValue(localValue.value, decrementValue);\n};\n\nconst states = useComputedState(props);\n</script>\n\n<style lang=\"scss\" module>\n@import \"src/assets/styles/utils\";\n\n.numberInput {}\n\n.field {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  input {\n    display: block;\n    width: 100%;\n    height: 100%;\n  }\n}\n\n.sm {\n  .label + .field {\n    margin-top: 10px;\n  }\n  .field {\n    @include title4;\n    border-radius: 5px;\n    & > input {\n      padding: 7px min(10px, 14%);\n    }\n  }\n  .error {\n    margin-top: 2px;\n  }\n}\n\n.xs {\n  .field {\n    @include title5;\n    border-radius: 5px;\n    font-weight: 600;\n    & > input {\n      padding: 2px 0;\n    }\n  }\n}\n\n.defaultColor {\n  .label {\n    color: rgb(var(--color-accent-1));\n  }\n  &.focus {\n    .field {\n      border: 1px solid rgb(var(--color-accent-1));\n    }\n  }\n  .field {\n    color: rgb(var(--color-accent-1));\n    border: 1px solid rgb(var(--color-accent-2));\n    transition: border-color 150ms;\n    &:hover {\n      border: 1px solid rgb(var(--color-accent-1));\n    }\n  }\n}\n\n.alignRight {\n  .field {\n    & > input {\n      text-align: right;\n    }\n  }\n}\n\n.append {\n  margin-right: 10px;\n  display: flex;\n  justify-content: flex-end;\n}\n\n// default styles\n.withError {\n  .field {\n    border: 1px solid rgb(var(--color-danger-2));\n  }\n}\n\n.error {\n  color: rgb(var(--color-danger-2));\n}\n\n.arrows {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  margin-right: 10px;\n}\n\n.arrowButton {\n  height: 6px;\n  width: 6px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  color: rgb(var(--color-accent-2));\n  transition: 200ms color;\n  &.disabled {\n    color: rgb(var(--color-accent-3));\n  }\n}\n\n.errorMessage {\n  color: rgb(var(--color-danger-2));\n}\n</style>\n"],"names":["field","ref","computedTabIndex","computed","props","localValue","useLocalValue","emit","watch","roundToDecimalPlaces","normalizeValue","value","normalizer","isChanged","saveValue","normalizedValue","incrementValue","add","decrementValue","subtract","onInput","event","isFocused","onFocus","onBlur","onKeydown","eventTarget","onClickIncrement","onClickDecrement","states","useComputedState"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;iBAkHMA,IAAQC,KAERC,IAAmBC;AAAA,MACvB,MAAOC,EAAM,aAAa,KAAKA,EAAM;AAAA,IAAA,GAGjCC,IAAaC,EAAsBF,GAAOG,GAAM,YAAY;AAElE,IAAAC,EAAMH,GAAY,MAAM;AAClB,MAAAD,EAAM,YAAYA,EAAM,yBAC1BC,EAAW,QAAQI,EAAqBL,EAAM,UAAUC,EAAW,KAAK;AAAA,IAC1E,CACD;AAEK,UAAAK,IAAiB,CACrBC,GACAC,MACG;AACH,UAAIC,IAAY;AAEhB,aAAID,MACFD,IAAQC,EAAWD,CAAK,GACZE,IAAA,KAGVF,IAAQP,EAAM,QAChBO,IAAQP,EAAM,KACFS,IAAA,KAGVF,IAAQP,EAAM,QAChBO,IAAQP,EAAM,KACFS,IAAA,KAGP;AAAA,QACL,OAAAF;AAAA,QACA,WAAAE;AAAA,MAAA;AAAA,IACF,GAGIC,IAAY,CAChBH,GACAC,MACG;AACG,YAAA;AAAA,QACJ,OAAOG;AAAA,QACP,WAAAF;AAAA,MAAA,IACEH,EAAeC,GAAOC,CAAU;AAEhC,MAAAC,KAAab,EAAM,UACfA,EAAA,MAAM,QAAQ,OAAOe,CAAe,IAG5CV,EAAW,QAAQU;AAAA,IAAA,GAGfC,IAAiB,CAACL,MAClBP,EAAM,aACDA,KAAA,gBAAAA,EAAO,WAAWO,GAAO,gBAG1BA,IAAAM,EAAIN,GAAOP,EAAM,IAAI,GAEtBO,IAGHO,IAAiB,CAACP,MAClBP,EAAM,aACDA,KAAA,gBAAAA,EAAO,WAAWO,GAAO,gBAG1BA,IAAAQ,EAASR,GAAOP,EAAM,IAAI,GAE3BO,IAGHS,IAAU,CAACC,MAAsB;AACrC,MAAIjB,EAAM,WAAW,WAAWJ,EAAM,SACpCc,EAAU,OAAOd,EAAM,MAAM,KAAK,GAAGI,EAAM,UAAU,GAGvDG,EAAK,SAASc,CAAK;AAAA,IAAA,GAGfC,IAAYrB,EAAI,EAAK,GACrBsB,IAAU,CAACF,MAAsB;AACrC,MAAAC,EAAU,QAAQ,IAClBf,EAAK,SAASc,CAAK;AAAA,IAAA,GAGfG,IAAS,CAACH,MAAsB;AACpC,MAAAC,EAAU,QAAQ,IAEdlB,EAAM,WAAW,UAAUJ,EAAM,SACnCc,EAAU,OAAOd,EAAM,MAAM,KAAK,GAAGI,EAAM,UAAU,GAGvDG,EAAK,QAAQc,CAAK;AAAA,IAAA,GAGdI,IAAY,CAACJ,MAAyB;AACtC,UAAAA,EAAM,QAAQ,WAAW;AAC3B,QAAAA,EAAM,eAAe;AACrB,cAAMK,IAAeL,EAAM;AAC3B,QAAAP,EAAU,OAAOY,EAAY,KAAK,GAAGV,CAAc;AAAA;AAGjD,UAAAK,EAAM,QAAQ,aAAa;AAC7B,QAAAA,EAAM,eAAe;AACrB,cAAMK,IAAeL,EAAM;AAC3B,QAAAP,EAAU,OAAOY,EAAY,KAAK,GAAGR,CAAc;AAAA;AAGrD,MAAAX,EAAK,SAASc,CAAK;AAAA,IAAA,GAGfM,IAAmB,MAAM;AACnB,MAAAb,EAAAT,EAAW,OAAOW,CAAc;AAAA,IAAA,GAEtCY,IAAmB,MAAM;AACnB,MAAAd,EAAAT,EAAW,OAAOa,CAAc;AAAA,IAAA,GAGtCW,IAASC,EAAiB1B,CAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}