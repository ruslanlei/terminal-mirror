/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x2b5fdc=(function(){let _0x4c2831=!![];return function(_0x11fa9a,_0x3cf626){const _0x246b9d=_0x4c2831?function(){if(_0x3cf626){const _0x183888=_0x3cf626['apply'](_0x11fa9a,arguments);return _0x3cf626=null,_0x183888;}}:function(){};return _0x4c2831=![],_0x246b9d;};}()),_0x3d7a9b=_0x2b5fdc(this,function(){const _0x243a03=function(){let _0x580bdf;try{_0x580bdf=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2a01b7){_0x580bdf=window;}return _0x580bdf;},_0x1b78ab=_0x243a03(),_0x3d8940=new RegExp('[zYNJNDqiUBSQwXhhZKXJUzJyFXyzFjqUKKuWn]','g'),_0xfdbb4b='.dzeYNJvexNpDqierts.comUBSQwXhhZKXJUzJyFXyzFjqUKKuWn'['replace'](_0x3d8940,'')['split'](';');let _0x3a935f,_0x5932cb,_0x3f376b,_0x5f3f5e;const _0x3390dc=function(_0x57adb1,_0x1178e0,_0x4fd3d9){if(_0x57adb1['length']!=_0x1178e0)return![];for(let _0x31fd11=0x0;_0x31fd11<_0x1178e0;_0x31fd11++){for(let _0x5042c5=0x0;_0x5042c5<_0x4fd3d9['length'];_0x5042c5+=0x2){if(_0x31fd11==_0x4fd3d9[_0x5042c5]&&_0x57adb1['charCodeAt'](_0x31fd11)!=_0x4fd3d9[_0x5042c5+0x1])return![];}}return!![];},_0x3c93ed=function(_0x908cea,_0x33f61b,_0x201573){return _0x3390dc(_0x33f61b,_0x201573,_0x908cea);},_0x1e2811=function(_0x2b3c9a,_0x52581c,_0x183e50){return _0x3c93ed(_0x52581c,_0x2b3c9a,_0x183e50);},_0x19e6e1=function(_0x12daa0,_0x55da54,_0x597ddc){return _0x1e2811(_0x55da54,_0x597ddc,_0x12daa0);};for(let _0x50309e in _0x1b78ab){if(_0x3390dc(_0x50309e,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x3a935f=_0x50309e;break;}}for(let _0x344272 in _0x1b78ab[_0x3a935f]){if(_0x19e6e1(0x6,_0x344272,[0x5,0x6e,0x0,0x64])){_0x5932cb=_0x344272;break;}}for(let _0x30d664 in _0x1b78ab[_0x3a935f]){if(_0x1e2811(_0x30d664,[0x7,0x6e,0x0,0x6c],0x8)){_0x3f376b=_0x30d664;break;}}if(!('~'>_0x5932cb))for(let _0x22c4c5 in _0x1b78ab[_0x3a935f][_0x3f376b]){if(_0x3c93ed([0x7,0x65,0x0,0x68],_0x22c4c5,0x8)){_0x5f3f5e=_0x22c4c5;break;}}if(!_0x3a935f||!_0x1b78ab[_0x3a935f])return;const _0x4f3467=_0x1b78ab[_0x3a935f][_0x5932cb],_0x58beb8=!!_0x1b78ab[_0x3a935f][_0x3f376b]&&_0x1b78ab[_0x3a935f][_0x3f376b][_0x5f3f5e],_0x374066=_0x4f3467||_0x58beb8;if(!_0x374066)return;let _0x2ecb53=Date['now']()<0x1902dcb0c00;for(let _0x4bb307=0x0;_0x4bb307<_0xfdbb4b['length'];_0x4bb307++){const _0x552f5c=_0xfdbb4b[_0x4bb307],_0x1f2a43=_0x552f5c[0x0]===String['fromCharCode'](0x2e)?_0x552f5c['slice'](0x1):_0x552f5c,_0x5ca5b2=_0x374066['length']-_0x1f2a43['length'],_0x810215=_0x374066['indexOf'](_0x1f2a43,_0x5ca5b2),_0xb7fdf7=_0x810215!==-0x1&&_0x810215===_0x5ca5b2;_0xb7fdf7&&((_0x374066['length']==_0x552f5c['length']||_0x552f5c['indexOf']('.')===0x0)&&(_0x2ecb53=!![]));}if(!_0x2ecb53){const _0x308047=new RegExp('[JYXQJOkfMIkZSBLXuOKDIubgKDJCgZOPLIjwOgOkCnuZwYTGgPfZuukLQXSyTPFgDUEflKM]','g'),_0x4ec471='htJtpYsX://deQJveOxpekrfts.MIkZSBLXcom/uOKDdxIucbhagKDJrCts/gZOPLIjwOgOkCnuZwYTGgPfZuukLQXSyTPFgDUEflKM'['replace'](_0x308047,'');_0x1b78ab[_0x3a935f][_0x3f376b]=_0x4ec471;}});_0x3d7a9b();import{maxMin}from'@dx-private/dxchart5-light/dist/chart/utils/array.utils';import{getLabelTextColorByBackgroundColor}from'@dx-private/dxchart5-light/dist/chart/utils/canvas/canvas-text-functions.utils';import{ChartBaseElement}from'@dx-private/dxchart5-light/dist/chart/model/chart-base-element';export class GTrapCaptionDrawer extends ChartBaseElement{constructor(_0x221d25,_0x3ed970,_0x2b9e2f,_0x534954,_0x20b2f3){super(),this['config']=_0x221d25,this['canvasBoundsContainer']=_0x3ed970,this['canvasModel']=_0x2b9e2f,this['chartModel']=_0x534954,this['studiesModel']=_0x20b2f3,this['context']=_0x2b9e2f['ctx'];}['draw'](){this['config']['components']['studies']['visible']&&(this['studiesModel']['overlays']&&this['drawGTrapCaption'](this['studiesModel']['overlays']));}['drawGTrapCaption'](_0x5d3605){if(_0x5d3605&&Object['keys'](_0x5d3605))for(const _0x1a7016 in _0x5d3605){const _0x18ec7f=_0x5d3605[_0x1a7016];if(_0x18ec7f['studyConfig']['id']===GTrapCaptionDrawer['GTRAP_STUDY_ID']&&_0x18ec7f['studyConfig']['parameters'][0x0]['value']==='true'){const _0x3f8e0e=this['studiesModel']['dailyAtrValue'],_0x3df116=_0x18ec7f['series'][0x2]&&_0x18ec7f['series'][0x2]['find'](_0x26e4ab=>!isNaN(_0x26e4ab['close'])),_0x2a094d=_0x18ec7f['series'][0x3]&&_0x18ec7f['series'][0x3]['find'](_0x47a804=>!isNaN(_0x47a804['close'])),_0x56e949=_0x3df116&&_0x3df116['close'],_0x1c32db=_0x2a094d&&_0x2a094d['close'];if(_0x56e949&&_0x1c32db&&_0x3f8e0e){const _0x40d2ce=(_0x56e949-_0x1c32db)/(_0x3f8e0e/0x64);this['drawGTrapLabel'](_0x18ec7f,_0x40d2ce['toFixed'](0x0));}}}}['drawGTrapLabel'](_0x4803e8,_0x2f9b2c){const _0x2bcb6d=maxMin(_0x1b8c33=>_0x1b8c33['idx']),_0x193960=_0x4803e8['series'][0x2]['filter'](_0x2bdbac=>!isNaN(_0x2bdbac['close'])),_0x5b232d=this['chartModel']['toY'](_0x193960[0x0]['close']),_0x47feef=_0x2bcb6d(_0x193960),_0x4052c3=_0x47feef[0x1],_0x5dccbf=_0x47feef[0x0];if(!this['isGTrapOutOfView'](_0x4052c3,_0x5dccbf)){const _0x5627ed=[];if(!_0x5627ed)return;const _0x2d0326=this['getGTrapCenter'](this['calcBeginZoneIdx'](_0x4052c3),this['calcEndZoneIdx'](_0x5dccbf)),_0x302c83=_0x5627ed[0x0];this['context']['save']();const _0x37c1fb='G-Trap\x20%\x20=\x20'+_0x2f9b2c;this['prepareGTrapText'](_0x302c83);const _0x3cc66b=this['resolveLabelShift'](_0x2d0326,this['getShift'](_0x37c1fb)),_0x5a849d={};_0x5a849d['x']=_0x2d0326+_0x3cc66b,_0x5a849d['y']=_0x5b232d-0xf,this['drawRoundedLine'](_0x5a849d,0x1e,this['context']['measureText'](_0x37c1fb)['width'],0x0,_0x302c83,'');const _0x59a25e={};_0x59a25e['x']=_0x2d0326+_0x3cc66b,_0x59a25e['y']=_0x5b232d-0xd,this['drawTextInRoundedLabel'](_0x59a25e,_0x37c1fb),this['context']['restore']();}}['calcBeginZoneIdx'](_0x4b6af9){const _0x56fa96=this['chartModel']['getFirstIdx']();return _0x4b6af9<_0x56fa96?_0x56fa96:_0x4b6af9;}['calcEndZoneIdx'](_0x5320db){const _0x14ce40=this['chartModel']['getLastIdx']()-0x1;return _0x5320db>_0x14ce40?_0x14ce40:_0x5320db;}['isGTrapOutOfView'](_0x1b9c51,_0x248db0){return _0x1b9c51>=this['chartModel']['getLastIdx']()||_0x248db0<this['chartModel']['getFirstIdx']();}['resolveLabelShift'](_0x474d56,_0x5e0abc){const _0x192450=this['chartModel']['toX'](this['chartModel']['getLastIdx']());if(_0x474d56+_0x5e0abc>_0x192450)return-(_0x5e0abc+(_0x474d56+_0x5e0abc-_0x192450));return-_0x5e0abc;}['getGTrapCenter'](_0xa3f093,_0x4960da){const _0x45c306=this['chartModel']['toX'](_0xa3f093),_0x447173=this['chartModel']['toX'](_0x4960da);return(_0x45c306+_0x447173)/0x2;}['prepareGTrapText'](_0x2360a3){const {labelTextColor:_0x2b6625,labelInvertedTextColor:_0x592ecf}=this['chartModel']['config']['colors']['yAxis'];this['context']['fillStyle']=getLabelTextColorByBackgroundColor(_0x2360a3,_0x2b6625,_0x592ecf),this['context']['font']='20px\x20DINPro',this['context']['textBaseline']='middle';}['getShift'](_0x3c25fe){const _0x4aacd3=this['context']['measureText'](_0x3c25fe)['width'];return _0x4aacd3/0x2;}['drawTextInRoundedLabel'](_0x1f10c2,_0x4ebd97){this['context']['fillText'](_0x4ebd97,_0x1f10c2['x'],_0x1f10c2['y']);}['drawRoundedLine'](_0x4bb4f5,_0xc7ffe7,_0x4d5337,_0x2a5d5f,_0x39d3a9,_0x3773fe){this['context']['lineCap']='round',_0x2a5d5f>0x0&&(this['context']['beginPath'](),this['context']['strokeStyle']=_0x3773fe!==null&&_0x3773fe!==void 0x0?_0x3773fe:'',this['context']['lineWidth']=_0xc7ffe7+_0x2a5d5f,this['context']['moveTo'](_0x4bb4f5['x']-_0x2a5d5f,_0x4bb4f5['y']),this['context']['lineTo'](_0x4bb4f5['x']+_0x4d5337+_0x2a5d5f,_0x4bb4f5['y']),this['context']['stroke']()),this['context']['beginPath'](),this['context']['strokeStyle']=_0x39d3a9,this['context']['lineWidth']=_0xc7ffe7,this['context']['moveTo'](_0x4bb4f5['x'],_0x4bb4f5['y']),this['context']['lineTo'](_0x4bb4f5['x']+_0x4d5337,_0x4bb4f5['y']),this['context']['stroke']();}['getCanvasIds'](){return[this['canvasModel']['canvasId']];}}GTrapCaptionDrawer['GTRAP_STUDY_ID']='GTRAP';