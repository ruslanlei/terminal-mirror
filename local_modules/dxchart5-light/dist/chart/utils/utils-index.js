/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import{floor as x,registerForTest as d,shiftRight as g}from"../utils";import*as y from"color";export function identity(e){return e}export function notEmpty(e){return e!=null}export function is(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}export const hasOwnProperty=Object.prototype.hasOwnProperty;export function deepEqual(e,t){if(is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let i=0,o=n.length;i<o;i++)if(!hasOwnProperty.call(t,n[i])||!deepEqual(e[n[i]],t[n[i]]))return!1;return!0}export function keys(e){return Object.keys(e)}export function nonNullableTypeGuard(e){return e!=null}export const constVoid=()=>{};export function getLabelTextColorByBackgroundColor(e,t,n){const r=y.rgb(e).array(),i=r[0],o=r[1],u=r[2];return(i*299+o*587+u*114)/1e3<128?t:n}export function join(e){return e.join("")}export function firstOf(e){if(e)return e[0]}export function lastOf(e){if(e&&e.length)return e[e.length-1]}export function arrayRemove(e){const t=this.indexOf(e);return t!==-1&&this.splice(t,1),this}export function arrayRemove2(e,t){if(!e)return;const n=e.indexOf(t);n!==-1&&e.splice(n,1)}export const searchCandleIndex=(e,t,n,r=1e3)=>{var i,o,u,c;const f=(o=(i=firstOf(n))===null||i===void 0?void 0:i.timestamp)!==null&&o!==void 0?o:0,s=(c=(u=lastOf(n))===null||u===void 0?void 0:u.timestamp)!==null&&c!==void 0?c:0;return e>s?t?{index:n.length-1+Math.ceil((e-s)/r),exact:!0}:{index:n.length-1,exact:!0}:e<f?t?{index:x((e-f)/r),exact:!0}:{index:-1,exact:!0}:binarySearch(n,e,p=>p.timestamp)};export function binarySearch(e,t,n){const r=n!=null?n:identity;return!e.length||t!==t?{index:-1,exact:!0}:l(e,t,0,e.length,r)}function l(e,t,n,r,i){const o=g(n+r,1),u=i(e[o]);return t===u?{index:o,exact:!0}:n===o?{index:n,exact:!1}:t<u?l(e,t,n,o,i):l(e,t,o,r,i)}d(binarySearch);export function isIE(){return!!document.documentMode}export function isEdge(){return!isIE()&&!!window.StyleMedia}export const findKeyFromValue=(e,t)=>{for(const[n,r]of Array.from(e.entries()))if(r===t)return n},at=(e,t)=>e>=0?t[e]:t[t.length+e];
