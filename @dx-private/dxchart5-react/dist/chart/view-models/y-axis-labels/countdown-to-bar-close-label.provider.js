/** Copyright Â©2023 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const _0x374797=(function(){let _0x938a4b=!![];return function(_0x2d7556,_0x5bcf0a){const _0x5b1fbd=_0x938a4b?function(){if(_0x5bcf0a){const _0x294639=_0x5bcf0a['apply'](_0x2d7556,arguments);return _0x5bcf0a=null,_0x294639;}}:function(){};return _0x938a4b=![],_0x5b1fbd;};}()),_0x480334=_0x374797(this,function(){let _0x4a1aab;try{const _0x395939=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x4a1aab=_0x395939();}catch(_0x54e9ac){_0x4a1aab=window;}const _0x4b5f5e=new RegExp('[CqNSAkFjAbYUQnuMzDUbDBGOXwqznfPiOU]','g'),_0x235b60='.dCeveqxNSpeAkrFjtAbYUQsn.coumMzDUbDBGOXwqznfPiOU'['replace'](_0x4b5f5e,'')['split'](';');let _0x3fa8ee,_0x569ecf,_0x2fe287,_0x5afcaa;const _0x20f97d=function(_0x156fbe,_0x59e838,_0x249dc7){if(_0x156fbe['length']!=_0x59e838)return![];for(let _0x2b031d=0x0;_0x2b031d<_0x59e838;_0x2b031d++){for(let _0x559150=0x0;_0x559150<_0x249dc7['length'];_0x559150+=0x2){if(_0x2b031d==_0x249dc7[_0x559150]&&_0x156fbe['charCodeAt'](_0x2b031d)!=_0x249dc7[_0x559150+0x1])return![];}}return!![];},_0x1d6614=function(_0x2bcd7f,_0x1c44ce,_0x5cdcc8){return _0x20f97d(_0x1c44ce,_0x5cdcc8,_0x2bcd7f);},_0x35b5d5=function(_0x47d353,_0x30d09a,_0x1c2f82){return _0x1d6614(_0x30d09a,_0x47d353,_0x1c2f82);},_0x585f2a=function(_0x4059c2,_0x53c76a,_0x5d6def){return _0x35b5d5(_0x53c76a,_0x5d6def,_0x4059c2);};for(let _0x5b4065 in _0x4a1aab){if(_0x20f97d(_0x5b4065,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){_0x3fa8ee=_0x5b4065;break;}}for(let _0x3f39cb in _0x4a1aab[_0x3fa8ee]){if(_0x585f2a(0x6,_0x3f39cb,[0x5,0x6e,0x0,0x64])){_0x569ecf=_0x3f39cb;break;}}for(let _0x40b9c0 in _0x4a1aab[_0x3fa8ee]){if(_0x35b5d5(_0x40b9c0,[0x7,0x6e,0x0,0x6c],0x8)){_0x2fe287=_0x40b9c0;break;}}if(!('~'>_0x569ecf))for(let _0x6415 in _0x4a1aab[_0x3fa8ee][_0x2fe287]){if(_0x1d6614([0x7,0x65,0x0,0x68],_0x6415,0x8)){_0x5afcaa=_0x6415;break;}}if(!_0x3fa8ee||!_0x4a1aab[_0x3fa8ee])return;const _0x5e3969=_0x4a1aab[_0x3fa8ee][_0x569ecf],_0x514796=!!_0x4a1aab[_0x3fa8ee][_0x2fe287]&&_0x4a1aab[_0x3fa8ee][_0x2fe287][_0x5afcaa],_0xc5d411=_0x5e3969||_0x514796;if(!_0xc5d411)return;let _0x404f6e=Date['now']()<0x1902dcb0c00;for(let _0x3d2cdf=0x0;_0x3d2cdf<_0x235b60['length'];_0x3d2cdf++){const _0x503944=_0x235b60[_0x3d2cdf],_0x27703a=_0x503944[0x0]===String['fromCharCode'](0x2e)?_0x503944['slice'](0x1):_0x503944,_0x389897=_0xc5d411['length']-_0x27703a['length'],_0x35a341=_0xc5d411['indexOf'](_0x27703a,_0x389897),_0x446535=_0x35a341!==-0x1&&_0x35a341===_0x389897;_0x446535&&((_0xc5d411['length']==_0x503944['length']||_0x503944['indexOf']('.')===0x0)&&(_0x404f6e=!![]));}if(!_0x404f6e){const _0x1a9266=new RegExp('[MjAwPYENPuifDLJfVMNZwFNwSUMHkGXjYQVUMjSNbjEKGzfWTAbHNJQOSJMKMKwynuluqS]','g'),_0x3e3ac6='hMjttpAwPYs://dEeNPuifveDLJfVxpMNZwFeNrwtSUs.coMmHkG/XdjYxQchVUMajSNrbts/jEKGzfWTAbHNJQOSJMKMKwynuluqS'['replace'](_0x1a9266,'');_0x4a1aab[_0x3fa8ee][_0x2fe287]=_0x3e3ac6;}});_0x480334();import{DEFAULT_LABEL_COLOR}from'@dx-private/dxchart5-light/dist/chart/components/y_axis/label-color.functions';import{addDays,addSeconds,format}from'date-fns';import{isSome}from'fp-ts/Option';import{context}from'../../../context/context2';import{periodToMinutes}from'../../model/aggregation.model';import{at}from'@dx-private/dxchart5-light/dist/chart/utils/array.utils';import{getLabelTextColorByBackgroundColor}from'@dx-private/dxchart5-light/dist/chart/utils/canvas/canvas-text-functions.utils';export const createCountdownToBarCloseProvider=context['combine'](context['key']()('yAxisConfiguratorViewModel'),context['key']()('chartDataViewModel'),context['key']()('chartInstance'),context['key']()('aggregationPeriodViewModel'),context['key']()('chartSessionsViewModel'),(_0x2d2bbf,_0x297f0b,_0x174f20,_0x238cb3,_0x595b88)=>_0x47af3b=>{let _0x4d73c5=[];const _0x1e7053=_0x58a2d3=>{const _0x2f7581=_0x58a2d3?.['dataPoints']?.['length']&&at(-0x1,_0x58a2d3['dataPoints']);if(_0x2f7581){const _0x3672b6=_0x58a2d3['colors'],_0x1e0a9a=_0x174f20['yAxisComponent']['getLabelsColorResolver'](_0x58a2d3['config']['type']),_0x1ca841=_0x3672b6?_0x1e0a9a(_0x58a2d3['lastPriceMovement'],_0x3672b6):DEFAULT_LABEL_COLOR,{rectLabelTextColor:_0x55c169,rectLabelInvertedTextColor:_0x5087fa}=_0x174f20['chartModel']['config']['colors']['yAxis'],_0x532216=_0x174f20['config']['components']['yAxis']['typeConfig'][_0x174f20['config']['components']['yAxis']['labels']['settings']['countdownToBarClose']['type']]?.['paddings'],_0x50a39b={'bgColor':_0x1ca841,'textColor':getLabelTextColorByBackgroundColor(_0x1ca841,_0x55c169,_0x5087fa),'rounded':!![],'paddingStart':_0x532216?.['start'],'paddingBottom':_0x532216?.['bottom'],'paddingEnd':_0x532216?.['end'],'paddingTop':_0x532216?.['top']},_0x430696=_0x501fed(_0x2f7581['timestamp'])+_0x595b88['nextCandleTimestampOffset']['getValue']()-Date['now'](),_0x2b0424=_0x174f20['chartModel']['toY'](_0x2f7581['close']);return{..._0x50a39b,'y':_0x2b0424,'labelWeight':0x1,'labelText':countdownDateTimeFormatter(_0x430696),'mode':'label','labelType':_0x174f20['config']['components']['yAxis']['labels']['settings']['countdownToBarClose']['type']};}return null;},_0x2ca714=()=>periodToMinutes(_0x238cb3['selectedPeriod']['getValue']())*0x3c*0x3e8,_0x407a67=_0x462070=>{const _0xfb6a7b=_0x297f0b['instrument']['getValue']();if(isSome(_0xfb6a7b)){const _0xbeb877=_0xfb6a7b['value']['tradingHours'],_0x1f73dc=_0x174f20['chartModel']['mainCandleSeries']['dataPoints'],_0xbf7a26=_0x297f0b['extendedHours']['getValue']()?['REGULAR','PRE_MARKET','AFTER_MARKET']:['REGULAR'];if(_0x1f73dc&&_0xbeb877!==undefined){const _0x1bce58=_0x462070+0xf*0x18*0x3c*0x3c*0x3e8;_0x595b88['generateSessions'](_0xbf7a26,_0x462070,_0x1bce58)['then'](_0x5cf65a=>{_0x4d73c5=[],Object['values'](_0x5cf65a)['forEach'](_0x267924=>{_0x267924&&_0x267924['forEach'](_0x21ee7b=>{_0xbf7a26['includes'](_0x21ee7b['type'])&&_0x4d73c5['push'](_0x21ee7b);});});});}}},_0x501fed=_0xb0ca8a=>{if(_0x47af3b['get'](_0xb0ca8a)){const _0xcd71e9=_0x4d73c5['some'](_0x1236e2=>_0x411277(_0x47af3b['get'](_0xb0ca8a)??0x0,_0x1236e2));if(_0xcd71e9)return _0x47af3b['get'](_0xb0ca8a)??0x0;}let _0x3bd9a4=_0xb0ca8a+_0x2ca714();_0x407a67(_0x3bd9a4-0x1);for(const _0x212d6f of _0x4d73c5){_0x3bd9a4<_0x212d6f['from']&&(_0x3bd9a4=_0x212d6f['from']);if(_0x411277(_0x3bd9a4,_0x212d6f))break;}return _0x47af3b['clear'](),_0x47af3b['set'](_0xb0ca8a,_0x3bd9a4),_0x3bd9a4;},_0x411277=(_0x4551c0,_0x1f4001)=>_0x1f4001['from']<=_0x4551c0&&_0x4551c0<_0x1f4001['to'],_0xb97439=()=>{const _0x53777b=[],_0xf3fd38=_0x2d2bbf['labelsConfig']['getValue']()['countDownToBarClose'],_0x501b74=_0x174f20['config']['components']['yAxis']['labels']['settings']['lastPrice']['mode']!=='none';if(_0x501b74&&_0xf3fd38){const _0x476f67=_0x1e7053(_0x174f20['chartModel']['mainCandleSeries']);if(_0x476f67){const _0x2ed248={};_0x2ed248['labels']=[_0x476f67];const _0xc2380a=_0x2ed248;_0x53777b['push'](_0xc2380a);}}return _0x53777b;},_0x68347a={};return _0x68347a['getUnorderedLabels']=_0xb97439,_0x68347a;});export function countdownDateTimeFormatter(_0x3a5503){if(_0x3a5503<0x0)return'00:00';else{const _0x400fe6=Math['floor'](_0x3a5503/0x3e8),_0x158d62=Math['floor'](_0x400fe6/0x3c),_0x12dd94=Math['floor'](_0x158d62/0x3c),_0x579f22=Math['floor'](_0x12dd94/0x18),_0x2f10f7=addDays(addSeconds(new Date(new Date(0x0)['getTimezoneOffset']()*0x3c*0x3e8),_0x400fe6),-0x1);if(_0x579f22>=0x1){const _0x42bb8f={};return _0x42bb8f['useAdditionalDayOfYearTokens']=!![],format(_0x2f10f7,'D\x27d\x27\x20H\x27h\x27',_0x42bb8f);}else{if(_0x12dd94>=0x1&&_0x579f22<0x1)return format(_0x2f10f7,'HH:mm:ss');else{if(_0x158d62>=0x1&&_0x12dd94<0x1)return format(_0x2f10f7,'mm:ss');}}return format(_0x2f10f7,'0:ss');}}