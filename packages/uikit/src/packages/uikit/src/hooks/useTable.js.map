{"version":3,"file":"useTable.js","sources":["../../../../hooks/useTable.ts"],"sourcesContent":["import { computed } from 'vue';\nimport {\n  InnerTableRecord,\n  SortDirection,\n  TableColumn,\n  TableProps,\n  TableRecord,\n} from '@/components/table';\nimport { useLocalValue } from '@/hooks/useLocalValue';\n\nexport const useTable = (\n  props: TableProps,\n  emit: any,\n) => {\n  const localSelectedRecords = useLocalValue<Array<TableRecord['id']>>(\n    props,\n    emit,\n    'selectedRecords',\n  );\n  const isAllRecordsSelected = computed(\n    () => localSelectedRecords.value?.length === props.records.length,\n  );\n\n  const toggleSelectAll = () => {\n    if (isAllRecordsSelected.value) {\n      localSelectedRecords.value = [];\n    } else {\n      localSelectedRecords.value = props.records.map((record: TableRecord) => record.id);\n    }\n  };\n\n  const localSortBy = useLocalValue<TableProps['sortBy']>(props, emit, 'sortBy');\n  const localSortDirection = useLocalValue<TableProps['sortDirection']>(props, emit, 'sortDirection');\n\n  const onColumnClick = (column: TableColumn) => {\n    if (column.isSelect) {\n      toggleSelectAll();\n    }\n    if (column.sortable) {\n      if (localSortBy.value === null) {\n        localSortBy.value = column.slug;\n        localSortDirection.value = SortDirection.ASC;\n      } else if (localSortDirection.value === SortDirection.ASC) {\n        localSortDirection.value = SortDirection.DESC;\n      } else {\n        localSortBy.value = null;\n        localSortDirection.value = SortDirection.ASC;\n      }\n    }\n  };\n\n  const toggleRecordSelect = (id: InnerTableRecord['id']) => {\n    if (!props.isSelectable) return;\n    const isSelected = localSelectedRecords.value.includes(id);\n\n    if (isSelected) {\n      localSelectedRecords.value = localSelectedRecords.value.filter(\n        (recordId) => recordId !== id,\n      );\n    } else {\n      localSelectedRecords.value.push(id);\n    }\n  };\n\n  const onCellClick = (\n    event: Event,\n    tableColumn: TableColumn,\n    tableRecord: InnerTableRecord,\n    toggleChildren?: () => void,\n  ) => {\n    if (tableColumn.isSelect) {\n      toggleRecordSelect(tableRecord.id);\n    }\n    if (tableColumn.isClickable) {\n      event.stopPropagation();\n    } else {\n      toggleChildren?.();\n    }\n  };\n\n  const computedRecords = computed<InnerTableRecord[]>(() => props.records.map(\n    (record) => ({\n      ...record,\n      ...(props.isSelectable ? {\n        isSelected: localSelectedRecords.value.includes(record.id),\n      } : {}),\n    }),\n  ));\n\n  const onRowClick = (record: TableRecord) => {\n    if (!props.isRowsClickable) return;\n\n    emit('record-click', record);\n  };\n\n  return {\n    localSelectedRecords,\n    isAllRecordsSelected,\n    onColumnClick,\n    toggleRecordSelect,\n    onCellClick,\n    computedRecords,\n    onRowClick,\n  };\n};\n"],"names":["computed","SortDirection","useLocalValue","useTable","props","emit","localSelectedRecords","isAllRecordsSelected","_a","toggleSelectAll","record","localSortBy","localSortDirection","onColumnClick","column","toggleRecordSelect","id","recordId","onCellClick","event","tableColumn","tableRecord","toggleChildren","computedRecords"],"mappings":"AAUa,SAAA,YAAAA,SAAA;AAAA,SAAA,iBAAAC,SAAA;AAAA,SAAA,iBAAAC,SAAA;AAAA,MAAAC,IAAW,CACtBC,GACAC,MACG;AACH,QAAMC,IAAuBJ;AAAA,IAC3BE;AAAA,IACAC;AAAA,IACA;AAAA,EAAA,GAEIE,IAAuBP;AAAA,IAC3B,MAAA;AAVS,UAAAQ;AAUH,eAAAA,IAAAF,EAAqB,UAArB,gBAAAE,EAA4B,YAAWJ,EAAM,QAAQ;AAAA;AAAA,EAAA,GAGvDK,IAAkB,MAAM;AAC5B,IAAIF,EAAqB,QACvBD,EAAqB,QAAQ,KAE7BA,EAAqB,QAAQF,EAAM,QAAQ,IAAI,CAACM,MAAwBA,EAAO,EAAE;AAAA,EACnF,GAGIC,IAAcT,EAAoCE,GAAOC,GAAM,QAAQ,GACvEO,IAAqBV,EAA2CE,GAAOC,GAAM,eAAe,GAE5FQ,IAAgB,CAACC,MAAwB;AAC7C,IAAIA,EAAO,YACOL,KAEdK,EAAO,aACLH,EAAY,UAAU,QACxBA,EAAY,QAAQG,EAAO,MAC3BF,EAAmB,QAAQX,EAAc,OAChCW,EAAmB,UAAUX,EAAc,MACpDW,EAAmB,QAAQX,EAAc,QAEzCU,EAAY,QAAQ,MACpBC,EAAmB,QAAQX,EAAc;AAAA,EAE7C,GAGIc,IAAqB,CAACC,MAA+B;AACzD,QAAI,CAACZ,EAAM;AAAc;AAGzB,IAFmBE,EAAqB,MAAM,SAASU,CAAE,IAGlCV,EAAA,QAAQA,EAAqB,MAAM;AAAA,MACtD,CAACW,MAAaA,MAAaD;AAAA,IAAA,IAGRV,EAAA,MAAM,KAAKU,CAAE;AAAA,EACpC,GAGIE,IAAc,CAClBC,GACAC,GACAC,GACAC,MACG;AACH,IAAIF,EAAY,YACdL,EAAmBM,EAAY,EAAE,GAE/BD,EAAY,cACdD,EAAM,gBAAgB,IAELG,KAAA,QAAAA;AAAA,EACnB,GAGIC,IAAkBvB,EAA6B,MAAMI,EAAM,QAAQ;AAAA,IACvE,CAACM,OAAY;AAAA,MACX,GAAGA;AAAA,MACH,GAAIN,EAAM,eAAe;AAAA,QACvB,YAAYE,EAAqB,MAAM,SAASI,EAAO,EAAE;AAAA,MAAA,IACvD,CAAC;AAAA,IAAA;AAAA,EACP,CACD;AAQM,SAAA;AAAA,IACL,sBAAAJ;AAAA,IACA,sBAAAC;AAAA,IACA,eAAAM;AAAA,IACA,oBAAAE;AAAA,IACA,aAAAG;AAAA,IACA,iBAAAK;AAAA,IACA,YAbiB,CAACb,MAAwB;AAC1C,MAAKN,EAAM,mBAEXC,EAAK,gBAAgBK,CAAM;AAAA,IAAA;AAAA,EAU3B;AAEJ;"}