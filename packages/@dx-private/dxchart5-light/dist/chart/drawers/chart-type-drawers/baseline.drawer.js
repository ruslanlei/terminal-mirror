/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import{CanvasElement as d}from"../../canvas/canvas-bounds-container";import{CandleSeriesModel as H}from"../../model/candle-series.model";export class BaselineDrawer{constructor(e,s){this.baseLineModel=e,this.canvasBoundContainer=s}draw(e,s,o,h){if(h!==void 0&&o instanceof H){const a=s.flat(),B=this.baseLineModel.baselineYPercents,T=this.canvasBoundContainer.getBounds(d.CHART),n=T.y+T.height*(B/100),S=a[0];for(let c=0;c<a.length;c++){const L=a[c],i=a[c-1],p=a[c+1],v=o.view.toX(S.centerUnit),t=o.view.toX(L.centerUnit),l=o.view.toY(L.close),b=i?o.view.toY(i.close)<n:!1,f=l<n;if(i!==void 0&&b!==f){g(e,o,h,b);const P=o.view.toX(i.centerUnit),k=o.view.toY(i.close),u=t-P,y=l-k,Y=u/y,w=l-n,X=Y*w,C=P+(u-X);e.lineTo(C,n),e.stroke(),e.lineTo(v,n),e.closePath(),e.fill(),e.beginPath(),e.moveTo(C,n)}i===void 0?(e.beginPath(),e.moveTo(t,l)):p===void 0?(g(e,o,h,f),e.lineTo(t,l),e.stroke(),e.lineTo(t,n),e.lineTo(v,n),e.closePath(),e.fill(),e.beginPath(),e.moveTo(v,n),e.lineTo(t,n),e.strokeStyle=o.colors.baseLineTheme.baselineColor,e.stroke()):e.lineTo(t,l)}}}}const g=(r,e,s,o)=>{s.singleColor?(r.fillStyle=s.singleColor,r.strokeStyle=s.singleColor):(r.fillStyle=o?e.colors.baseLineTheme.upperSectionFillColor:e.colors.baseLineTheme.lowerSectionFillColor,r.strokeStyle=o?e.colors.baseLineTheme.upperSectionStrokeColor:e.colors.baseLineTheme.lowerSectionStrokeColor)};
