/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import{identity as h}from"./function.utils";import{clamp as x,shiftRight as I}from"./math.utils";export const arrayIntersect=(e,t,n=eqeqeq,r=!0)=>{const i=e.filter(o=>t.filter(l=>n(o,l)).length!==0),c=[];return r?i.reduce((o,l)=>(o.filter(s=>n(l,s)).length===0&&o.push(l),o),c):i},reorderArray=(e,t)=>{const n=t.slice().filter(r=>e.find(i=>i===r));return e.map(r=>{var i;return t.indexOf(r)>=0&&(i=n.shift())!==null&&i!==void 0?i:r})},eqeqeq=(e,t)=>e===t,arraySubtract=(e,t,n)=>e.filter(r=>t.filter(i=>n(r,i)).length===0);export function moveInArray(e,t,n){const r=e.slice(),i=r[t];return r.splice(t,1),r.splice(n,0,i),r}export function moveInArrayMutable(e,t,n){const r=e.length,i=x(t,0,r-1),c=x(n,0,r-1),o=e[i];return e.splice(i,1),e.splice(c,0,o),e}export function replaceInArray(e,t,n){const r=e.slice(),i=r.findIndex(t);return i!==-1&&(r.splice(i,1),r.splice(i,0,n)),r}export const uniqueArray=e=>{const t={};return e.filter(n=>t[n]?!1:t[n]=!0)},groupBy=(e,t)=>e.reduce((n,r)=>((n[r[t]]=n[r[t]]||[]).push(r),n),{}),interleave=(e,t)=>[].concat(...e.map(n=>[n,t])).slice(0,-1),isTwoDimArray=e=>Array.isArray(e[0]),create2DArray=e=>Array.isArray(e[0])?e:[e],slice2DArray=(e,t,n)=>{const r=[];let i=0;for(const c of e){const o=Math.max(t-i,0),l=Math.max(n-i,-1),s=c.slice(o,l+1);s.length>0&&r.push(s),i+=c.length}return r},at=(e,t)=>e>=0?t[e]:t[t.length+e];export function binarySearch(e,t,n){const r=n!=null?n:h;return!e.length||t!==t?{index:-1,exact:!0}:p(e,t,0,e.length,r)}function p(e,t,n,r,i){const c=I(n+r,1),o=i(e[c]);return t===o?{index:c,exact:!0}:n===c?{index:n,exact:!1}:t<o?p(e,t,n,c,i):p(e,t,c,r,i)}export function lastOf(e){if(e&&e.length)return e[e.length-1]}export function arrayRemove(e){const t=this.indexOf(e);return t!==-1&&this.splice(t,1),this}export function arrayRemove2(e,t){if(!e)return;const n=e.indexOf(t);n!==-1&&e.splice(n,1)}export function firstOf(e){if(e)return e[0]}export function maxMin(e){function t(n,r){const i=e(r);return i==null||!isFinite(i)?n:[Math.max(n[0],i),Math.min(n[1],i)]}return function(n){const r=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];return n?n.reduce(t,r):r}}export function getElementsInRange(e,t,n,r=()=>0){const i=(o,l)=>{let s=0,u=o.length-1;for(;u>=s;){const f=Math.ceil((s+u)/2);r(o[f])<=l?s=f+1:u=f-1}return u},c=(o,l)=>{let s=0,u=o.length-1;for(;u>=s;){const f=Math.ceil((s+u)/2);r(o[f])>=l?u=f-1:s=f+1}return s};return e.slice(c(e,t),i(e,n)+1)}
