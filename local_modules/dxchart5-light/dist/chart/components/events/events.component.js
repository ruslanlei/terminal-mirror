/*
 * Copyright (C) 2002 - 2023 Devexperts LLC
 * This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
 * If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import{CanvasElement as h}from"../../canvas/canvas-bounds-container";import{ChartBaseElement as c}from"../../chart-base-element";import{DrawerType as n}from"../../drawers/drawing-manager";import{recalculateXFormatter as f}from"../../time.formatter";import{merge as p}from"../../utils/merge.utils";import{EventsDrawer as w}from"./events.drawer";import{EventsHitTestDrawer as b}from"./events-hit-test.drawer";import{EventsModel as T}from"./events.model";export class EventsComponent extends c{constructor(e,r,o,s,i,a,v,m,d){super(),this.config=e,this.canvasModel=r,this.canvasBoundsContainer=i,this.drawingManager=a,this.formatterFactory=v,this.eventsXAxisLabelFormatterProvider=()=>f(this.config.components.events.xAxisLabelFormat,s.getPeriod(),this.formatterFactory);const t=new T(r);this.eventsModel=t,this.addChildEntity(t),o.addSubscriber(t);const l=new w(d,r,s,e,i,t,this.eventsXAxisLabelFormatterProvider);this.drawingManager.addDrawer(l,n.EVENTS);const E=new b(o,s,e,i,t);this.drawingManager.addDrawerBefore(E,n.HIT_TEST_EVENTS,n.HIT_TEST_DRAWINGS),m.addCursorForCanvasEl(h.EVENTS,e.components.events.cursor)}setEvents(e){this.eventsModel.setEvents(e),this.canvasModel.fireDraw()}setVisible(e){this.config.components.events.visible=e,this.canvasBoundsContainer.recalculateBounds(),this.canvasModel.fireDraw()}setEventTypeVisible(e){p(this.config.components.events.eventsVisibility,e,{overrideExisting:!0,addIfMissing:!1}),this.canvasModel.fireDraw()}observeEventHovered(){return this.eventsModel.hoveredEvent.asObservable()}}
